(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("﻿ ")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||
(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text
(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window),function(e,t){var n=function(){var t=e._data(document,"events");return t&&t.click&&e.grep(t.click,function(e){return e.namespace==="rails"}).length};n()&&e.error("jquery-ujs has already been loaded!");var r;e.rails=r={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,r){var i=e.Event(n);return t.trigger(i,r),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var i,s,o,u,a,f,l,c;if(r.fire(n,"ajax:before")){u=n.data("cross-domain"),a=u===t?null:u,f=n.data("with-credentials")||null,l=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType;if(n.is("form")){i=n.attr("method"),s=n.attr("action"),o=n.serializeArray();var h=n.data("ujs:submit-button");h&&(o.push(h),n.data("ujs:submit-button",null))}else n.is(r.inputChangeSelector)?(i=n.data("method"),s=n.data("url"),o=n.serialize(),n.data("params")&&(o=o+"&"+n.data("params"))):(i=n.data("method"),s=r.href(n),o=n.data("params")||null);c={type:i||"GET",data:o,dataType:l,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),r.fire(n,"ajax:beforeSend",[e,i])},success:function(e,t,r){n.trigger("ajax:success",[e,t,r])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,r){n.trigger("ajax:error",[e,t,r])},xhrFields:{withCredentials:f},crossDomain:a},s&&(c.url=s);var p=r.ajax(c);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var i=r.href(n),s=n.data("method"),o=n.attr("target"),u=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content"),f=e('<form method="post" action="'+i+'"></form>'),l='<input name="_method" value="'+s+'" type="hidden" />';a!==t&&u!==t&&(l+='<input name="'+a+'" value="'+u+'" type="hidden" />'),o&&f.attr("target",o),f.hide().append(l).appendTo("body"),f.submit()},disableFormElements:function(t){t.find(r.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(r.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t=e.data("confirm"),n=!1,i;return t?(r.fire(e,"confirm")&&(n=r.confirm(t),i=r.fire(e,"confirm:complete",[n])),n&&i):!0},blankInputs:function(t,n,r){var i=e(),s,o,u=n||"input,textarea",a=t.find(u);return a.each(function(){s=e(this),o=s.is(":checkbox,:radio")?s.is(":checked"):s.val();if(!o==!r){if(s.is(":radio")&&a.filter('input:radio:checked[name="'+s.attr("name")+'"]').length)return!0;i=i.add(s)}}),i.length?i:!1},nonBlankInputs:function(e,t){return r.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},callFormSubmitBindings:function(n,r){var i=n.data("events"),s=!0;return i!==t&&i.submit!==t&&e.each(i.submit,function(e,t){if(typeof t.handler=="function")return s=t.handler(r)}),s},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return r.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.data("ujs:enable-with",!1)),e.unbind("click.railsDisable")}},r.fire(e(document),"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||r.CSRFProtection(n)}),e(document).delegate(r.linkDisableSelector,"ajax:complete",function(){r.enableElement(e(this))}),e(document).delegate(r.linkClickSelector,"click.rails",function(n){var i=e(this),s=i.data("method"),o=i.data("params");if(!r.allowAction(i))return r.stopEverything(n);i.is(r.linkDisableSelector)&&r.disableElement(i);if(i.data("remote")!==t){if((n.metaKey||n.ctrlKey)&&(!s||s==="GET")&&!o)return!0;var u=r.handleRemote(i);return u===!1?
r.enableElement(i):u.error(function(){r.enableElement(i)}),!1}if(i.data("method"))return r.handleMethod(i),!1}),e(document).delegate(r.inputChangeSelector,"change.rails",function(t){var n=e(this);return r.allowAction(n)?(r.handleRemote(n),!1):r.stopEverything(t)}),e(document).delegate(r.formSubmitSelector,"submit.rails",function(n){var i=e(this),s=i.data("remote")!==t,o=r.blankInputs(i,r.requiredInputSelector),u=r.nonBlankInputs(i,r.fileInputSelector);if(!r.allowAction(i))return r.stopEverything(n);if(o&&i.attr("novalidate")==t&&r.fire(i,"ajax:aborted:required",[o]))return r.stopEverything(n);if(s){if(u){setTimeout(function(){r.disableFormElements(i)},13);var a=r.fire(i,"ajax:aborted:file",[u]);return a||setTimeout(function(){r.enableFormElements(i)},13),a}return!e.support.submitBubbles&&e().jquery<"1.7"&&r.callFormSubmitBindings(i,n)===!1?r.stopEverything(n):(r.handleRemote(i),!1)}setTimeout(function(){r.disableFormElements(i)},13)}),e(document).delegate(r.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!r.allowAction(n))return r.stopEverything(t);var i=n.attr("name"),s=i?{name:i,value:n.val()}:null;n.closest("form").data("ujs:submit-button",s)}),e(document).delegate(r.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&r.disableFormElements(e(this))}),e(document).delegate(r.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&r.enableFormElements(e(this))}),e(function(){csrf_token=e("meta[name=csrf-token]").attr("content"),csrf_param=e("meta[name=csrf-param]").attr("content"),e('form input[name="'+csrf_param+'"]').val(csrf_token)}))}(jQuery),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j={}.hasOwnProperty,F=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};y=!1,f=null,k=document.location.href,E=null,N={},u=null,B=function(e){return r?(i(),L(e),v(e)):document.location.href=e},v=function(e){var n,r=this;return H("page:fetch"),n=new XMLHttpRequest,n.open("GET",e,!0),n.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),n.setRequestHeader("X-XHR-Referer",k),n.onload=function(){var e;return e=u(n.responseText),t(e)?document.location.reload():(s.apply(null,h(e)),A(n),D(),H("page:load"))},n.onabort=function(){return console.log("Aborted turbolink fetch!")},n.send()},d=function(e){var t;return i(),(t=N[e.position])?(s(t.title,t.body),C(t),H("page:restore")):v(document.location.href)},i=function(){return _(),N[f.position]={url:document.location.href,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},o(10)},o=function(e){var t,n,r;r=[];for(t in N){if(!j.call(N,t))continue;n=N[t],t<=f.position-e?r.push(N[t]=null):r.push(void 0)}return r},s=function(e,t,n){return document.title=e,document.documentElement.replaceChild(t,document.body),n&&l(),f=window.history.state,H("page:change")},l=function(){var e,t,n,r,i,s,o,u,a,f,l,c;a=document.body.getElementsByTagName("script"),c=[];for(i=0,o=a.length;i<o;i++){r=a[i];if((f=r.type)===""||f==="text/javascript")if(r.src!=null&&r.src!==""&&r.getAttribute("data-turbolinks-evaluated")==null){t=document.createElement("script"),l=r.attributes;for(s=0,u=l.length;s<u;s++)e=l[s],t.setAttribute(e.name,e.value);t.setAttribute("data-turbolinks-evaluated",""),n=r.parentNode,n.removeChild(r),c.push(n.insertBefore(t,n.childNodes[0]))}else c.push(window.eval(r.innerHTML))}return c},L=function(e){if(e!==document.location.href)return k=document.location.href,window.history.pushState({turbolinks:!0,position:f.position+1},"",e)},A=function(e){var t;if((t=e.getResponseHeader("X-XHR-Current-Location"))!==document.location.pathname+document.location.search)return window.history.replaceState(f,"",t+document.location.hash)},M=function(){return window.history.replaceState({turbolinks:!0,position:Date.now()},"",document.location.href)},O=function(){return f=window.history.state},_=function(){if(!y)return M(),O(),u=n(),y=!0},C=function(e){return window.scrollTo(e.positionX,e.positionY)},D=function(){return window.scrollTo(0,0)},H=function(e){var t;return t=document.createEvent("Events"),t.initEvent(e,!0,!0),document.dispatchEvent(t)},p=function(e){var t,n,r,i,s;i=e.head.childNodes,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],(typeof t.getAttribute==="function"?t.getAttribute("data-turbolinks-track"):void 0)!=null&&s.push(t.src||t.href);return s},t=function(e){var t;return E||(E=p(document)),t=p(e),t.length!==E.length||w(t,E).length!==E.length},w=function(e,t){var n,r,i,s,o;e.length>t.length&&(s=[t,e],e=s[0],t=s[1]),o=[];for(r=0,i=e.length;r<i;r++)n=e[r],F.call(t,n)>=0&&o.push(n);return o},h=function(e){var t;return t=e.querySelector("title"),[t!=null?t.textContent:void 0,e.body,"runScripts"]},n=function(){var e,t,n,r;return e=function(e){return(new DOMParser).parseFromString(e,"text/html")},t=function(e){var t;return t=document.implementation.createHTMLDocument(""),t.open("replace"),t.write(e),t.close(),t},window.DOMParser&&(n=e("<html><body><p>test")),(n!=null?(r=n.body)!=null?r.childNodes.length:void 0:void 0)===1?e:t},b=function(e){if(!e.defaultPrevented)return document.removeEventListener("click",m),document.addEventListener("click",m)},m=function(e){var t;if(!e.defaultPrevented){t=c(e);if((t!=null?t.nodeName:void 0)==="A"&&!g(e,t))return B(t.href),e.preventDefault()}},c=function(e){var t;t=e.target;while(!!t.parentNode&&t.nodeName!=="A")t=t.parentNode;return t},a=function(e){return location.protocol!==e.protocol||location.host!==e.host},e=function(e){return(e.hash&&e.href.replace(e.hash,""))===location.href.replace(location.hash,"")||e.href===location.href+"#"},x=function(e){return e.href.match(/\.[a-z]+(\?.*)?$/g)&&!e.href.match(/\.html?(\?.*)?$/g)},S=function(e){var t;while(!t&&e!==document)t=e.getAttribute("data-no-turbolink")!=null,e=e.parentNode;return t},P=function(e){return e.target.length!==0},T=function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey},g=function(t,n){return a(n)||e(n)||x(n)||S(n)||P(n)||T(t)},r=window.history&&window.history.pushState&&window.history.replaceState&&window.history.state!==void 0,r&&(document.addEventListener("click",b,!0),window.addEventListener("popstate",function(e){var t;if((t=e.state)!=null?t.turbolinks:void 0)return d(e.state)})),this.Turbolinks={visit:B}}.call(this),function(e){typeof define=="function"?define(e):e()}(function(){function h(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if(typeof n!="function")throw new TypeError;var i=r.call(arguments,1),s=function(){if(this instanceof s){var e=function(){};e.prototype=n.prototype;var o=new e,u=n.apply(o,i.concat(r.call(arguments)));return u!==null&&Object(u)===u?u:o}return n.apply(t,i.concat(r.call(arguments)))};return s});var e=Function.prototype.call,t=Array.prototype,n=Object.prototype,r=t.slice,i=e.bind(n.toString),s=e.bind(n.hasOwnProperty),o,u,a,f,l;if(l=s(n,"__defineGetter__"))o=e.bind(n.__defineGetter__),u=e.bind(n.__defineSetter__),a=e.bind(n.__lookupGetter__),f=e.bind(n.__lookupSetter__);Array.isArray||(Array.isArray=function(t){return i(t)=="[object Array]"}),Array.prototype.forEach||(Array.prototype.forEach=function(t){var n=A(this),r=arguments[1],s=0,o=n.length>>>0;if(i(t)!="[object Function]")throw new TypeError;while(s<o)s in n&&t.call(r,n[s],s,n),s++}),Array.prototype.map||(Array.prototype.map=function(t){var n=A(this),r=n.length>>>0,s=Array(r),o=arguments[1];if(i(t)!="[object Function]")throw new TypeError;for(var u=0;u<r;u++)u in n&&(s[u]=t.call(o,n[u],u,n));return s}),Array.prototype.filter||(Array.prototype.filter=function(t){var n=A(this),r=n.length>>>0,s=[],o=arguments[1];if(i(t)!="[object Function]")throw new TypeError;for(var u=0;u<r;u++)u in n&&t.call(o,n[u],u,n)&&s.push(n[u]);return s}),Array.prototype.every||(Array.prototype.every=function(t){var n=A(this),r=n.length>>>0,s=arguments[1];if(i(t)!="[object Function]")throw new TypeError;for(var o=0;o<r;o++)if(o in n&&!t.call(s,n[o],o,n))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var n=A(this),r=n.length>>>0,s=arguments[1];if(i(t)!="[object Function]")throw new TypeError;for(var o=0;o<r;o++)if(o in n&&t.call(s,n[o],o,n))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var n=A(this),r=n.length>>>0;if(i(t)!="[object Function]")throw new TypeError;if(!r&&arguments.length==1)throw new TypeError;var s=0,o;if(arguments.length>=2)o=arguments[1];else do{if(s in n){o=n[s++];break}if(++s>=r)throw new TypeError}while(!0);for(;s<r;s++)s in n&&(o=t.call(void 0,o,n[s],s,n));return o}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var n=A(this),r=n.length>>>0;if(i(t)!="[object Function]")throw new TypeError;if(!r&&arguments.length==1)throw new TypeError;var s,o=r-1;if(arguments.length>=2)s=arguments[1];else do{if(o in n){s=n[o--];break}if(--o<0)throw new TypeError}while(!0);do o in this&&(s=t.call(void 0,s,n[o],o,n));while(o--);return s}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var n=A(this),r=n.length>>>0;if(!r)return-1;var i=0;arguments.length>1&&(i=k(arguments[1])),i=i>=0?i:r-Math.abs(i);for(;i<r;i++)if(i in n&&n[i]===t)return i;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){var n=A(this),r=n.length>>>0;if(!r)return-1;var i=r-1;arguments.length>1&&(i=k(arguments[1])),i=i>=0?i:r-Math.abs(i);for(;i>=0;i--)if(i in n&&t===n[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:n)});if(!Object.getOwnPropertyDescriptor){var c="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,r){if(typeof t!="object"&&typeof t!="function"||t===null)throw new TypeError(c+t);if(!s(t,r))return;var i,o,u;i={enumerable:!0,configurable:!0};if(l){var h=t.__proto__;t.__proto__=n;var o=a(t,r),u=f(t,r);t.__proto__=h;if(o||u)return o&&(i.get=o),u&&(i.set=u),i}return i.value=t[r],i}}Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),Object.create||(Object.create=function(t,n){var r;if(t===null)r={__proto__:null};else{if(typeof t!="object")throw new TypeError("typeof prototype["+typeof t+"] != 'object'");var i=function(){};i.prototype=t,r=new i,r.__proto__=t}return n!==void 0&&Object.defineProperties(r,n),r});if(Object.defineProperty){var p=h({}),d=typeof document=="undefined"||h(document.createElement("div"));if(!p||!d)var v=Object.defineProperty}if(!Object.defineProperty||v){var m="Property description must be an object: ",g="Object.defineProperty called on non-object: ",y="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(t,r,i){if(typeof t!="object"&&typeof t!="function"||t===null)throw new TypeError(g+t);if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError(m+i);if(v)try{return v.call(Object,t,r,i)}catch(c){}if(s(i,"value"))if(l&&(a(t,r)||f(t,r))){var h=t.__proto__;t.__proto__=n,delete t[r],t[r]=i.value,t.__proto__=h}else t[r]=i.value;else{if(!l)throw new TypeError(y);s(i,"get")&&o(t,r,i.get),s(i,"set")&&u(t,r,i.set)}return t}}Object.defineProperties||(Object.defineProperties=function(t,n){for(var r in n)s(n,r)&&Object.defineProperty(t,r,n[r]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(b){Object.freeze=function(t){return function(n){return typeof n=="function"?n:t(n)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(t){return!1}),Object.isFrozen||(Object.isFrozen=function(t){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)===t)throw new TypeError;var n="";while(s(t,n))n+="?";t[n]=!0;var r=s(t,n);return delete t[n],r});if(!Object.keys){var w=!0,E=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],S=E.length;for(var x in{toString:null})w=!1;Object.keys=function O(e){if(typeof e!="object"&&typeof e!="function"||e===null)throw new TypeError("Object.keys called on a non-object");var O=[];for(var t in e)s(e,t)&&O.push(t);if(w)for(var n=0,r=S;n<r;n++){var i=E[n];s(e,i)&&O.push(i)}return O}}Date.prototype.toISOString||(Date.prototype.toISOString=function(){var t,n,r;if(!isFinite(this))throw new RangeError;t=[this.getUTCFullYear(),this.getUTCMonth()+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],n=t.length;while(n--)r=t[n],r<10&&(t[n]="0"+r);return t.slice(0,3).join("-")+"T"+t.slice(3).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}),Date.now||(Date.now=function(){return(new Date).getTime()}),Date.prototype.toJSON||(Date.prototype.toJSON=function(t){if(typeof this.toISOString!="function")throw new TypeError;return this.toISOString()}),isNaN(Date.parse("2011-06-15T21:40:05+06:00"))&&(Date=function(e){var t=function i(t,n,r,s,o,u,a){var f=arguments.length;if(this instanceof e){var l=f==1&&String(t)===t?new e(i.parse(t)):f>=7?new e(t,n,r,s,o,u,a):f>=6?new e(t,n,r,s,o,u):f>=5?new e(t,n,r,s,o):f>=4?new e(t,n,r,s):f>=3?new e(t,n,r):f>=2?new e(t,n):f>=1?new e(t):new e;return l.constructor=i,l}return e.apply(this,arguments)},n=new RegExp("^(\\d{4})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$");for(var r in e)t[r]=e[r];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(r){var i=n.exec(r);if(i){i.shift();for(var s=1;s<7;s++)i[s]=+(i[s]||(s<3?1:0)),s==1&&i[s]--;var o=+i.pop(),u=+i.pop(),a=i.pop(),f=0;if(a){if(u>23||o>59)return NaN;f=(u*60+o)*6e4*(a=="+"?-1:1)}return e.UTC.apply(this,i)+f}return e.parse.apply(this,arguments)},t}(Date));var T="	\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||T.trim()){T="["+T+"]";var N=new RegExp("^"+T+T+"*"),C=new RegExp(T+T+"*$");String.prototype.trim=function(){return String(this).replace(N,"").replace(C,"")}}var k=function(e){return e=+e,e!==e?e=-1:e!==0&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e},L="a"[0]!="a",A=function(e){if(e==null)throw new TypeError;return L&&typeof e=="string"&&e?e.split(""):Object(e)}}),function(){var e,t=[].slice;e=function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(e.Object,n,function(){})},e.version="0.13.0",e.config={pathPrefix:"/",usePushState:!1,minificationErrors:!0},(e.container=function(){return this}()).Batman=e,typeof define=="function"&&define("batman",[],function(){return e}),e.exportHelpers=function(t){var n,r,i,s;s=["mixin","extend","unmixin","redirect","typeOf","redirect","setImmediate","clearImmediate"];for(r=0,i=s.length;r<i;r++)n=s[r],t["$"+n]=e[n];return t},e.exportGlobals=function(){return e.exportHelpers(e.container)}}.call(this),function(){var e,t,n=[].slice,r={}.hasOwnProperty,i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Batman.typeOf=function(e){return typeof e=="undefined"?"Undefined":t.call(e).slice(8,-1)},t=Object.prototype.toString,Batman.extend=function(){var e,t,r,i,s,o,u;i=arguments[0],r=2<=arguments.length?n.call(arguments,1):[];for(o=0,u=r.length;o<u;o++){t=r[o];for(e in t)s=t[e],i[e]=s}return i},Batman.mixin=function(){var e,t,i,s,o,u,a,f;o=arguments[0],s=2<=arguments.length?n.call(arguments,1):[],e=typeof o.set=="function";for(a=0,f=s.length;a<f;a++){i=s[a];if(Batman.typeOf(i)!=="Object")continue;for(t in i){if(!r.call(i,t))continue;u=i[t];if(t==="initialize"||t==="uninitialize"||t==="prototype")continue;e?o.set(t,u):o.nodeName!=null?Batman.data(o,t,u):o[t]=u}typeof i.initialize=="function"&&i.initialize.call(o)}return o},Batman.unmixin=function(){var e,t,r,i,s,o;e=arguments[0],i=2<=arguments.length?n.call(arguments,1):[];for(s=0,o=i.length;s<o;s++){r=i[s];for(t in r){if(t==="initialize"||t==="uninitialize")continue;delete e[t]}typeof r.uninitialize=="function"&&r.uninitialize.call(e)}return e},Batman._functionName=Batman.functionName=function(e){var t;return e.__name__?e.__name__:e.name?e.name:(t=e.toString().match(/\W*function\s+([\w\$]+)\(/))!=null?t[1]:void 0},Batman._isChildOf=Batman.isChildOf=function(e,t){var n;n=t.parentNode;while(n){if(n===e)return!0;n=n.parentNode}return!1},Batman.setImmediate=Batman.clearImmediate=null,e=function(e){var t,n,r,s,o,u,a;return t=function(){var t,n;return e.postMessage?(t=!0,n=e.onmessage,e.onmessage=function(){return t=!1},e.postMessage("","*"),e.onmessage=n,t):!1},a=new Batman.SimpleHash,n=0,s=function(){return"go"+ ++n},e.setImmediate?(Batman.setImmediate=e.setImmediate,Batman.clearImmediate=e.clearImmediate):e.msSetImmediate?(Batman.setImmediate=msSetImmediate,Batman.clearImmediate=msClearImmediate):t()?(u="com.batman.",r=new Batman.SimpleHash,o=function(e){var t,n;if(!~e.data.search(u))return;return t=e.data.substring(u.length),typeof (n=a.unset(t))=="function"?n():void 0},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),Batman.setImmediate=function(t){var n;return a.set(n=s(),t),e.postMessage(u+n,"*"),n},Batman.clearImmediate=function(e){return a.unset(e)}):typeof document!="undefined"&&i.call(document.createElement("script"),"onreadystatechange")>=0?(Batman.setImmediate=function(e){var t,n;return t=s(),n=document.createElement("script"),n.onreadystatechange=function(){var e;return typeof (e=a.get(t))=="function"&&e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},document.documentElement.appendChild(n),t},Batman.clearImmediate=function(e){return a.unset(e)}):(typeof process!="undefined"&&process!==null?process.nextTick:void 0)?(r={},Batman.setImmediate=function(e){var t;return t=s(),r[t]=e,process.nextTick(function(){return typeof r[t]=="function"&&r[t](),delete r[t]}),t},Batman.clearImmediate=function(e){return delete r[e]}):(Batman.setImmediate=function(e){return setTimeout(e,0)},Batman.clearImmediate=function(e){return clearTimeout(e)}),Batman.setImmediate=Batman.setImmediate,Batman.clearImmediate=Batman.clearImmediate},Batman.setImmediate=function(){return e(Batman.container),Batman.setImmediate.apply(this,arguments)},Batman.clearImmediate=function(){return e(Batman.container),Batman.clearImmediate.apply(this,arguments)},Batman.forEach=function(e,t,n){var r,i,s,o,u,a,f,l;if(e.forEach)return e.forEach(t,n);if(e.indexOf){f=[];for(i=u=0,a=e.length;u<a;i=++u)r=e[i],f.push(t.call(n,r,i,e));return f}l=[];for(s in e)o=e[s],l.push(t.call(n,s,o,e));return l},Batman.objectHasKey=function(e,t){return typeof e.hasKey=="function"?e.hasKey(t):t in e},Batman.contains=function(e,t){return e.indexOf?i.call(e,t)>=0:typeof e.has=="function"?e.has(t):Batman.objectHasKey(e,t)},Batman.get=function(e,t){return typeof e.get=="function"?e.get(t):Batman.Property.forBaseAndKey(e,t).getValue()},Batman.getPath=function(e,t){var n,r,i;for(r=0,i=t.length;r<i;r++){n=t[r];if(e==null)return void 0;e=Batman.get(e,n);if(e==null)return e}return e},Batman.escapeHTML=function(){var e;return e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},function(t){return(""+t).replace(/[&<>'"]/g,function(t){return e[t]})}}(),Batman.translate=function(e,t){return t==null&&(t={}),Batman.helpers.interpolate(Batman.get(Batman.translate.messages,e),t)},Batman.translate.messages={},Batman.t=function(){return Batman.translate.apply(Batman,arguments)},Batman.redirect=function(e){var t;return(t=Batman.navigator)!=null?t.redirect(e):void 0},Batman.initializeObject=function(e){return e._batman!=null?e._batman.check(e):e._batman=new Batman._Batman(e)}}.call(this),function(){var e=[].slice,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Batman.Inflector=function(){function n(){this._plural=[],this._singular=[],this._uncountable=[],this._human=[]}return n.prototype.plural=function(e,t){return this._plural.unshift([e,t])},n.prototype.singular=function(e,t){return this._singular.unshift([e,t])},n.prototype.human=function(e,t){return this._human.unshift([e,t])},n.prototype.uncountable=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],this._uncountable=this._uncountable.concat(t.map(function(e){return new RegExp(""+e+"$","i")}))},n.prototype.irregular=function(e,t){return e.charAt(0)===t.charAt(0)?(this.plural(new RegExp("("+e.charAt(0)+")"+e.slice(1)+"$","i"),"$1"+t.slice(1)),this.plural(new RegExp("("+e.charAt(0)+")"+t.slice(1)+"$","i"),"$1"+t.slice(1)),this.singular(new RegExp("("+t.charAt(0)+")"+t.slice(1)+"$","i"),"$1"+e.slice(1))):(this.plural(new RegExp(""+e+"$","i"),t),this.plural(new RegExp(""+t+"$","i"),t),this.singular(new RegExp(""+t+"$","i"),e))},n.prototype.ordinalize=function(e){var n,r;n=Math.abs(parseInt(e));if(r=n%100,t.call([11,12,13],r)>=0)return e+"th";switch(n%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd";default:return e+"th"}},n.prototype.pluralize=function(e){var t,n,r,i,s,o,u,a,f,l;a=this._uncountable;for(i=0,o=a.length;i<o;i++){r=a[i];if(r.test(e))return e}f=this._plural;for(s=0,u=f.length;s<u;s++){l=f[s],t=l[0],n=l[1];if(t.test(e))return e.replace(t,n)}return e},n.prototype.singularize=function(e){var t,n,r,i,s,o,u,a,f,l;a=this._uncountable;for(i=0,o=a.length;i<o;i++){r=a[i];if(r.test(e))return e}f=this._singular;for(s=0,u=f.length;s<u;s++){l=f[s],t=l[0],n=l[1];if(t.test(e))return e.replace(t,n)}return e},n.prototype.humanize=function(e){var t,n,r,i,s,o;s=this._human;for(r=0,i=s.length;r<i;r++){o=s[r],t=o[0],n=o[1];if(t.test(e))return e.replace(t,n)}return e},n}()}.call(this),function(){var e,t,n,r,i,s,o,u;t=/(?:^|_|\-)(.)/g,n=/(^|\s)([a-z])/g,o=/([A-Z]+)([A-Z][a-z])/g,u=/([a-z\d])([A-Z])/g,r=/_id$/,i=/_|-/g,s=/^\w/g,Batman.helpers={ordinalize:function(){return Batman.helpers.inflector.ordinalize.apply(Batman.helpers.inflector,arguments)},singularize:function(){return Batman.helpers.inflector.singularize.apply(Batman.helpers.inflector,arguments)},pluralize:function(e,t,n,r){var i;return r==null&&(r=!0),arguments.length<2?Batman.helpers.inflector.pluralize(e):(i=+e===1?t:n||Batman.helpers.inflector.pluralize(t),r&&(i=""+(e||0)+" "+i),i)},camelize:function(e,n){return e=e.replace(t,function(e,t){return t.toUpperCase()}),n?e.substr(0,1).toLowerCase()+e.substr(1):e},underscore:function(e){return e.replace(o,"$1_$2").replace(u,"$1_$2").replace("-","_").toLowerCase()},capitalize:function(e){return e.replace(n,function(e,t,n){return t+n.toUpperCase()})},trim:function(e){return e?e.trim():""},interpolate:function(e,t){var n,r,i;typeof e=="object"?(r=e[t.count],r||(r=e.other)):r=e;for(n in t)i=t[n],r=r.replace(new RegExp("%\\{"+n+"\\}","g"),i);return r},humanize:function(e){return e=Batman.helpers.underscore(e),e=Batman.helpers.inflector.humanize(e),e.replace(r,"").replace(i," ").replace(s,function(e){return e.toUpperCase()})}},e=new Batman.Inflector,Batman.helpers.inflector=e,e.plural(/$/,"s"),e.plural(/s$/i,"s"),e.plural(/(ax|test)is$/i,"$1es"),e.plural(/(octop|vir)us$/i,"$1i"),e.plural(/(octop|vir)i$/i,"$1i"),e.plural(/(alias|status)$/i,"$1es"),e.plural(/(bu)s$/i,"$1ses"),e.plural(/(buffal|tomat)o$/i,"$1oes"),e.plural(/([ti])um$/i,"$1a"),e.plural(/([ti])a$/i,"$1a"),e.plural(/sis$/i,"ses"),e.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),e.plural(/(hive)$/i,"$1s"),e.plural(/([^aeiouy]|qu)y$/i,"$1ies"),e.plural(/(x|ch|ss|sh)$/i,"$1es"),e.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),e.plural(/([m|l])ouse$/i,"$1ice"),e.plural(/([m|l])ice$/i,"$1ice"),e.plural(/^(ox)$/i,"$1en"),e.plural(/^(oxen)$/i,"$1"),e.plural(/(quiz)$/i,"$1zes"),e.singular(/s$/i,""),e.singular(/(n)ews$/i,"$1ews"),e.singular(/([ti])a$/i,"$1um"),e.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"),e.singular(/(^analy)ses$/i,"$1sis"),e.singular(/([^f])ves$/i,"$1fe"),e.singular(/(hive)s$/i,"$1"),e.singular(/(tive)s$/i,"$1"),e.singular(/([lr])ves$/i,"$1f"),e.singular(/([^aeiouy]|qu)ies$/i,"$1y"),e.singular(/(s)eries$/i,"$1eries"),e.singular(/(m)ovies$/i,"$1ovie"),e.singular(/(x|ch|ss|sh)es$/i,"$1"),e.singular(/([m|l])ice$/i,"$1ouse"),e.singular(/(bus)es$/i,"$1"),e.singular(/(o)es$/i,"$1"),e.singular(/(shoe)s$/i,"$1"),e.singular(/(cris|ax|test)es$/i,"$1is"),e.singular(/(octop|vir)i$/i,"$1us"),e.singular(/(alias|status)es$/i,"$1"),e.singular(/^(ox)en/i,"$1"),e.singular(/(vert|ind)ices$/i,"$1ex"),e.singular(/(matr)ices$/i,"$1ix"),e.singular(/(quiz)zes$/i,"$1"),e.singular(/(database)s$/i,"$1"),e.irregular("person","people"),e.irregular("man","men"),e.irregular("child","children"),e.irregular("sex","sexes"),e.irregular("move","moves"),e.irregular("cow","kine"),e.irregular("zombie","zombies"),e.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans")}.call(this),function(){var e;Batman.developer={suppressed:!1,DevelopmentError:function(){var e;return e=function(e){return this.message=e,this.name="DevelopmentError"},e.prototype=Error.prototype,e}(),_ie_console:function(e,t){var n,r,i,s;t.length!==1&&typeof console!="undefined"&&console!==null&&console[e]("..."+e+" of "+t.length+" items..."),s=[];for(r=0,i=t.length;r<i;r++)n=t[r],s.push(typeof console!="undefined"&&console!==null?console[e](n):void 0);return s},suppress:function(t){e.suppressed=!0;if(t)return t(),e.suppressed=!1},unsuppress:function(){return e.suppressed=!1},log:function(){if(e.suppressed||(typeof console!=="undefined"&&console!==null?console.log:void 0)==null)return;return console.log.apply?console.log.apply(console,arguments):e._ie_console("log",arguments)},warn:function(){if(e.suppressed||(typeof console!=="undefined"&&console!==null?console.warn:void 0)==null)return;return console.warn.apply?console.warn.apply(console,arguments):e._ie_console("warn",arguments)},error:function(t){throw new e.DevelopmentError(t)},assert:function(t,n){if(!t)return e.error(n)},"do":function(t){if(!e.suppressed)return t()},addFilters:function(){return Batman.extend(Batman.Filters,{log:function(e,t){return typeof console!="undefined"&&console!==null&&typeof console.log=="function"&&console.log(arguments),e},logStack:function(t){return typeof console!="undefined"&&console!==null&&typeof console.log=="function"&&console.log(e.currentFilterStack),t}})}},e=Batman.developer,Batman.developer.assert(function(){}.bind,"Error! Batman needs Function.bind to work! Please shim it using something like es5-shim or augmentjs!")}.call(this),function(){var e;Batman._Batman=e=function(){function e(e){this.object=e}return e.prototype.check=function(e){return e!==this.object?(e._batman=new Batman._Batman(e),!1):!0},e.prototype.get=function(e){var t,n;n=this.getAll(e);switch(n.length){case 0:return void 0;case 1:return n[0];default:return t=n[0].concat!=null?function(e,t){return e.concat(t)}:n[0].merge!=null?function(e,t){return e.merge(t)}:n.every(function(e){return typeof e=="object"})?(n.unshift({}),function(e,t){return Batman.extend(e,t)}):void 0,t?n.reduceRight(t):n}},e.prototype.getFirst=function(e){var t;return t=this.getAll(e),t[0]},e.prototype.getAll=function(e){var t,n,r;return typeof e=="function"?t=e:t=function(t){var n;return(n=t._batman)!=null?n[e]:void 0},n=this.ancestors(t),(r=t(this.object))&&n.unshift(r),n},e.prototype.ancestors=function(e){var t,n,r,i,s,o,u;return e==null&&(e=function(e){return e}),i=[],t=!!this.object.prototype,n=t?(o=this.object.__super__)!=null?o.constructor:void 0:(r=Object.getPrototypeOf(this.object))===this.object?this.object.constructor.__super__:r,n!=null&&((u=n._batman)!=null&&u.check(n),s=e(n),s!=null&&i.push(s),n._batman!=null&&(i=i.concat(n._batman.ancestors(e)))),i},e.prototype.set=function(e,t){return this[e]=t},e}()}.call(this),function(){Batman.Event=function(){function e(e,t){this.base=e,this.key=t,this.handlers=[],this._preventCount=0}return e.forBaseAndKey=function(e,t){return e.isEventEmitter?e.event(t):new Batman.Event(e,t)},e.prototype.isEvent=!0,e.prototype.isEqual=function(e){return this.constructor===e.constructor&&this.base===e.base&&this.key===e.key},e.prototype.hashKey=function(){var e;return this.hashKey=function(){return e},e="<Batman.Event base: "+Batman.Hash.prototype.hashKeyFor(this.base)+', key: "'+Batman.Hash.prototype.hashKeyFor(this.key)+'">'},e.prototype.addHandler=function(e){return this.handlers.indexOf(e)===-1&&this.handlers.push(e),this.oneShot&&this.autofireHandler(e),this},e.prototype.removeHandler=function(e){var t;return(t=this.handlers.indexOf(e))!==-1&&this.handlers.splice(t,1),this},e.prototype.eachHandler=function(e){var t,n,r;this.handlers.slice().forEach(e);if((n=this.base)!=null?n.isEventEmitter:void 0)return t=this.key,(r=this.base._batman)!=null?r.ancestors(function(n){var r,i,s;if(n.isEventEmitter&&((i=n._batman)!=null?(s=i.events)!=null?s.hasOwnProperty(t):void 0:void 0))return r=n.event(t).handlers,r.slice().forEach(e)}):void 0},e.prototype.clearHandlers=function(){return this.handlers=[]},e.prototype.handlerContext=function(){return this.base},e.prototype.prevent=function(){return++this._preventCount},e.prototype.allow=function(){return this._preventCount&&--this._preventCount,this._preventCount},e.prototype.isPrevented=function(){return this._preventCount>0},e.prototype.autofireHandler=function(e){if(this._oneShotFired&&this._oneShotArgs!=null)return e.apply(this.handlerContext(),this._oneShotArgs)},e.prototype.resetOneShot=function(){return this._oneShotFired=!1,this._oneShotArgs=null},e.prototype.fire=function(){var e,t;return this.isPrevented()||this._oneShotFired?!1:(t=this.handlerContext(),e=arguments,this.oneShot&&(this._oneShotFired=!0,this._oneShotArgs=arguments),this.eachHandler(function(n){return n.apply(t,e)}))},e.prototype.allowAndFire=function(){return this.allow(),this.fire.apply(this,arguments)},e}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PropertyEvent=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.eachHandler=function(e){return this.base.eachObserver(e)},n.prototype.handlerContext=function(){return this.base.base},n}(Batman.Event)}.call(this),function(){var e=[].slice;Batman.EventEmitter={isEventEmitter:!0,hasEvent:function(e){var t,n;return(t=this._batman)!=null?typeof t.get=="function"?(n=t.get("events"))!=null?n.hasOwnProperty(e):void 0:void 0:void 0},event:function(e){var t,n,r,i,s;return Batman.initializeObject(this),t=this.eventClass||Batman.Event,n=(s=this._batman).events||(s.events={}),n.hasOwnProperty(e)?r=n[e]:(this._batman.ancestors(function(t){var n,i;return r||(r=(n=t._batman)!=null?(i=n.events)!=null?i[e]:void 0:void 0)}),i=n[e]=new t(this,e),i.oneShot=r!=null?r.oneShot:void 0,i)},on:function(){var t,n,r,i,s,o,u;r=2<=arguments.length?e.call(arguments,0,i=arguments.length-1):(i=0,[]),t=arguments[i++],u=[];for(s=0,o=r.length;s<o;s++)n=r[s],u.push(this.event(n).addHandler(t));return u},once:function(e,t){var n,r;return n=this.event(e),r=function(){return t.apply(this,arguments),n.removeHandler(r)},n.addHandler(r)},registerAsMutableSource:function(){return Batman.Property.registerSource(this)},mutation:function(e){return function(){var t;return t=e.apply(this,arguments),this.event("change").fire(this,this),t}},prevent:function(e){return this.event(e).prevent(),this},allow:function(e){return this.event(e).allow(),this},isPrevented:function(e){return this.event(e).isPrevented()},fire:function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.event(n)).fire.apply(r,t)},allowAndFire:function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.event(n)).allowAndFire.apply(r,t)}}}.call(this),function(){var e=[].slice;Batman.Enumerable={isEnumerable:!0,map:function(e,t){var n;return t==null&&(t=Batman.container),n=[],this.forEach(function(){return n.push(e.apply(t,arguments))}),n},mapToProperty:function(e){var t;return t=[],this.forEach(function(n){return t.push(n.get(e))}),t},every:function(e,t){var n;return t==null&&(t=Batman.container),n=!0,this.forEach(function(){return n=n&&e.apply(t,arguments)}),n},some:function(e,t){var n;return t==null&&(t=Batman.container),n=!1,this.forEach(function(){return n=n||e.apply(t,arguments)}),n},reduce:function(t,n){var r,i;return r=0,i=this,this.forEach(function(){return n!=null?n=t.apply(null,[n].concat(e.call(arguments),[r],[i])):n=arguments[0]}),n},filter:function(e){var t,n;return t=new 
this.constructor,t.add?n=function(t,n){return e(n)&&t.add(n),t}:t.set?n=function(t,n,r){return e(n,r)&&t.set(n,r),t}:(t.push||(t=[]),n=function(t,n){return e(n)&&t.push(n),t}),this.reduce(n,t)},inGroupsOf:function(e){var t,n,r;return r=[],t=!1,n=0,this.forEach(function(s){return n++%e===0&&(t=[],r.push(t)),t.push(s)}),r}}}.call(this),function(){var e=[].slice;Batman.SimpleHash=function(){function t(e){this._storage={},this.length=0,e!=null&&this.update(e)}return Batman.extend(t.prototype,Batman.Enumerable),t.prototype.propertyClass=Batman.Property,t.prototype.hasKey=function(e){var t,n,r,i;if(this.objectKey(e)){if(!this._objectStorage)return!1;if(n=this._objectStorage[this.hashKeyFor(e)])for(r=0,i=n.length;r<i;r++){t=n[r];if(this.equality(t[0],e))return!0}return!1}return e=this.prefixedKey(e),this._storage.hasOwnProperty(e)},t.prototype.get=function(e){var t,n,r,i;if(!this.objectKey(e))return this._storage[this.prefixedKey(e)];if(!this._objectStorage)return void 0;if(n=this._objectStorage[this.hashKeyFor(e)])for(r=0,i=n.length;r<i;r++){t=n[r];if(this.equality(t[0],e))return t[1]}},t.prototype.set=function(e,t){var n,r,i,s,o,u;if(this.objectKey(e)){this._objectStorage||(this._objectStorage={}),r=(i=this._objectStorage)[u=this.hashKeyFor(e)]||(i[u]=[]);for(s=0,o=r.length;s<o;s++){n=r[s];if(this.equality(n[0],e))return n[1]=t}return this.length++,r.push([e,t]),t}return e=this.prefixedKey(e),this._storage[e]==null&&this.length++,this._storage[e]=t},t.prototype.unset=function(e){var t,n,r,i,s,o,u,a,f,l;if(!this.objectKey(e))return e=this.prefixedKey(e),o=this._storage[e],this._storage[e]!=null&&(this.length--,delete this._storage[e]),o;if(!this._objectStorage)return void 0;t=this.hashKeyFor(e);if(s=this._objectStorage[t])for(n=a=0,f=s.length;a<f;n=++a){l=s[n],r=l[0],u=l[1];if(this.equality(r,e))return i=s.splice(n,1),s.length||delete this._objectStorage[t],this.length--,i[0][1]}},t.prototype.getOrSet=function(e,t){var n;return n=this.get(e),n||(n=t(),this.set(e,n)),n},t.prototype.prefixedKey=function(e){return"_"+e},t.prototype.unprefixedKey=function(e){return e.slice(1)},t.prototype.hashKeyFor=function(e){return(e!=null?typeof e.hashKey=="function"?e.hashKey():void 0:void 0)||e},t.prototype.equality=function(e,t){return e===t?!0:e!==e&&t!==t?!0:(e!=null?typeof e.isEqual=="function"?e.isEqual(t):void 0:void 0)&&(t!=null?typeof t.isEqual=="function"?t.isEqual(e):void 0:void 0)?!0:!1},t.prototype.objectKey=function(e){return typeof e!="string"},t.prototype.forEach=function(e,t){var n,r,i,s,o,u,a,f,l,c,h;i=[];if(this._objectStorage){f=this._objectStorage;for(n in f){o=f[n],l=o.slice();for(u=0,a=l.length;u<a;u++)c=l[u],r=c[0],s=c[1],i.push(e.call(t,r,s,this))}}h=this._storage;for(n in h)s=h[n],i.push(e.call(t,this.unprefixedKey(n),s,this));return i},t.prototype.keys=function(){var e;return e=[],Batman.SimpleHash.prototype.forEach.call(this,function(t){return e.push(t)}),e},t.prototype.toArray=t.prototype.keys,t.prototype.clear=function(){return this._storage={},delete this._objectStorage,this.length=0},t.prototype.isEmpty=function(){return this.length===0},t.prototype.merge=function(){var t,n,r,i,s;r=1<=arguments.length?e.call(arguments,0):[],n=new this.constructor,r.unshift(this);for(i=0,s=r.length;i<s;i++)t=r[i],t.forEach(function(e,t){return n.set(e,t)});return n},t.prototype.update=function(e){var t,n,r;r=[];for(t in e)n=e[t],r.push(this.set(t,n));return r},t.prototype.replace=function(e){var t=this;return this.forEach(function(n,r){if(!(n in e))return t.unset(n)}),this.update(e)},t.prototype.toObject=function(){var e,t,n,r,i,s;t={},i=this._storage;for(e in i)r=i[e],t[this.unprefixedKey(e)]=r;if(this._objectStorage){s=this._objectStorage;for(e in s)n=s[e],t[e]=n[0][1]}return t},t.prototype.toJSON=t.prototype.toObject,t}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.AssociationCurator=function(e){function r(e){this.model=e,r.__super__.constructor.call(this),this._byTypeStorage=new Batman.SimpleHash}return t(r,e),r.availableAssociations=["belongsTo","hasOne","hasMany"],r.prototype.add=function(e){var t;return this.set(e.label,e),(t=this._byTypeStorage.get(e.associationType))||(t=new Batman.SimpleSet,this._byTypeStorage.set(e.associationType,t)),t.add(e)},r.prototype.getByType=function(e){return this._byTypeStorage.get(e)},r.prototype.getByLabel=function(e){return this.get(e)},r.prototype.reset=function(){return this.forEach(function(e,t){return t.reset()}),!0},r.prototype.merge=function(){var e,t;return e=1<=arguments.length?n.call(arguments,0):[],t=r.__super__.merge.apply(this,arguments),t._byTypeStorage=this._byTypeStorage.merge(e.map(function(e){return e._byTypeStorage})),t},r.prototype._markDirtyAttribute=function(e,t){var n;if((n=this.lifecycle.get("state"))!=="loading"&&n!=="creating"&&n!=="saving"&&n!=="saved"){if(this.lifecycle.startTransition("set"))return this.dirtyKeys.set(e,t);throw new Batman.StateMachine.InvalidTransitionError("Can't set while in state "+this.lifecycle.get("state"))}},r}(Batman.SimpleHash)}.call(this),function(){var e=[].slice;Batman.SimpleSet=function(){function t(){this._storage=[],this.length=0,arguments.length>0&&this.add.apply(this,arguments)}return Batman.extend(t.prototype,Batman.Enumerable),t.prototype.has=function(e){return!!~this._indexOfItem(e)},t.prototype.add=function(){var t,n,r,i,s;r=1<=arguments.length?e.call(arguments,0):[],t=[];for(i=0,s=r.length;i<s;i++){n=r[i];if(!!~this._indexOfItem(n))continue;this._storage.push(n),t.push(n)}return this.length=this._storage.length,this.fire&&t.length!==0&&(this.fire("change",this,this),this.fire.apply(this,["itemsWereAdded"].concat(e.call(t)))),t},t.prototype.remove=function(){var t,n,r,i,s,o;r=1<=arguments.length?e.call(arguments,0):[],i=[];for(s=0,o=r.length;s<o;s++){n=r[s];if(!~(t=this._indexOfItem(n)))continue;this._storage.splice(t,1),i.push(n)}return this.length=this._storage.length,this.fire&&i.length!==0&&(this.fire("change",this,this),this.fire.apply(this,["itemsWereRemoved"].concat(e.call(i)))),i},t.prototype.find=function(e){var t,n,r,i;i=this._storage;for(n=0,r=i.length;n<r;n++){t=i[n];if(e(t))return t}},t.prototype.forEach=function(e,t){var n;return n=this,this._storage.slice().forEach(function(r){return e.call(t,r,null,n)})},t.prototype.isEmpty=function(){return this.length===0},t.prototype.clear=function(){var t;return t=this._storage,this._storage=[],this.length=0,this.fire&&t.length!==0&&(this.fire("change",this,this),this.fire.apply(this,["itemsWereRemoved"].concat(e.call(t)))),t},t.prototype.replace=function(e){try{return typeof this.prevent=="function"&&this.prevent("change"),this.clear(),this.add.apply(this,e.toArray())}finally{typeof this.allowAndFire=="function"&&this.allowAndFire("change",this,this)}},t.prototype.toArray=function(){return this._storage.slice()},t.prototype.merge=function(){var t,n,r,i,s;n=1<=arguments.length?e.call(arguments,0):[],t=new this.constructor,n.unshift(this);for(i=0,s=n.length;i<s;i++)r=n[i],r.forEach(function(e){return t.add(e)});return t},t.prototype.indexedBy=function(e){return this._indexes||(this._indexes=new Batman.SimpleHash),this._indexes.get(e)||this._indexes.set(e,new Batman.SetIndex(this,e))},t.prototype.indexedByUnique=function(e){return this._uniqueIndexes||(this._uniqueIndexes=new Batman.SimpleHash),this._uniqueIndexes.get(e)||this._uniqueIndexes.set(e,new Batman.UniqueSetIndex(this,e))},t.prototype.sortedBy=function(e,t){var n;return t==null&&(t="asc"),t=t.toLowerCase()==="desc"?"desc":"asc",this._sorts||(this._sorts=new Batman.SimpleHash),n=this._sorts.get(e)||this._sorts.set(e,new Batman.Object),n.get(t)||n.set(t,new Batman.SetSort(this,e,t))},t.prototype.equality=Batman.SimpleHash.prototype.equality,t.prototype._indexOfItem=function(e){var t,n,r,i,s;s=this._storage;for(t=r=0,i=s.length;r<i;t=++r){n=s[t];if(this.equality(e,n))return t}return-1},t}()}.call(this),function(){var e=[].slice;Batman.Property=function(){function t(e,t){this.base=e,this.key=t}return Batman.mixin(t.prototype,Batman.EventEmitter),t._sourceTrackerStack=[],t.sourceTracker=function(){var e;return(e=this._sourceTrackerStack)[e.length-1]},t.defaultAccessor={get:function(e){return this[e]},set:function(e,t){return this[e]=t},unset:function(e){var t;return t=this[e],delete this[e],t},cache:!1},t.defaultAccessorForBase=function(e){var t;return((t=e._batman)!=null?t.getFirst("defaultAccessor"):void 0)||Batman.Property.defaultAccessor},t.accessorForBaseAndKey=function(e,t){var n,r,i,s=this;return(r=e._batman)!=null&&(n=(i=r.keyAccessors)!=null?i.get(t):void 0,n||r.ancestors(function(e){var r,i;return n||(n=(r=e._batman)!=null?(i=r.keyAccessors)!=null?i.get(t):void 0:void 0)})),n||this.defaultAccessorForBase(e)},t.forBaseAndKey=function(e,t){return e.isObservable?e.property(t):new Batman.Keypath(e,t)},t.withoutTracking=function(e){return this.wrapTrackingPrevention(e)()},t.wrapTrackingPrevention=function(e){return function(){Batman.Property.pushDummySourceTracker();try{return e.apply(this,arguments)}finally{Batman.Property.popSourceTracker()}}},t.registerSource=function(e){var t;if(!e.isEventEmitter)return;return(t=this.sourceTracker())!=null?t.add(e):void 0},t.pushSourceTracker=function(){return Batman.Property._sourceTrackerStack.push(new Batman.SimpleSet)},t.pushDummySourceTracker=function(){return Batman.Property._sourceTrackerStack.push(null)},t.popSourceTracker=function(){return Batman.Property._sourceTrackerStack.pop()},t.prototype._isolationCount=0,t.prototype.cached=!1,t.prototype.value=null,t.prototype.sources=null,t.prototype.isProperty=!0,t.prototype.isDead=!1,t.prototype.eventClass=Batman.PropertyEvent,t.prototype.isEqual=function(e){return this.constructor===e.constructor&&this.base===e.base&&this.key===e.key},t.prototype.hashKey=function(){var e;return this.hashKey=function(){return e},e="<Batman.Property base: "+Batman.Hash.prototype.hashKeyFor(this.base)+', key: "'+Batman.Hash.prototype.hashKeyFor(this.key)+'">'},t.prototype.event=function(e){var t,n;return t=this.eventClass||Batman.Event,this.events||(this.events={}),(n=this.events)[e]||(n[e]=new t(this,e)),this.events[e]},t.prototype.changeEvent=function(){var e;return e=this.event("change"),this.changeEvent=function(){return e},e},t.prototype.accessor=function(){var e;return e=this.constructor.accessorForBaseAndKey(this.base,this.key),this.accessor=function(){return e},e},t.prototype.eachObserver=function(e){var t;t=this.key,this.changeEvent().handlers.slice().forEach(e);if(this.base.isObservable)return this.base._batman.ancestors(function(n){var r,i;if(n.isObservable&&n.hasProperty(t))return i=n.property(t),r=i.changeEvent().handlers,r.slice().forEach(e)})},t.prototype.observers=function(){var e;return e=[],this.eachObserver(function(t){return e.push(t)}),e},t.prototype.hasObservers=function(){return this.observers().length>0},t.prototype.updateSourcesFromTracker=function(){var e,t;return t=this.constructor.popSourceTracker(),e=this.sourceChangeHandler(),this._eachSourceChangeEvent(function(t){return t.removeHandler(e)}),this.sources=t,this._eachSourceChangeEvent(function(t){return t.addHandler(e)})},t.prototype._eachSourceChangeEvent=function(e){if(this.sources==null)return;return this.sources.forEach(function(t){return e(t.event("change"))})},t.prototype.getValue=function(){this.registerAsMutableSource();if(!this.isCached()){this.constructor.pushSourceTracker();try{this.value=this.valueFromAccessor(),this.cached=!0}finally{this.updateSourcesFromTracker()}}return this.value},t.prototype.isCachable=function(){var e;return this.isFinal()?!0:(e=this.accessor().cache,e!=null?!!e:!0)},t.prototype.isCached=function(){return this.isCachable()&&this.cached},t.prototype.isFinal=function(){return!!this.accessor()["final"]},t.prototype.refresh=function(){var e,t;this.cached=!1,e=this.value,t=this.getValue(),t!==e&&!this.isIsolated()&&this.fire(t,e);if(this.value!==void 0&&this.isFinal())return this.lockValue()},t.prototype.sourceChangeHandler=function(){var e,t=this;return e=this._handleSourceChange.bind(this),Batman.developer["do"](function(){return e.property=t}),this.sourceChangeHandler=function(){return e},e},t.prototype._handleSourceChange=function(){return this.isIsolated()?this._needsRefresh=!0:!this.isFinal()&&!this.hasObservers()?this.cached=!1:this.refresh()},t.prototype.valueFromAccessor=function(){var e;return(e=this.accessor().get)!=null?e.call(this.base,this.key):void 0},t.prototype.setValue=function(e){var t;if(!(t=this.accessor().set))return;return this._changeValue(function(){return t.call(this.base,this.key,e)})},t.prototype.unsetValue=function(){var e;if(!(e=this.accessor().unset))return;return this._changeValue(function(){return e.call(this.base,this.key)})},t.prototype._changeValue=function(e){var t;this.cached=!1,this.constructor.pushDummySourceTracker();try{t=e.apply(this),this.refresh()}finally{this.constructor.popSourceTracker()}return!this.isCached()&&!this.hasObservers()&&this.die(),t},t.prototype.forget=function(e){return e!=null?this.changeEvent().removeHandler(e):this.changeEvent().clearHandlers()},t.prototype.observeAndFire=function(e){return this.observe(e),e.call(this.base,this.value,this.value,this.key)},t.prototype.observe=function(e){return this.changeEvent().addHandler(e),this.sources==null&&this.getValue(),this},t.prototype.observeOnce=function(e){var t,n;return t=this.changeEvent(),n=function(){return e.apply(this,arguments),t.removeHandler(n)},t.addHandler(n),this.sources==null&&this.getValue(),this},t.prototype._removeHandlers=function(){var e;return e=this.sourceChangeHandler(),this._eachSourceChangeEvent(function(t){return t.removeHandler(e)}),delete this.sources,this.changeEvent().clearHandlers()},t.prototype.lockValue=function(){return this._removeHandlers(),this.getValue=function(){return this.value},this.setValue=this.unsetValue=this.refresh=this.observe=function(){}},t.prototype.die=function(){var e,t;return this._removeHandlers(),(e=this.base._batman)!=null&&(t=e.properties)!=null&&t.unset(this.key),this.isDead=!0},t.prototype.fire=function(){var t;return(t=this.changeEvent()).fire.apply(t,e.call(arguments).concat([this.key]))},t.prototype.isolate=function(){return this._isolationCount===0&&(this._preIsolationValue=this.getValue()),this._isolationCount++},t.prototype.expose=function(){if(this._isolationCount===1)return this._isolationCount--,this._needsRefresh?(this.value=this._preIsolationValue,this.refresh()):this.value!==this._preIsolationValue&&this.fire(this.value,this._preIsolationValue),this._preIsolationValue=null;if(this._isolationCount>0)return this._isolationCount--},t.prototype.isIsolated=function(){return this._isolationCount>0},t}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Keypath=function(e){function n(e,t){typeof t=="string"?(this.segments=t.split("."),this.depth=this.segments.length):(this.segments=[t],this.depth=1),n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.isCachable=function(){return this.depth===1?n.__super__.isCachable.apply(this,arguments):!0},n.prototype.terminalProperty=function(){var e;e=Batman.getPath(this.base,this.segments.slice(0,-1));if(e==null)return;return Batman.Keypath.forBaseAndKey(e,this.segments[this.depth-1])},n.prototype.valueFromAccessor=function(){return this.depth===1?n.__super__.valueFromAccessor.apply(this,arguments):Batman.getPath(this.base,this.segments)},n.prototype.setValue=function(e){var t;return this.depth===1?n.__super__.setValue.apply(this,arguments):(t=this.terminalProperty())!=null?t.setValue(e):void 0},n.prototype.unsetValue=function(){var e;return this.depth===1?n.__super__.unsetValue.apply(this,arguments):(e=this.terminalProperty())!=null?e.unsetValue():void 0},n}(Batman.Property)}.call(this),function(){var e=[].slice;Batman.Observable={isObservable:!0,hasProperty:function(e){var t,n;return(t=this._batman)!=null?(n=t.properties)!=null?typeof n.hasKey=="function"?n.hasKey(e):void 0:void 0:void 0},property:function(e){var t,n,r;return Batman.initializeObject(this),n=this.propertyClass||Batman.Keypath,t=(r=this._batman).properties||(r.properties=new Batman.SimpleHash),t.get(e)||t.set(e,new n(this,e))},get:function(e){return this.property(e).getValue()},set:function(e,t){return this.property(e).setValue(t)},unset:function(e){return this.property(e).unsetValue()},getOrSet:Batman.SimpleHash.prototype.getOrSet,forget:function(e,t){var n;return e?this.property(e).forget(t):(n=this._batman.properties)!=null&&n.forEach(function(e,t){return t.forget()}),this},observe:function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.property(n)).observe.apply(r,t),this},observeAndFire:function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.property(n)).observeAndFire.apply(r,t),this},observeOnce:function(){var t,n,r;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],(r=this.property(n)).observeOnce.apply(r,t),this}}}.call(this),function(){Batman.DOM={textInputTypes:["text","search","tel","url","email","password"],scrollIntoView:function(e){var t;return(t=document.getElementById(e))!=null?typeof t.scrollIntoView=="function"?t.scrollIntoView():void 0:void 0},partial:function(e,t,n,r){var i;return r.prevent("rendered"),i=new Batman.View({source:t,context:n}),i.on("ready",function(){return Batman.DOM.setInnerHTML(e,""),Batman.DOM.appendChild(e,i.get("node")),r.allowAndFire("rendered")})},propagateBindingEvent:function(e,t){var n,r,i,s,o;while(n=(n||t).parentNode){i=Batman._data(n,"bindings");if(i!=null)for(s=0,o=i.length;s<o;s++)r=i[s],typeof r.childBindingAdded=="function"&&r.childBindingAdded(e)}},propagateBindingEvents:function(e){var t,n,r,i,s,o,u,a;a=e.childNodes;for(i=0,o=a.length;i<o;i++)r=a[i],Batman.DOM.propagateBindingEvents(r);if(n=Batman._data(e,"bindings"))for(s=0,u=n.length;s<u;s++)t=n[s],Batman.DOM.propagateBindingEvent(t,e)},trackBinding:function(e,t){var n;return(n=Batman._data(t,"bindings"))?n.push(e):Batman._data(t,"bindings",[e]),Batman.DOM.fire("bindingAdded",e),Batman.DOM.propagateBindingEvent(e,t),!0},onParseExit:function(e,t){var n;return n=Batman._data(e,"onParseExit")||Batman._data(e,"onParseExit",new Batman.SimpleSet),t!=null&&n.add(t),n},forgetParseExit:function(e,t){return Batman.removeData(e,"onParseExit",!0)},defineView:function(e,t){var n;return n=t.innerHTML,Batman.View.store.set(Batman.Navigator.normalizePath(e),n),n},setStyleProperty:function(e,t,n,r){return e.style.setAttribute?e.style.setAttribute(t,n,r):e.style.setProperty(t,n,r)},removeOrDestroyNode:function(e){var t;return t=Batman._data(e,"view"),t||(t=Batman._data(e,"yielder")),t!=null&&t.get("cached")?Batman.DOM.removeNode(e):Batman.DOM.destroyNode(e)},insertBefore:function(e,t,n){return n==null&&(n=null),!n||e.childNodes.length<=0?Batman.DOM.appendChild(e,t):(Batman.DOM.willInsertNode(t),e.insertBefore(t,n),Batman.DOM.didInsertNode(t))},valueForNode:function(e,t,n){var r;t==null&&(t=""),n==null&&(n=!0),r=arguments.length>1;switch(e.nodeName.toUpperCase()){case"INPUT":case"TEXTAREA":return r?e.value=t:e.value;case"SELECT":if(r)return e.value=t;break;default:return r?Batman.DOM.setInnerHTML(e,n?Batman.escapeHTML(t):t):e.innerHTML}},nodeIsEditable:function(e){var t;return(t=e.nodeName.toUpperCase())==="INPUT"||t==="TEXTAREA"||t==="SELECT"},addEventListener:function(e,t,n){var r;return(r=Batman._data(e,"listeners"))||(r=Batman._data(e,"listeners",{})),r[t]||(r[t]=[]),r[t].push(n),Batman.DOM.hasAddEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},removeEventListener:function(e,t,n){var r,i,s;if(s=Batman._data(e,"listeners"))if(r=s[t])i=r.indexOf(n),i!==-1&&r.splice(i,1);return Batman.DOM.hasAddEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},hasAddEventListener:typeof window!="undefined"&&window!==null?!!window.addEventListener:!!void 0,preventDefault:function(e){return typeof e.preventDefault=="function"?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},willInsertNode:function(e){var t,n,r,i,s,o;n=Batman._data(e,"view"),n!=null&&n.fire("beforeAppear",e),(s=Batman.data(e,"show"))!=null&&s.call(e),o=e.childNodes;for(r=0,i=o.length;r<i;r++)t=o[r],Batman.DOM.willInsertNode(t);return!0},didInsertNode:function(e){var t,n,r,i,s;n=Batman._data(e,"view"),n&&(n.fire("appear",e),n.applyYields()),s=e.childNodes;for(r=0,i=s.length;r<i;r++)t=s[r],Batman.DOM.didInsertNode(t);return!0},willRemoveNode:function(e){var t,n,r,i,s,o;n=Batman._data(e,"view"),n&&n.fire("beforeDisappear",e),(s=Batman.data(e,"hide"))!=null&&s.call(e),o=e.childNodes;for(r=0,i=o.length;r<i;r++)t=o[r],Batman.DOM.willRemoveNode(t);return!0},didRemoveNode:function(e){var t,n,r,i,s;n=Batman._data(e,"view"),n&&(n.retractYields(),n.fire("disappear",e)),s=e.childNodes;for(r=0,i=s.length;r<i;r++)t=s[r],Batman.DOM.didRemoveNode(t);return!0},willDestroyNode:function(e){var t,n,r,i,s;n=Batman._data(e,"view"),n&&(n.fire("beforeDestroy",e),n.get("yields").forEach(function(t,n){var r,i,s;s=[];for(r=0,i=n.length;r<i;r++)e=n[r].node,s.push(Batman.DOM.willDestroyNode(e));return s})),s=e.childNodes;for(r=0,i=s.length;r<i;r++)t=s[r],Batman.DOM.willDestroyNode(t);return!0},didDestroyNode:function(e){var t,n,r,i,s,o,u,a,f;o=Batman._data(e,"view"),o&&(o.fire("destroy",e),o.get("yields").forEach(function(t,n){var r,i,s;s=[];for(r=0,i=n.length;r<i;r++)e=n[r].node,s.push(Batman.DOM.didDestroyNode(e));return s})),(t=Batman._data(e,"bindings"))&&t.forEach(function(e){return e.die()});if(s=Batman._data(e,"listeners"))for(i in s)r=s[i],r.forEach(function(t){return Batman.DOM.removeEventListener(e,i,t)});Batman.removeData(e),Batman.removeData(e,void 0,!0),f=e.childNodes;for(u=0,a=f.length;u<a;u++)n=f[u],Batman.DOM.didDestroyNode(n);return!0}},Batman.mixin(Batman.DOM,Batman.EventEmitter,Batman.Observable),Batman.DOM.event("bindingAdded")}.call(this),function(){var e=[].slice;Batman.DOM.readers={target:function(e,t,n,r){return Batman.DOM.readers.bind(e,t,n,r,"nodeChange"),!0},source:function(e,t,n,r){return Batman.DOM.readers.bind(e,t,n,r,"dataChange"),!0},bind:function(e,t,n,r,i){var s;s=!1;switch(e.nodeName.toLowerCase()){case"input":switch(e.getAttribute("type")){case"checkbox":return Batman.DOM.attrReaders.bind(e,"checked",t,n,r,i),!0;case"radio":s=Batman.DOM.RadioBinding;break;case"file":s=Batman.DOM.FileBinding}break;case"select":s=Batman.DOM.SelectBinding}return s||(s=Batman.DOM.Binding),function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(s,arguments,function(){}),!0},context:function(e,t,n,r){return n.descendWithKey(t)},mixin:function(e,t,n,r){return new Batman.DOM.MixinBinding(e,t,n.descend(Batman.mixins),r),!0},showif:function(e,t,n,r,i){return new Batman.DOM.ShowHideBinding(e,t,n,r,!1,i),!0},hideif:function(){var t;return(t=Batman.DOM.readers).showif.apply(t,e.call(arguments).concat([!0]))},insertif:function(e,t,n,r,i){return new Batman.DOM.InsertionBinding(e,t,n,r,!1,i),!0},removeif:function(){var t;return(t=Batman.DOM.readers).insertif.apply(t,e.call(arguments).concat([!0]))},route:function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.DOM.RouteBinding,arguments,function(){}),!0},view:function(){return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.DOM.ViewBinding,arguments,function(){}),!1},partial:function(e,t,n,r){return Batman.DOM.partial(e,t,n,r),!0},defineview:function(e,t,n,r){return Batman.DOM.onParseExit(e,function(){var t;return(t=e.parentNode)!=null?t.removeChild(e):void 0}),Batman.DOM.defineView(t,e),!1},renderif:function(e,t,n,r){return new Batman.DOM.DeferredRenderingBinding(e,t,n,r),!1},yield:function(e,t){return Batman.DOM.onParseExit(e,function(){return Batman.DOM.Yield.withName(t).set("containerNode",e)}),!0},contentfor:function(e,t,n,r,i){return i==null&&(i="append"),Batman.DOM.onParseExit(e,function(){var n;return(n=e.parentNode)!=null&&n.removeChild(e),r.view.pushYieldAction(t,i,e)}),!0},replace:function(e,t,n,r){return Batman.DOM.readers.contentfor(e,t,n,r,"replace"),!0}}}.call(this),function(){var e=[].slice,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Batman.DOM.events={click:function(t,n,r,i){return i==null&&(i="click"),Batman.DOM.addEventListener(t,i,function(){var i,s;s=arguments[0],i=2<=arguments.length?e.call(arguments,1):[];if(s.metaKey||s.ctrlKey)return;return n.apply(null,[t,s].concat(e.call(i),[r])),Batman.DOM.preventDefault(s)}),t.nodeName.toUpperCase()==="A"&&!t.href&&(t.href="#"),t},doubleclick:function(e,t,n){return Batman.DOM.events.click(e,t,n,"dblclick")},change:function(n,r,i){var s,o,u,a,f,l;o=function(){var e;switch(n.nodeName.toUpperCase()){case"TEXTAREA":return["input","keyup","change"];case"INPUT":return(e=n.type.toLowerCase(),t.call(Batman.DOM.textInputTypes,e)>=0)?(u=r,r=function(e,t){if(t.type==="keyup"&&Batman.DOM.events.isEnter(t))return;return u.apply(null,arguments)},["input","keyup","change"]):["input","change"];default:return["change"]}}(),l=[];for(a=0,f=o.length;a<f;a++)s=o[a],l.push(Batman.DOM.addEventListener(n,s,function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],r.apply(null,[n].concat(e.call(t),[i]))}));return l},isEnter:function(e){var t,n;return 13<=(t=e.keyCode)&&t<=14||13<=(n=e.which)&&n<=14||e.keyIdentifier==="Enter"||e.key==="Enter"},submit:function(t,n,r){return Batman.DOM.nodeIsEditable(t)?(Batman.DOM.addEventListener(t,"keydown",function(){var n;n=1<=arguments.length?e.call(arguments,0):[];if(Batman.DOM.events.isEnter(n[0]))return Batman.DOM._keyCapturingNode=t}),Batman.DOM.addEventListener(t,"keyup",function(){var i;i=1<=arguments.length?e.call(arguments,0):[];if(Batman.DOM.events.isEnter(i[0]))return Batman.DOM._keyCapturingNode===t&&(Batman.DOM.preventDefault(i[0]),n.apply(null,[t].concat(e.call(i),[r]))),Batman.DOM._keyCapturingNode=null})):Batman.DOM.addEventListener(t,"submit",function(){var i;return i=1<=arguments.length?e.call(arguments,0):[],Batman.DOM.preventDefault(i[0]),n.apply(null,[t].concat(e.call(i),[r]))}),t},other:function(t,n,r,i){return Batman.DOM.addEventListener(t,n,function(){var n;return n=1<=arguments.length?e.call(arguments,0):[],r.apply(null,[t].concat(e.call(n),[i]))})}}}.call(this),function(){Batman.DOM.attrReaders={_parseAttribute:function(e){return e==="false"&&(e=!1),e==="true"&&(e=!0),e},source:function(e,t,n,r,i){return Batman.DOM.attrReaders.bind(e,t,n,r,i,"dataChange")},bind:function(e,t,n,r,i,s){var o;return o=function(){switch(t){case"checked":case"disabled":case"selected":return Batman.DOM.CheckedBinding;case"value":case"href":case"src":case"size":return Batman.DOM.NodeAttributeBinding;case"class":return Batman.DOM.ClassBinding;case"style":return Batman.DOM.StyleBinding;default:return Batman.DOM.AttributeBinding}}(),function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(o,arguments,function(){}),!0},context:function(e,t,n,r){return r.descendWithKey(n,t)},event:function(e,t,n,r){return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.DOM.EventBinding,arguments,function(){}),!0},addclass:function(e,t,n,r,i,s){return new Batman.DOM.AddClassBinding(e,t,n,r,i,!1,s),!0},removeclass:function(e,t,n,r,i){return Batman.DOM.attrReaders.addclass(e,t,n,r,i,!0)},foreach:function(e,t,n,r,i){return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.DOM.IteratorBinding,arguments,function(){}),!1},formfor:function(e,t,n,r){return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.DOM.FormBinding,arguments,function(){}),r.descendWithKey(n,t)}}}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;e=function(e){function a(){var e;e=1<=arguments.length?r.call(arguments,0):[],this._batman=new Batman._Batman(this),this.mixin.apply(this,e)}var i,s,o,u;return n(a,e),Batman.initializeObject(a),Batman.initializeObject(a.prototype),a.classMixin=function(){return Batman.mixin.apply(Batman,[this].concat(r.call(arguments)))},a.mixin=function(){return this.classMixin.apply(this.prototype,arguments)},a.prototype.mixin=a.classMixin,i=0,a.prototype._batmanID=function(){var e;return this._batmanID=function(){return e},e=i++},a.prototype.hashKey=function(){var e;if(typeof this.isEqual=="function")return;return this.hashKey=function(){return e},e="<Batman.Object "+this._batmanID()+">"},a.prototype.toJSON=function(){var e,n,r;n={};for(e in this){if(!t.call(this,e))continue;r=this[e],e!=="_batman"&&e!=="hashKey"&&e!=="_batmanID"&&(n[e]=(r!=null?r.toJSON:void 0)?r.toJSON():r)}return n},s=function(e,t){var n,r,i,s;typeof t=="function"&&(t={get:t}),s=["cachable","cacheable"];for(r=0,i=s.length;r<i;r++)n=s[r],n in t&&(Batman.developer.warn('Property accessor option "'+n+'" is deprecated. Use "cache" instead.'),"cache"in t||(t.cache=t[n]));return t},o=function(e){return function(t){return{get:function(n){var r,i,s,o,u,a,f=this;return(i=t.get.apply(this,arguments))!=null?i:(r=!1,s=void 0,(a=(o=this._batman)[u="promise"+n+"Fetched"])==null&&(o[u]=function(){var t;return t=function(e,t){return r&&f.set(n,t),s=t},e.call(f,t,n),!0}()),r=!0,s)},cache:!0}}},u=function(e,t){var n,r;t=(typeof t=="function"?t(e):void 0)||t;for(n in e)r=e[n],n in t||(t[n]=r);return t},a._defineAccessor=function(){var e,t,n,i,u,a,f,l,c;n=2<=arguments.length?r.call(arguments,0,u=arguments.length-1):(u=0,[]),e=arguments[u++];if(e==null)return Batman.Property.defaultAccessorForBase(this);if(n.length===0&&(l=Batman.typeOf(e))!=="Object"&&l!=="Function")return Batman.Property.accessorForBaseAndKey(this,e);if(typeof e.promise=="function")return this._defineWrapAccessor.apply(this,r.call(n).concat([o(e.promise)]));Batman.initializeObject(this);if(n.length===0)return this._batman.defaultAccessor=s(this,e);(i=this._batman).keyAccessors||(i.keyAccessors=new Batman.SimpleHash),c=[];for(a=0,f=n.length;a<f;a++)t=n[a],c.push(this._batman.keyAccessors.set(t,s(this,e)));return c},a.prototype._defineAccessor=a._defineAccessor,a._defineWrapAccessor=function(){var e,t,n,i,s,o,a;t=2<=arguments.length?r.call(arguments,0,i=arguments.length-1):(i=0,[]),n=arguments[i++],Batman.initializeObject(this);if(t.length===0)return this._defineAccessor(u(this._defineAccessor(),n));a=[];for(s=0,o=t.length;s<o;s++)e=t[s],a.push(this._defineAccessor(e,u(this._defineAccessor(e),n)));return a},a.prototype._defineWrapAccessor=a._defineWrapAccessor,a.classAccessor=a._defineAccessor,a.accessor=function(){var e;return(e=this.prototype)._defineAccessor.apply(e,arguments)},a.prototype.accessor=a._defineAccessor,a.wrapClassAccessor=a._defineWrapAccessor,a.wrapAccessor=function(){var e;return(e=this.prototype)._defineWrapAccessor.apply(e,arguments)},a.prototype.wrapAccessor=a._defineWrapAccessor,a.classMixin(Batman.EventEmitter,Batman.Observable),a.mixin(Batman.EventEmitter,Batman.Observable),a.observeAll=function(){return this.prototype.observe.apply(this.prototype,arguments)},a.singleton=function(e){return e==null&&(e="sharedInstance"),this.classAccessor(e,{get:function(){var t;return this[t="_"+e]||(this[t]=new this)}})},a.accessor("_batmanID",function(){return this._batmanID()}),a}(Object),Batman.Object=e}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.Renderer=function(t){function d(t,n,r){this.node=t,this.context=n,this.view=r,this.resume=e(this.resume,this),this.start=e(this.start,this),d.__super__.constructor.call(this),this.context instanceof Batman.RenderContext||Batman.developer.error("Must pass a RenderContext to a renderer for rendering"),this.immediate=Batman.setImmediate(this.start)}var r,i,s,o,u,a,f,l,c,h,p;n(d,t),d.prototype.deferEvery=50,d.prototype.start=function(
){return this.startTime=new Date,this.parseNode(this.node)},d.prototype.resume=function(){return this.startTime=new Date,this.parseNode(this.resumeNode)},d.prototype.finish=function(){return this.startTime=null,this.prevent("stopped"),this.fire("parsed"),this.fire("rendered")},d.prototype.stop=function(){return Batman.clearImmediate(this.immediate),this.fire("stopped")},p=["parsed","rendered","stopped"];for(f=0,c=p.length;f<c;f++)o=p[f],d.prototype.event(o).oneShot=!0;r=/^data\-(.*)/,i=["view","renderif","foreach","formfor","context","bind","source","target"],s={};for(a=l=0,h=i.length;l<h;a=++l)u=i[a],s[u]=a;return d.prototype._sortBindings=function(e,t){var n,r;return n=s[e[0]],r=s[t[0]],n==null&&(n=i.length),r==null&&(r=i.length),n>r?1:r>n?-1:e[0]>t[0]?1:t[0]>e[0]?-1:0},d.prototype.parseNode=function(e){var t,n,i,s,o,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S=this;if(this.deferEvery&&new Date-this.startTime>this.deferEvery){this.resumeNode=e,this.timeout=Batman.setImmediate(this.resume);return}if(e.getAttribute&&e.attributes){i=[],y=e.attributes;for(d=0,m=y.length;d<m;d++){n=y[d],u=(b=n.nodeName.match(r))!=null?b[1]:void 0;if(!u)continue;i.push((o=u.split("-")).length>1?[o[0],o.slice(1,o.length+1||9e9).join("-"),n.value]:[u,void 0,n.value])}w=i.sort(this._sortBindings);for(v=0,g=w.length;v<g;v++){E=w[v],u=E[0],t=E[1],s=E[2],l=t?typeof (h=Batman.DOM.attrReaders)[u]=="function"?h[u](e,t,s,this.context,this):void 0:typeof (p=Batman.DOM.readers)[u]=="function"?p[u](e,s,this.context,this):void 0;if(l===!1){c=!0;break}l instanceof Batman.RenderContext&&(f=this.context,this.context=l,Batman.DOM.onParseExit(e,function(){return S.context=f}))}}return(a=this.nextNode(e,c))?this.parseNode(a):this.finish()},d.prototype.nextNode=function(e,t){var n,r,i,s,o,u;if(!t){n=e.childNodes;if(n!=null?n.length:void 0)return n[0]}s=e.nextSibling,(o=Batman.DOM.onParseExit(e))!=null&&o.forEach(function(e){return e()}),Batman.DOM.forgetParseExit(e);if(this.node===e)return;if(s)return s;r=e;while(r=r.parentNode){i=r.nextSibling,(u=Batman.DOM.onParseExit(r))!=null&&u.forEach(function(e){return e()}),Batman.DOM.forgetParseExit(r);if(this.node===r)return;if(i)return i}},d}(Batman.Object)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.DOM.AbstractBinding=function(t){function o(t,n,r,i,s){this.node=t,this.keyPath=n,this.renderContext=r,this.renderer=i,this.only=s!=null?s:!1,this._fireDataChange=e(this._fireDataChange,this),this._fireNodeChange=e(this._fireNodeChange,this),this.parseFilter(),this.bindImmediately&&this.bind()}var r,i,s;return n(o,t),s=/(^|,)\s*(?:(true|false)|("[^"]*")|(\{[^\}]*\})|([a-zA-Z][\w\-\.]*[\?\!]?))\s*(?=$|,)/g,r=/(?:\]\.)(.+?)(?=[\[\.]|\s*\||$)/,i=/(?!^\s*)\[(.*?)\]/g,o.accessor("filteredValue",{get:function(){var e,t,n,r;return r=this.get("unfilteredValue"),n=this,e=this.get("renderContext"),this.filterFunctions.length>0?(Batman.developer.currentFilterStack=e,t=this.filterFunctions.reduce(function(t,r,i){var s;s=n.filterArguments[i].map(function(e){return e._keypath?n.renderContext.get(e._keypath):e}),s.unshift(t);while(s.length<r.length-1)s.push(void 0);return s.push(n),r.apply(e,s)},r),Batman.developer.currentFilterStack=null,t):r},set:function(e,t){return this.set("unfilteredValue",t)}}),o.accessor("unfilteredValue",{get:function(){var e;return(e=this.get("key"))?Batman.RenderContext.deProxy(Batman.getPath(this,["keyContext",e])):this.get("value")},set:function(e,t){var n,r,i;if(!(n=this.get("key")))return this.set("value",t);r=this.get("keyContext");if(r&&r!==Batman.container)return i=Batman.Property.forBaseAndKey(r,n),i.setValue(t)}}),o.accessor("keyContext",function(){return this.renderContext.contextForKey(this.key)}),o.prototype.bindImmediately=!0,o.prototype.shouldSet=!0,o.prototype.isInputBinding=!1,o.prototype.escapeValue=!0,o.prototype.isTwoWay=function(){return this.key!=null&&this.filterFunctions.length===0},o.prototype.bind=function(){var e,t;this.node!=null&&((e=this.only)===!1||e==="nodeChange")&&Batman.DOM.nodeIsEditable(this.node)&&(Batman.DOM.events.change(this.node,this._fireNodeChange),this.only==="nodeChange"&&this._fireNodeChange()),((t=this.only)===!1||t==="dataChange")&&this.observeAndFire("filteredValue",this._fireDataChange);if(this.node!=null)return Batman.DOM.trackBinding(this,this.node)},o.prototype._fireNodeChange=function(e){var t;return this.shouldSet=!1,t=this.value||this.get("keyContext"),typeof this.nodeChange=="function"&&this.nodeChange(this.node,t,e),this.fire("nodeChange",this.node,t),this.shouldSet=!0},o.prototype._fireDataChange=function(e){if(this.shouldSet)return typeof this.dataChange=="function"&&this.dataChange(e,this.node),this.fire("dataChange",e,this.node)},o.prototype.die=function(){var e;return this.forget(),(e=this._batman.properties)!=null&&e.forEach(function(e,t){return t.die()}),this.fire("die"),this.dead=!0,!0},o.prototype.parseFilter=function(){var e,t,n,s,o,u,a,f,l;this.filterFunctions=[],this.filterArguments=[],a=this.keyPath;while(r.test(a))a=a.replace(r,"]['$1']");o=a.replace(i," | get $1 ").replace(/'/g,'"').split(/(?!")\s+\|\s+(?!")/);try{u=this.parseSegment(f=o.shift())[0]}catch(c){Batman.developer.warn(c),Batman.developer.error("Error! Couldn't parse keypath in \""+f+'". Parsing error above.')}u&&u._keypath?this.key=u._keypath:this.value=u;if(o.length){while(s=o.shift()){l=s.indexOf(" "),l===-1&&(l=s.length),n=s.substr(0,l),e=s.substr(l);if(!(t=Batman.Filters[n]))return Batman.developer.error("Unrecognized filter '"+n+"' in key \""+this.keyPath+'"!');this.filterFunctions.push(t);try{this.filterArguments.push(this.parseSegment(e))}catch(c){Batman.developer.error('Bad filter arguments "'+e+'"!')}}return!0}},o.prototype.parseSegment=function(e){return e=e.replace(s,function(e,t,n,r,i,s,o){var u;return t==null&&(t=""),u=s?'{"_keypath": "'+s+'"}':n||r||i,t+u}),JSON.parse("["+e+"]")},o}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.ViewBinding=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.renderer.prevent("rendered"),this.node.removeAttribute("data-view")}return t(n,e),n.prototype.dataChange=function(e){var t=this;if(e==null)return;return e.isView?(this.view=e,this.view.set("context",this.renderContext),this.view.set("node",this.node)):this.view=new e({node:this.node,context:this.renderContext,parentView:this.renderer.view}),this.view.on("ready",function(){return t.renderer.allowAndFire("rendered")}),this.die()},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.ViewArgumentBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.ShowHideBinding=function(e){function n(e,t,r,i,s,o){var u;this.invert=o!=null?o:!1,u=e.style.display;if(!u||u==="none")u="";this.originalDisplay=u,n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.dataChange=function(e){var t,n,r;return n=Batman._data(this.node,"view"),!!e==!this.invert?(n!=null&&n.fire("beforeAppear",this.node),(r=Batman.data(this.node,"show"))!=null&&r.call(this.node),this.node.style.display=this.originalDisplay,n!=null?n.fire("appear",this.node):void 0):(n!=null&&n.fire("beforeDisappear",this.node),typeof (t=Batman.data(this.node,"hide"))=="function"?t.call(this.node):Batman.DOM.setStyleProperty(this.node,"display","none","important"),n!=null?n.fire("disappear",this.node):void 0)},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.DOM.SelectBinding=function(t){function r(){this.updateOptionBindings=e(this.updateOptionBindings,this),this.nodeChange=e(this.nodeChange,this),this.dataChange=e(this.dataChange,this),this.childBindingAdded=e(this.childBindingAdded,this),this.selectedBindings=new Batman.SimpleSet,r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.isInputBinding=!0,r.prototype.firstBind=!0,r.prototype.childBindingAdded=function(e){var t,n=this;if(e instanceof Batman.DOM.CheckedBinding)e.on("dataChange",t=function(){return n.nodeChange()}),e.on("die",function(){return e.forget("dataChange",t),n.selectedBindings.remove(e)}),this.selectedBindings.add(e);else{if(!(e instanceof Batman.DOM.IteratorBinding))return;e.on("nodeAdded",t=function(){return n._fireDataChange(n.get("filteredValue"))}),e.on("nodeRemoved",t),e.on("die",function(){return e.forget("nodeAdded",t),e.forget("nodeRemoved",t)})}return this._fireDataChange(this.get("filteredValue"))},r.prototype.dataChange=function(e){var t,n,r,i,s,o,u,a=this;if(e!=null?e.forEach:void 0){r={},u=this.node.children;for(i=0,s=u.length;i<s;i++)t=u[i],t.selected=!1,n=r[o=t.value]||(r[o]=[]),n.push(t);e.forEach(function(e){var t,n,i,s,o;if(t=r[e]){o=[];for(i=0,s=t.length;i<s;i++)n=t[i],o.push(n.selected=!0);return o}})}else typeof e=="undefined"&&this.firstBind?this.set("unfilteredValue",this.node.value):Batman.DOM.valueForNode(this.node,e,this.escapeValue),this.firstBind=!1;this.updateOptionBindings()},r.prototype.nodeChange=function(){var e,t;this.isTwoWay()&&(t=this.node.multiple?function(){var t,n,r,i;r=this.node.children,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],e.selected&&i.push(e.value);return i}.call(this):this.node.value,typeof t===Array&&t.length===1&&(t=t[0]),this.set("unfilteredValue",t),this.updateOptionBindings())},r.prototype.updateOptionBindings=function(){return this.selectedBindings.forEach(function(e){return e._fireNodeChange()})},r}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.RouteBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.onATag=!1,n.accessor("dispatcher",function(){return this.renderContext.get("dispatcher")||Batman.App.get("current.dispatcher")}),n.prototype.bind=function(){var e=this;return this.node.nodeName.toUpperCase()==="A"&&(this.onATag=!0),n.__super__.bind.apply(this,arguments),Batman.DOM.events.click(this.node,function(t,n){var r;if(n.__batmanActionTaken)return;n.__batmanActionTaken=!0,r=e.pathFromValue(e.get("filteredValue"));if(r!=null)return Batman.redirect(r)})},n.prototype.dataChange=function(e){var t;e!=null&&(t=this.pathFromValue(e));if(this.onATag)return t!=null&&Batman.navigator!=null?t=Batman.navigator.linkTo(t):t="#",this.node.href=t},n.prototype.pathFromValue=function(e){var t;if(e!=null)return e.isNamedRouteQuery?e.get("path"):(t=this.get("dispatcher"))!=null?t.pathFromParams(e):void 0},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.RadioBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor("parsedNodeValue",function(){return Batman.DOM.attrReaders._parseAttribute(this.node.value)}),n.prototype.firstBind=!0,n.prototype.dataChange=function(e){var t;return t=this.get("filteredValue"),t!=null?this.node.checked=t===Batman.DOM.attrReaders._parseAttribute(this.node.value):this.firstBind&&this.node.checked&&this.set("filteredValue",this.get("parsedNodeValue")),this.firstBind=!1},n.prototype.nodeChange=function(e){if(this.isTwoWay())return this.set("filteredValue",this.get("parsedNodeValue"))},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.MixinBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.dataChange=function(e){if(e!=null)return Batman.mixin(this.node,e)},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.FileBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.isInputBinding=!0,n.prototype.nodeChange=function(e,t){if(!this.isTwoWay())return;return e.hasAttribute("multiple")?this.set("filteredValue",Array.prototype.slice.call(e.files)):this.set("filteredValue",e.files[0])},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.DeferredRenderingBinding=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.node.removeAttribute("data-renderif")}return t(n,e),n.prototype.rendered=!1,n.prototype.nodeChange=function(){},n.prototype.dataChange=function(e){if(e&&!this.rendered)return this.render()},n.prototype.render=function(){return new Batman.Renderer(this.node,this.renderContext,this.renderer.view),this.rendered=!0},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.Binding=function(e){function n(e){var t;this.isInputBinding=(t=e.nodeName.toLowerCase())==="input"||t==="textarea",n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.nodeChange=function(e,t){if(this.isTwoWay())return this.set("filteredValue",this.node.value)},n.prototype.dataChange=function(e,t){return Batman.DOM.valueForNode(this.node,e,this.escapeValue)},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.DOM.AbstractAttributeBinding=function(e){function r(){var e,t,i;i=arguments[0],t=arguments[1],e=3<=arguments.length?n.call(arguments,2):[],this.attributeName=t,r.__super__.constructor.apply(this,[i].concat(n.call(e)))}return t(r,e),r}(Batman.DOM.AbstractBinding)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.DOM.FormBinding=function(t){function r(t,n,i,s,o,u){this.childBindingAdded=e(this.childBindingAdded,this),r.__super__.constructor.apply(this,arguments),this.contextName=n,delete this.attributeName,Batman.DOM.events.submit(this.get("node"),function(e,t){return Batman.DOM.preventDefault(t)}),this.setupErrorsList()}return n(r,t),r.current=null,r.prototype.errorClass="error",r.prototype.defaultErrorsListSelector="div.errors",r.accessor("errorsListSelector",function(){return this.get("node").getAttribute("data-errors-list")||this.defaultErrorsListSelector}),r.prototype.childBindingAdded=function(e){var t,n,r;if(e.isInputBinding&&Batman.isChildOf(this.get("node"),e.get("node"))&&~(n=e.get("key").indexOf(this.contextName)))return r=e.get("node"),t=e.get("key").slice(n+this.contextName.length+1),new Batman.DOM.AddClassBinding(r,this.errorClass,this.get("keyPath")+(" | get 'errors."+t+".length'"),this.renderContext,this.renderer)},r.prototype.setupErrorsList=function(){if(this.errorsListNode=Batman.DOM.querySelector(this.get("node"),this.get("errorsListSelector"))){Batman.DOM.setInnerHTML(this.errorsListNode,this.errorsListHTML());if(!this.errorsListNode.getAttribute("data-showif"))return this.errorsListNode.setAttribute("data-showif",""+this.contextName+".errors.length")}},r.prototype.errorsListHTML=function(){return'<ul>\n  <li data-foreach-error="'+this.contextName+'.errors" data-bind="error.fullMessage"></li>\n</ul>'},r}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.EventBinding=function(e){function n(e,t,r,i){var s,o,u,a=this;n.__super__.constructor.apply(this,arguments),u=this.node.getAttribute("data-confirm"),o=function(){var e;if(u&&!confirm(u))return;return(e=a.get("filteredValue"))!=null?e.apply(a.get("callbackContext"),arguments):void 0},(s=Batman.DOM.events[this.attributeName])?s(this.node,o,i):Batman.DOM.events.other(this.node,this.attributeName,o,i),this.bind()}return t(n,e),n.prototype.bindImmediately=!1,n.accessor("callbackContext",function(){var e;return e=this.key.split("."),e.pop(),e.length>0?this.get("keyContext").get(e.join(".")):this.get("keyContext")}),n.wrapAccessor("unfilteredValue",function(e){return{get:function(){var t,n,r,i;if(n=this.get("key")){i=n.split(".");if(i.length>1){t=i.pop(),r=Batman.getPath(this,["keyContext"].concat(i)),r=Batman.RenderContext.deProxy(r);if(r!=null)return r[t]}}return e.get.apply(this,arguments)}}}),n}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.NodeAttributeBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.dataChange=function(e){return e==null&&(e=""),this.node[this.attributeName]=e},n.prototype.nodeChange=function(e){if(this.isTwoWay())return this.set("filteredValue",Batman.DOM.attrReaders._parseAttribute(e[this.attributeName]))},n}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.CheckedBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.isInputBinding=!0,n.prototype.dataChange=function(e){return this.node[this.attributeName]=!!e},n}(Batman.DOM.NodeAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.AttributeBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.dataChange=function(e){return this.node.setAttribute(this.attributeName,e)},n.prototype.nodeChange=function(e){if(this.isTwoWay())return this.set("filteredValue",Batman.DOM.attrReaders._parseAttribute(e.getAttribute(this.attributeName)))},n}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.AddClassBinding=function(e){function n(e,t,r,i,s,o,u){var a,f;this.invert=u!=null?u:!1,f=t.split("|"),this.classes=function(){var e,t,n;n=[];for(e=0,t=f.length;e<t;e++)a=f[e],n.push({name:a,pattern:new RegExp("(?:^|\\s)"+a+"(?:$|\\s)","i")});return n}(),n.__super__.constructor.apply(this,arguments),delete this.attributeName}return t(n,e),n.prototype.dataChange=function(e){var t,n,r,i,s,o,u,a;t=this.node.className,u=this.classes;for(s=0,o=u.length;s<o;s++)a=u[s],r=a.name,i=a.pattern,n=i.test(t),!!e==!this.invert?n||(this.node.className=""+t+" "+r):n&&(this.node.className=t.replace(i," "));return!0},n}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.AbstractCollectionBinding=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.bindCollection=function(e){var t;return e instanceof Batman.Hash&&(e=e.meta),e===this.collection?!0:(this.unbindCollection(),this.collection=e,((t=this.collection)!=null?t.isObservable:void 0)?(this.collection.observeAndFire("toArray",this.handleArrayChanged),!0):!1)},n.prototype.unbindCollection=function(){var e;if((e=this.collection)!=null?e.isObservable:void 0)return this.collection.forget("toArray",this.handleArrayChanged)},n.prototype.handleArrayChanged=function(){},n.prototype.die=function(){return this.unbindCollection(),n.__super__.die.apply(this,arguments)},n}(Batman.DOM.AbstractAttributeBinding)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;Batman.DOM.StyleBinding=function(i){function s(){this.setStyle=e(this.setStyle,this),this.handleArrayChanged=e(this.handleArrayChanged,this),this.oldStyles={},this.styleBindings={},s.__super__.constructor.apply(this,arguments)}return n(s,i),s.SingleStyleBinding=function(e){function t(){var e,n,i;e=2<=arguments.length?r.call(arguments,0,i=arguments.length-1):(i=0,[]),n=arguments[i++],this.parent=n,t.__super__.constructor.apply(this,e)}return n(t,e),t.prototype.isTwoWay=function(){return!1},t.prototype.dataChange=function(e){return this.parent.setStyle(this.attributeName,e)},t}(Batman.DOM.AbstractAttributeBinding),s.prototype.dataChange=function(e){var n,i,s,o,u,a,f,l,c;if(!e){this.resetStyles();return}this.unbindCollection();if(typeof e=="string"){this.resetStyles(),f=e.split(";");for(u=0,a=f.length;u<a;u++)o=f[u],l=o.split(":"),i=l[0],n=2<=l.length?r.call(l,1):[],this.setStyle(i,n.join(":"));return}if(e instanceof Batman.Hash)return this.bindCollection(e);e instanceof Batman.Object&&(e=e.toJSON()),this.resetStyles(),c=[];for(s in e){if(!t.call(e,s))continue;c.push(this.bindSingleAttribute(s,""+this.keyPath+"."+s))}return c},s.prototype.handleArrayChanged=function(e){var t=this;return this.collection.forEach(function(e,n){return t.bindSingleAttribute(e,""+t.keyPath+"."+e)})},s.prototype.bindSingleAttribute=function(e,t){return this.styleBindings[e]=new this.constructor.SingleStyleBinding(this.node,e,t,this.renderContext,this.renderer,this.only,this)},s.prototype.setStyle=function(e,t){e=Batman.helpers.camelize(e.trim(),!0),this.oldStyles[e]==null&&(this.oldStyles[e]=this.node.style[e]||"");if(t!=null?t.trim:void 0)t=t.trim();return t==null&&(t=""),this.node.style[e]=t},s.prototype.resetStyles=function(){var e,n,r,i;r=this.oldStyles,i=[];for(e in r){if(!t.call(r,e))continue;n=r[e],i.push(this.setStyle(e,n))}return i},s.prototype.resetBindings=function(){var e,t,n;n=this.styleBindings;for(e in n)t=n[e],t._fireDataChange(""),t.die();return this.styleBindings={}},s.prototype.unbindCollection=function(){return this.resetBindings(),s.__super__.unbindCollection.apply(this,arguments)},s}(Batman.DOM.AbstractCollectionBinding)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.DOM.IteratorBinding=function(t){function r(t,n,i,s,o){var u,a=this;this.iteratorName=n,this.key=i,this.context=s,this.parentRenderer=o,this.handleArrayChanged=e(this.handleArrayChanged,this),this.nodeMap=new Batman.SimpleHash,this.rendererMap=new Batman.SimpleHash,this.fragment=document.createDocumentFragment(),this.prototypeNode=t.cloneNode(!0),this.prototypeNode.removeAttribute("data-foreach-"+this.iteratorName),u=t.nextSibling,this.startNode=document.createComment("start "+this.iteratorName+"-"+this.get("_batmanID")),this.endNode=document.createComment("end "+this.iteratorName+"-"+this.get("_batmanID")),this.endNode[Batman.expando]=t[Batman.expando],Batman.canDeleteExpando&&delete t[Batman.expando],Batman.DOM.insertBefore(t.parentNode,this.startNode,u),Batman.DOM.insertBefore(t.parentNode,this.endNode,u),this.parentRenderer.prevent("rendered"),Batman.DOM.onParseExit(t.parentNode,function(){return Batman.DOM.destroyNode(t),a.bind(),a.parentRenderer.allowAndFire("rendered")}),r.__super__.constructor.call(this,this.endNode,this.iteratorName,this.key,this.context,this.parentRenderer)}return n(r,t),r.prototype.currentActionNumber=0,r.prototype.queuedActionNumber=0,r.prototype.bindImmediately=!1,r.prototype.parentNode=function(){return this.endNode.parentNode},r.prototype.die=function(){return this.dead=!0,r.__super__.die.apply(this,arguments)},r.prototype.dataChange=function(e){var t,n;if(e==null)return this.handleArrayChanged([]);if(!this.bindCollection(e))return t=(e!=null?e.forEach:void 0)?(n=[],e.forEach(function(e){return n.push(e)}),n):Object.keys(e),this.handleArrayChanged(t)},r.prototype.handleArrayChanged=function(e){var t,n,r,i,s,o,u,a,f,l,c=this;o=this.parentNode(),u=this._getStartNodeIndex()+1,a=this.nodeMap.merge();if(e!=null)for(n=f=0,l=e.length;f<l;n=++f){r=e[n],s=o.childNodes[u+n];if(s!=null&&this._itemForNode(s)===r){a.unset(r);continue}i=(t=this.nodeMap.get(r))?(a.unset(r),t):this._newNodeForItem(r),Batman.DOM.insertBefore(this.parentNode(),i,s)}a.forEach(function(e,t){return c._removeItem(e)})},r.prototype._itemForNode=function(e){return Batman._data(e,""+this.iteratorName+"Item")},r.prototype._newNodeForItem=function(e){var t,n,r=this;return t=this.prototypeNode.cloneNode(!0),Batman._data(t,""+this.iteratorName+"Item",e),this.nodeMap.set(e,t),this.parentRenderer.prevent("rendered"),n=new Batman.Renderer(t,this.renderContext.descend(e,this.iteratorName),this.parentRenderer.view),n.on("rendered",function(){return Batman.DOM.propagateBindingEvents(t),r.fire("nodeAdded",t,e),r.parentRenderer.allowAndFire("rendered")}),t},r.prototype._getStartNodeIndex=function(){var e,t,n,r,i;i=this.parentNode().childNodes;for(e=n=0,r=i.length;n<r;e=++n){t=i[e];if(t===this.startNode)return e}return 0},r.prototype._removeItem=function(e){var t;return t=this.nodeMap.unset(e),Batman.DOM.destroyNode(t),this.fire("nodeRemoved",t,e)},r}(Batman.DOM.AbstractCollectionBinding)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.DOM.ClassBinding=function(r){function i(){return this.handleArrayChanged=e(this.handleArrayChanged,this),i.__super__.constructor.apply(this,arguments)}return n(i,r),i.prototype.dataChange=function(e){if(e!=null)return this.unbindCollection(),typeof e=="string"?this.node.className=e:(this.bindCollection(e),this.updateFromCollection())},i.prototype.updateFromCollection=function(){var e,n,r;if(this.collection)return e=this.collection.map?this.collection.map(function(e){return e}):function(){var e,i;e=this.collection,i=[];for(n in e){if(!t.call(e,n))continue;r=e[n],i.push(n)}return i}.call(this),e.toArray!=null&&(e=e.toArray()),this.node.className=e.join(" ")},i.prototype.handleArrayChanged=function(){return this.updateFromCollection()},i}(Batman.DOM.AbstractCollectionBinding)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ValidationError=function(e){function n(e,t){n.__super__.constructor.call(this,{attribute:e,message:t})}return t(n,e),n.accessor("fullMessage",function(){return Batman.t("errors.format",{attribute:Batman.helpers.humanize(this.attribute),message:this.message})}),n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.StorageAdapter=function(e){function r(e){var t;r.__super__.constructor.call(this,{model:e}),t=this.constructor,t.ModelMixin&&Batman.extend(e,t.ModelMixin),t.RecordMixin&&Batman.extend(e.prototype,t.RecordMixin)}return t(r,e),r.StorageError=function(e){function n(e){n.__super__.constructor.apply(this,arguments),this.message=e}return t(n,e),n.prototype.name="StorageError",n}(Error),r.RecordExistsError=function(e){function n(e){n.__super__.constructor.call(this,e||"Can't create this record because it already exists in the store!")}return t(n,e),n.prototype.name="RecordExistsError",n}(r.StorageError),r.NotFoundError=function(e){function n(e){n.__super__.constructor.call(this,e||"Record couldn't be found in storage!")}return t(n,e),n.prototype.name="NotFoundError",n}(r.StorageError),r.NotAllowedError=function(e){function n(e){n.__super__.constructor.call(this,e||"Storage operation denied access to the operation!")}return t(n,e),n.prototype.name="NotAllowedError",n}(r.StorageError),r.NotAcceptableError=function(e){function n(e){n.__super__.constructor.call(this,e||"Storage operation permitted but the request was malformed!")}return t(n,e),n.prototype.name="NotAcceptableError",n}(r.StorageError),r.UnprocessableRecordError=function(e){function n(e){n.__super__.constructor.call(this,e||"Storage adapter could not process the record!")}return t(n,e),n.prototype.name="UnprocessableRecordError",n}(r.StorageError),r.InternalStorageError=function(e){function n(e){n.__super__.constructor.call(this,e||"An error occured during the storage operation!")}return t(n,e),n.prototype.name="InternalStorageError",n}(r.StorageError),r.NotImplementedError=function(e){function n(e){n.__super__.constructor.call(this,e||"This operation is not implemented by the storage adpater!")}return t(n,e),n.prototype.name="NotImplementedError",n}(r.StorageError),r.prototype.isStorageAdapter=!0,r.prototype.storageKey=function(e){var t;return t=(e!=null?e.constructor:void 0)||this.model,t.get("storageKey")||Batman.helpers.pluralize(Batman.helpers.underscore(t.get("resourceName")))},r.prototype.getRecordFromData=function(e,t){var n;return t==null&&(t=this.model),n=new t,n._withoutDirtyTracking(function(){return this.fromJSON(e)}),n},r.skipIfError=function(e){return function(t,n){return t.error!=null?n():e.call(this,t,n)}},r.prototype.before=function(){return this._addFilter.apply(this,["before"].concat(n.call(arguments)))},r.prototype.after=function(){return this._addFilter.apply(this,["after"].concat(n.call(arguments)))},r.prototype._inheritFilters=function(){var e,t,n,r,i,s;if(!this._batman.check(this)||!this._batman.filters){r=this._batman.getFirst("filters"),this._batman.filters={before:{},after:{}};if(r!=null){s=[];for(i in r)e=r[i],s.push(function(){var r;r=[];for(n in e)t=e[n],r.push(this._batman.filters[i][n]=t.slice(0));return r}.call(this));return s}}},r.prototype._addFilter=function(){var e,t,r,i,s,o,u,a;i=arguments[0],r=3<=arguments.length?n.call(arguments,1,o=arguments.length-1):(o=1,[]),e=arguments[o++],this._inheritFilters();for(u=0,a=r.length;u<a;u++)t=r[u],(s=this._batman.filters[i])[t]||(s[t]=[]),this._batman.filters[i][t].push(e);return!0},r.prototype.runFilter=function(e,t,n,r){var i,s,o,u,a=this;return this._inheritFilters(),s=this._batman.filters[e].all||[],i=this._batman.filters[e][t]||[],n.action=t,o=e==="before"?i.concat(s):s.concat(i),u=function(e){var t;return e!=null&&(n=e),(t=o.shift())!=null?t.call(a,n,u):r.call(a,n)},u()},r.prototype.runBeforeFilter=function(){return this.runFilter.apply(this,["before"].concat(n.call
(arguments)))},r.prototype.runAfterFilter=function(e,t,n){return this.runFilter("after",e,t,this.exportResult(n))},r.prototype.exportResult=function(e){return function(t){return e(t.error,t.result,t)}},r.prototype._jsonToAttributes=function(e){return JSON.parse(e)},r.prototype.perform=function(e,t,n,r){var i,s,o=this;return n||(n={}),i={options:n,subject:t},s=function(t){return t!=null&&(i=t),o.runAfterFilter(e,i,r)},this.runBeforeFilter(e,i,function(t){return this[e](t,s)})},r}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice,r=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Batman.RestStorage=function(e){function l(){l.__super__.constructor.apply(this,arguments),this.defaultRequestOptions=Batman.extend({},this.defaultRequestOptions)}var i,s,o,u,a,f=this;t(l,e),l.CommunicationError=function(e){function n(e){n.__super__.constructor.call(this,e||"A communication error has occurred!")}return t(n,e),n.prototype.name="CommunicationError",n}(l.StorageError),l.JSONContentType="application/json",l.PostBodyContentType="application/x-www-form-urlencoded",l.BaseMixin={request:function(e,t,n){return n||(n=t,t={}),t.method||(t.method="GET"),t.action=e,this._doStorageOperation(t.method.toLowerCase(),t,n)}},l.ModelMixin=Batman.extend({},l.BaseMixin,{urlNestsUnder:function(){var e,t,r,i,s;t=1<=arguments.length?n.call(arguments,0):[],r={};for(i=0,s=t.length;i<s;i++)e=t[i],r[e+"_id"]=Batman.helpers.pluralize(e);return this.url=function(t){var n,i,s;n=Batman.helpers.pluralize(this.get("resourceName").toLowerCase());for(e in r){s=r[e],i=t.data[e];if(i)return delete t.data[e],""+s+"/"+i+"/"+n}return n},this.prototype.url=function(){var t,n,i,s,o;t=Batman.helpers.pluralize(this.constructor.get("resourceName").toLowerCase());for(e in r){s=r[e],i=this.get("dirtyKeys").get(e),i===void 0&&(i=this.get(e));if(i){o=""+s+"/"+i+"/"+t;break}}o||(o=t);if(n=this.get("id"))o+="/"+n;return o}}}),l.RecordMixin=Batman.extend({},l.BaseMixin),l.prototype.defaultRequestOptions={type:"json"},l.prototype._implicitActionNames=["create","read","update","destroy","readAll"],l.prototype.serializeAsForm=!0,l.prototype.recordJsonNamespace=function(e){return Batman.helpers.singularize(this.storageKey(e))},l.prototype.collectionJsonNamespace=function(e){return Batman.helpers.pluralize(this.storageKey(e.prototype))},l.prototype._execWithOptions=function(e,t,n){return typeof e[t]=="function"?e[t](n):e[t]},l.prototype._defaultCollectionUrl=function(e){return""+this.storageKey(e.prototype)},l.prototype._addParams=function(e,t){var n;return t&&t.action&&!(n=t.action,r.call(this._implicitActionNames,n)>=0)&&(e+="/"+t.action.toLowerCase()),e},l.prototype._addUrlAffixes=function(e,t,n){var r,i;return i=[e,this.urlSuffix(t,n)],e.charAt(0)!=="/"&&(r=this.urlPrefix(t,n),r.charAt(r.length-1)!=="/"&&i.unshift("/"),i.unshift(r)),i.join("")},l.prototype.urlPrefix=function(e,t){return this._execWithOptions(e,"urlPrefix",t.options)||""},l.prototype.urlSuffix=function(e,t){return this._execWithOptions(e,"urlSuffix",t.options)||""},l.prototype.urlForRecord=function(e,t){var n,r;if(e.url)r=this._execWithOptions(e,"url",t.options);else{r=e.constructor.url?this._execWithOptions(e.constructor,"url",t.options):this._defaultCollectionUrl(e.constructor);if(t.action!=="create"){if((n=e.get("id"))==null)throw new this.constructor.StorageError("Couldn't get/set record primary key on "+t.action+"!");r=r+"/"+n}}return this._addUrlAffixes(this._addParams(r,t.options),e,t)},l.prototype.urlForCollection=function(e,t){var n;return n=e.url?this._execWithOptions(e,"url",t.options):this._defaultCollectionUrl(e,t.options),this._addUrlAffixes(this._addParams(n,t.options),e,t)},l.prototype.request=function(e,t){var n;return n=Batman.extend(e.options,{autosend:!1,success:function(t){return e.data=t},error:function(t){return e.error=t},loaded:function(){return e.response=e.request.get("response"),t()}}),e.request=new Batman.Request(n),e.request.send()},l.prototype.perform=function(e,t,n,r){return n||(n={}),Batman.extend(n,this.defaultRequestOptions),l.__super__.perform.call(this,e,t,n,r)},l.prototype.before("all",l.skipIfError(function(e,t){if(!e.options.url)try{e.options.url=e.subject.prototype?this.urlForCollection(e.subject,e):this.urlForRecord(e.subject,e)}catch(n){e.error=n}return t()})),l.prototype.before("get","put","post","delete",l.skipIfError(function(e,t){return e.options.method=e.action.toUpperCase(),t()})),l.prototype.before("create","update",l.skipIfError(function(e,t){var n,r,i;return r=e.subject.toJSON(),(i=this.recordJsonNamespace(e.subject))?(n={},n[i]=r):n=r,e.options.data=n,t()})),l.prototype.before("create","update","put","post",l.skipIfError(function(e,t){return this.serializeAsForm?e.options.contentType=this.constructor.PostBodyContentType:e.options.data!=null&&(e.options.data=JSON.stringify(e.options.data),e.options.contentType=this.constructor.JSONContentType),t()})),l.prototype.after("all",l.skipIfError(function(e,t){var n;if(e.data==null)return t();if(typeof e.data=="string"){if(e.data.length>0)try{n=this._jsonToAttributes(e.data)}catch(r){return e.error=r,t()}}else typeof e.data=="object"&&(n=e.data);return n!=null&&(e.json=n),t()})),l.prototype.extractFromNamespace=function(e,t){return t&&e[t]!=null?e[t]:e},l.prototype.after("create","read","update",l.skipIfError(function(e,t){var n;return e.json!=null&&(n=this.extractFromNamespace(e.json,this.recordJsonNamespace(e.subject)),e.subject._withoutDirtyTracking(function(){return this.fromJSON(n)})),e.result=e.subject,t()})),l.prototype.after("readAll",l.skipIfError(function(e,t){var n,r;return r=this.collectionJsonNamespace(e.subject),e.recordsAttributes=this.extractFromNamespace(e.json,r),Batman.typeOf(e.recordsAttributes)!=="Array"&&(r=this.recordJsonNamespace(e.subject.prototype),e.recordsAttributes=[this.extractFromNamespace(e.json,r)]),e.result=e.records=function(){var t,r,i,s;i=e.recordsAttributes,s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(this.getRecordFromData(n,e.subject));return s}.call(this),t()})),l.prototype.after("get","put","post","delete",l.skipIfError(function(e,t){var n,r;return e.json!=null&&(n=e.json,r=e.subject.prototype?this.collectionJsonNamespace(e.subject):this.recordJsonNamespace(e.subject),e.result=r&&e.json[r]!=null?e.json[r]:e.json),t()})),l.HTTPMethods={create:"POST",update:"PUT",read:"GET",readAll:"GET",destroy:"DELETE"},a=["create","read","update","destroy","readAll","get","post","put","delete"],s=function(e){return l.prototype[e]=l.skipIfError(function(t,n){var r;return(r=t.options).method||(r.method=this.constructor.HTTPMethods[e]),this.request(t,n)})};for(o=0,u=a.length;o<u;o++)i=a[o],s(i);return l.prototype.after("all",function(e,t){return e.error&&(e.error=this._errorFor(e.error,e)),t()}),l._statusCodeErrors={0:l.CommunicationError,403:l.NotAllowedError,404:l.NotFoundError,406:l.NotAcceptableError,422:l.UnprocessableRecordError,500:l.InternalStorageError,501:l.NotImplementedError},l.prototype._errorFor=function(e,t){var n,r;if(e instanceof Error||e.request==null)return e;if(n=this.constructor._statusCodeErrors[e.request.status])r=e.request,e=new n,e.request=r,e.env=t;return e},l}.call(this,Batman.StorageAdapter)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.LocalStorage=function(e){function n(){if(typeof window.localStorage=="undefined")return null;n.__super__.constructor.apply(this,arguments),this.storage=localStorage}return t(n,e),n.prototype.storageRegExpForRecord=function(e){return new RegExp("^"+this.storageKey(e)+"(\\d+)$")},n.prototype.nextIdForRecord=function(e){var t,n;return n=this.storageRegExpForRecord(e),t=1,this._forAllStorageEntries(function(e,r){var i;if(i=n.exec(e))return t=Math.max(t,parseInt(i[1],10)+1)}),t},n.prototype._forAllStorageEntries=function(e){var t,n,r,i;for(t=r=0,i=this.storage.length;0<=i?r<i:r>i;t=0<=i?++r:--r)n=this.storage.key(t),e.call(this,n,this.storage.getItem(n));return!0},n.prototype._storageEntriesMatching=function(e,t){var n,r;return n=this.storageRegExpForRecord(e.prototype),r=[],this._forAllStorageEntries(function(i,s){var o,u;if(u=n.exec(i)){o=this._jsonToAttributes(s),o[e.primaryKey]=u[1];if(this._dataMatches(t,o))return r.push(o)}}),r},n.prototype._dataMatches=function(e,t){var n,r,i;r=!0;for(n in e){i=e[n];if(t[n]!==i){r=!1;break}}return r},n.prototype.before("read","create","update","destroy",n.skipIfError(function(e,t){var n=this;return e.action==="create"?e.id=e.subject.get("id")||e.subject._withoutDirtyTracking(function(){return e.subject.set("id",n.nextIdForRecord(e.subject))}):e.id=e.subject.get("id"),e.id==null?e.error=new this.constructor.StorageError("Couldn't get/set record primary key on "+e.action+"!"):e.key=this.storageKey(e.subject)+e.id,t()})),n.prototype.before("create","update",n.skipIfError(function(e,t){return e.recordAttributes=JSON.stringify(e.subject),t()})),n.prototype.after("read",n.skipIfError(function(e,t){if(typeof e.recordAttributes=="string")try{e.recordAttributes=this._jsonToAttributes(e.recordAttributes)}catch(n){return e.error=n,t()}return e.subject._withoutDirtyTracking(function(){return this.fromJSON(e.recordAttributes)}),t()})),n.prototype.after("read","create","update","destroy",n.skipIfError(function(e,t){return e.result=e.subject,t()})),n.prototype.after("readAll",n.skipIfError(function(e,t){var n;return e.result=e.records=function(){var t,r,i,s;i=e.recordsAttributes,s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(this.getRecordFromData(n,e.subject));return s}.call(this),t()})),n.prototype.read=n.skipIfError(function(e,t){return e.recordAttributes=this.storage.getItem(e.key),e.recordAttributes||(e.error=new this.constructor.NotFoundError),t()}),n.prototype.create=n.skipIfError(function(e,t){var n,r;return n=e.key,r=e.recordAttributes,this.storage.getItem(n)?arguments[0].error=new this.constructor.RecordExistsError:this.storage.setItem(n,r),t()}),n.prototype.update=n.skipIfError(function(e,t){var n,r;return n=e.key,r=e.recordAttributes,this.storage.setItem(n,r),t()}),n.prototype.destroy=n.skipIfError(function(e,t){var n;return n=e.key,this.storage.removeItem(n),t()}),n.prototype.readAll=n.skipIfError(function(e,t){try{arguments[0].recordsAttributes=this._storageEntriesMatching(e.subject,e.options.data)}catch(n){arguments[0].error=n}return t()}),n}(Batman.StorageAdapter)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.SessionStorage=function(e){function n(){if(typeof window.sessionStorage=="undefined")return null;n.__super__.constructor.apply(this,arguments),this.storage=sessionStorage}return t(n,e),n}(Batman.LocalStorage)}.call(this),function(){Batman.Encoders=new Batman.Object}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ParamsReplacer=function(e){function n(e,t){this.navigator=e,this.params=t}return t(n,e),n.prototype.redirect=function(){return this.navigator.replace(this.toObject())},n.prototype.replace=function(e){return this.params.replace(e),this.redirect()},n.prototype.update=function(e){return this.params.update(e),this.redirect()},n.prototype.clear=function(){return this.params.clear(),this.redirect()},n.prototype.toObject=function(){return this.params.toObject()},n.accessor({get:function(e){return this.params.get(e)},set:function(e,t){var n,r;return n=this.params.get(e),r=this.params.set(e,t),n!==t&&this.redirect(),r},unset:function(e){var t,n;return t=this.params.hasKey(e),n=this.params.unset(e),t&&this.redirect(),n}}),n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ParamsPusher=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.redirect=function(){return this.navigator.push(this.toObject())},n}(Batman.ParamsReplacer)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.NamedRouteQuery=function(e){function n(e,t){var r;t==null&&(t=[]),n.__super__.constructor.call(this,{routeMap:e,args:t});for(r in this.get("routeMap").childrenByName)this[r]=this._queryAccess.bind(this,r)}return t(n,e),n.prototype.isNamedRouteQuery=!0,n.accessor("route",function(){var e,t,n,r,i,s,o;s=this.get("routeMap"),t=s.memberRoute,e=s.collectionRoute,o=[t,e];for(r=0,i=o.length;r<i;r++){n=o[r];if(n!=null&&n.namedArguments.length===this.get("args").length)return n}return e||t}),n.accessor("path",function(){return this.path()}),n.accessor("routeMap","args","cardinality","hashValue",Batman.Property.defaultAccessor),n.accessor({get:function(e){if(e==null)return;return typeof e=="string"?this.nextQueryForName(e):this.nextQueryWithArgument(e)},cache:!1}),n.accessor("withHash",function(){var e=this;return new Batman.Accessible(function(t){return e.withHash(t)})}),n.prototype.withHash=function(e){var t;return t=this.clone(),t.set("hashValue",e),t},n.prototype.nextQueryForName=function(e){var t;return(t=this.get("routeMap").childrenByName[e])?new Batman.NamedRouteQuery(t,this.args):Batman.developer.error("Couldn't find a route for the name "+e+"!")},n.prototype.nextQueryWithArgument=function(e){var t;return t=this.args.slice(0),t.push(e),this.clone(t)},n.prototype.path=function(){var e,t,n,r,i,s,o;i={},r=this.get("route.namedArguments");for(n=s=0,o=r.length;s<o;n=++s)e=r[n],(t=this.get("args")[n])!=null&&(i[e]=this._toParam(t));return this.get("hashValue")!=null&&(i["#"]=this.get("hashValue")),this.get("route").pathFromParams(i)},n.prototype.toString=function(){return this.path()},n.prototype.clone=function(e){return e==null&&(e=this.args),new Batman.NamedRouteQuery(this.routeMap,e)},n.prototype._toParam=function(e){return e instanceof Batman.AssociationProxy&&(e=e.get("target")),(e!=null?e.toParam:void 0)!=null?e.toParam():e},n.prototype._queryAccess=function(e,t){var n;return n=this.nextQueryForName(e),t!=null&&(n=n.nextQueryWithArgument(t)),n},n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Dispatcher=function(e){function r(e,t){r.__super__.constructor.call(this,{app:e,routeMap:t})}var n;return t(r,e),r.canInferRoute=function(e){return e instanceof Batman.Model||e instanceof Batman.AssociationProxy||e.prototype instanceof Batman.Model},r.paramsFromArgument=function(e){var t;return t=function(e){return Batman.helpers.camelize(Batman.helpers.pluralize(e.get("resourceName")),!0)},this.canInferRoute(e)?e instanceof Batman.Model||e instanceof Batman.AssociationProxy?(e.isProxy&&(e=e.get("target")),e!=null?{controller:t(e.constructor),action:"show",id:e.get("id")}:{}):e.prototype instanceof Batman.Model?{controller:t(e),action:"index"}:e:e},n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor("__app",Batman.Property.defaultAccessor),n.accessor(function(e){return this.get("__app."+Batman.helpers.capitalize(e)+"Controller.sharedController")}),n}(Batman.Object),r.accessor("controllers",function(){return new n({__app:this.get("app")})}),r.prototype.routeForParams=function(e){return e=this.constructor.paramsFromArgument(e),this.get("routeMap").routeForParams(e)},r.prototype.pathFromParams=function(e){var t;return typeof e=="string"?e:(e=this.constructor.paramsFromArgument(e),(t=this.routeForParams(e))!=null?t.pathFromParams(e):void 0)},r.prototype.dispatch=function(e){var t,n,r,i,s,o;n=this.constructor.paramsFromArgument(e),i=this.routeForParams(n);if(i)s=i.pathAndParamsFromArgument(n),r=s[0],e=s[1],this.set("app.currentRoute",i),this.set("app.currentURL",r),this.get("app.currentParams").replace(e||{}),i.dispatch(e);else{if(Batman.typeOf(e)==="Object"&&!this.constructor.canInferRoute(e))return this.get("app.currentParams").replace(e);this.get("app.currentParams").clear(),t={type:"404",isPrevented:!1,preventDefault:function(){return this.isPrevented=!0}},(o=Batman.currentApp)!=null&&o.fire("error",t);if(t.isPrevented)return e;if(e!=="/404")return Batman.redirect("/404")}return r},r}.call(this,Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Route=function(e){function n(e,t){var r,i,s,o,u,a,f,l,c,h;f=this.constructor.regexps,e.indexOf("/")!==0&&(e="/"+e),o=e.replace(f.escapeRegExp,"\\$&"),a=RegExp("^"+o.replace(f.openOptParam,"(?:").replace(f.closeOptParam,")?").replace(f.namedParam,"([^/]+)").replace(f.splatParam,"(.*?)")+f.queryParam+"$"),f.namedOrSplat.lastIndex=0,s=function(){var e;e=[];while(i=f.namedOrSplat.exec(o))e.push(i[1]);return e}(),u={templatePath:e,pattern:o,regexp:a,namedArguments:s,baseParams:t},h=this.optionKeys;for(l=0,c=h.length;l<c;l++)r=h[l],u[r]=t[r],delete t[r];n.__super__.constructor.call(this,u)}return t(n,e),n.regexps={namedParam:/:([\w\d]+)/g,splatParam:/\*([\w\d]+)/g,queryParam:"(?:\\?.+)?",namedOrSplat:/[:|\*]([\w\d]+)/g,namePrefix:"[:|*]",escapeRegExp:/[-[\]{}+?.,\\^$|#\s]/g,openOptParam:/\(/g,closeOptParam:/\)/g},n.prototype.optionKeys=["member","collection"],n.prototype.testKeys=["controller","action"],n.prototype.isRoute=!0,n.prototype.paramsFromPath=function(e){var t,n,r,i,s,o,u,a,f;u=new Batman.URI(e),s=this.get("namedArguments"),o=Batman.extend({path:u.path},this.get("baseParams")),r=this.get("regexp").exec(u.path).slice(1);for(t=a=0,f=r.length;a<f;t=++a)n=r[t],i=s[t],o[i]=n;return Batman.extend(o,u.queryParams)},n.prototype.pathFromParams=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v;s=Batman.extend({},e),o=this.get("templatePath"),f=this.constructor.regexps,d=this.get("namedArguments");for(l=0,h=d.length;l<h;l++)r=d[l],a=RegExp(""+f.namePrefix+r),i=o.replace(a,s[r]!=null?s[r]:""),i!==o&&(delete s[r],o=i);o=o.replace(f.openOptParam,"").replace(f.closeOptParam,"").replace(/([^\/])\/+$/,"$1"),v=this.testKeys;for(c=0,p=v.length;c<p;c++)n=v[c],delete s[n];return s["#"]&&(t=s["#"],delete s["#"]),u=Batman.URI.queryFromParams(s),u&&(o+="?"+u),t&&(o+="#"+t),o},n.prototype.test=function(e){var t,n,r,i,s,o;if(typeof e=="string")n=e;else if(e.path!=null)n=e.path;else{n=this.pathFromParams(e),o=this.testKeys;for(i=0,s=o.length;i<s;i++){t=o[i];if((r=this.get(t))!=null&&e[t]!==r)return!1}}return this.get("regexp").test(n)},n.prototype.pathAndParamsFromArgument=function(e){var t,n;return typeof e=="string"?(t=this.paramsFromPath(e),n=e):(t=e,n=this.pathFromParams(e)),[n,t]},n.prototype.dispatch=function(e){return this.test(e)?this.get("callback")(e):!1},n.prototype.callback=function(){throw new Batman.DevelopmentError("Override callback in a Route subclass")},n}(Batman.Object)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Batman.ControllerActionRoute=function(t){function r(t,n){this.callback=e(this.callback,this);var i,s,o;n.signature&&(o=n.signature.split("#"),s=o[0],i=o[1],i||(i="index"),n.controller=s,n.action=i,delete n.signature),r.__super__.constructor.call(this,t,n)}return n(r,t),r.prototype.optionKeys=["member","collection","app","controller","action"],r.prototype.callback=function(e){var t;return t=this.get("app.dispatcher.controllers."+this.get("controller")),t.dispatch(this.get("action"),e)},r}(Batman.Route)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.CallbackActionRoute=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.optionKeys=["member","collection","callback","app"],n.prototype.controller=!1,n.prototype.action=!1,n}(Batman.Route)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.Hash=function(e){function h(){this.meta=new this.constructor.Metadata(this),Batman.SimpleHash.apply(this,arguments),h.__super__.constructor.apply(this,arguments)}var r,i,s,o,u,a,f,l,c=this;t(h,e),h.Metadata=function(e){function n(e){this.hash=e}return t(n,e),Batman.extend(n.prototype,Batman.Enumerable),n.accessor("length",function(){return this.hash.registerAsMutableSource(),this.hash.length}),n.accessor("isEmpty","keys","toArray",function(e){return this.hash.registerAsMutableSource(),this.hash[e]()}),n.prototype.forEach=function(){var e;return(e=this.hash).forEach.apply(e,arguments)},n}(Batman.Object),Batman.extend(h.prototype,Batman.Enumerable),h.prototype.propertyClass=Batman.Property,h.defaultAccessor={get:Batman.SimpleHash.prototype.get,set:h.mutation(function(e,t){var n;return n=Batman.SimpleHash.prototype.set.call(this,e,t),this.fire("itemsWereAdded",e),n}),unset:h.mutation(function(e){var t;return t=Batman.SimpleHash.prototype.unset.call(this,e),t!=null&&this.fire("itemsWereRemoved",e),t}),cache:!1},h.accessor(h.defaultAccessor),h.prototype._preventMutationEvents=function(e){this.prevent("change"),this.prevent("itemsWereAdded"),this.prevent("itemsWereRemoved");try{return e.call(this)}finally{this.allow("change"),this.allow("itemsWereAdded"),this.allow("itemsWereRemoved")}},h.prototype.clear=h.mutation(function(){var e,t;return e=this.keys(),this._preventMutationEvents(function(){var e=this;return this.forEach(function(t){return e.unset(t)})}),t=Batman.SimpleHash.prototype.clear.call(this),this.fire.apply(this,["itemsWereRemoved"].concat(n.call(e))),t}),h.prototype.update=h.mutation(function(e){var t;t=[],this._preventMutationEvents(function(){var n=this;return Batman.forEach(e,function(e,r){return n.hasKey(e)||t.push(e),n.set(e,r)})});if(t.length>0)return this.fire.apply(this,["itemsWereAdded"].concat(n.call(t)))}),h.prototype.replace=h.mutation(function(e){var t,r;t=[],r=[],this._preventMutationEvents(function(){var n=this;return this.forEach(function(t,i){if(!Batman.objectHasKey(e,t))return n.unset(t),r.push(t)}),Batman.forEach(e,function(e,r){return n.hasKey(e)||t.push(e),n.set(e,r)})}),t.length>0&&this.fire.apply(this,["itemsWereAdded"].concat(n.call(t)));if(r.length>0)return this.fire.apply(this,["itemsWereRemoved"].concat(n.call(r)))}),f=["equality","hashKeyFor","objectKey","prefixedKey","unprefixedKey"];for(s=0,u=f.length;s<u;s++)r=f[s],h.prototype[r]=Batman.SimpleHash.prototype[r];l=["hasKey","forEach","isEmpty","keys","toArray","merge","toJSON","toObject"],i=function(e){return h.prototype[e]=function(){return this.registerAsMutableSource(),Batman.SimpleHash.prototype[e].apply(this,arguments)}};for(o=0,a=l.length;o<a;o++)r=l[o],i(r);return h}.call(this,Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.RenderCache=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.keyQueue=[]}return t(n,e),n.prototype.maximumLength=4,n.prototype.viewForOptions=function(e){var t=this;return e.cache===!1||e.viewClass.prototype.cache===!1?this._newViewFromOptions(e):this.getOrSet(e,function(){return t._newViewFromOptions(Batman.extend({},e))})},n.prototype._newViewFromOptions=function(e){return new e.viewClass(e)},n.wrapAccessor(function(e){return{cache:!1,get:function(t){var n;return n=e.get.call(this,t),n&&this._addOrBubbleKey(t),n},set:function(t,n){var r;return r=e.set.apply(this,arguments),r.set("cached",!0),this._addOrBubbleKey(t),this._evictExpiredKeys(),r},unset:function(t){var n;return n=e.unset.apply(this,arguments),n.set("cached",!1),this._removeKeyFromQueue(t),n}}}),n.prototype.equality=function(e,t){var n;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(n in e)if(n!=="view"&&e[n]!==t[n])return!1;return!0},n.prototype.reset=function(){var e,t,n,r,i;r=this.keyQueue.slice(0),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(this.unset(e));return i},n.prototype._addOrBubbleKey=function(e){return this._removeKeyFromQueue(e),this.keyQueue.unshift(e)},n.prototype._removeKeyFromQueue=function(e){var t,n,r,i,s;s=this.keyQueue;for(t=r=0,i=s.length;r<i;t=++r){n=s[t];if(this.equality(n,e)){this.keyQueue.splice(t,1);break}}return e},n.prototype._evictExpiredKeys=function(){var e,t,n,r,i,s;if(this.length>this.maximumLength){e=this.keyQueue.slice(0);for(t=r=i=this.maximumLength,s=e.length;i<=s?r<s:r>s;t=i<=s?++r:--r)n=e[t],this.get(n).isInDOM()||this.unset(n)}},n}(Batman.Hash)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice,i=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Batman.Controller=function(t){function o(){this.redirect=e(this.redirect,this),this.handleError=e(this.handleError,this),this.errorHandler=e(this.errorHandler,this),o.__super__.constructor.apply(this,arguments),this._resetActionFrames()}var s;return n(o,t),o.singleton("sharedController"),o.wrapAccessor("routingKey",function(e){return{get:function(){return this.routingKey!=null?this.routingKey:(Batman.config.minificationErrors&&Batman.developer.error("Please define `routingKey` on the prototype of "+Batman.functionName(this.constructor)+" in order for your controller to be minification safe."),Batman.functionName(this.constructor).replace(/Controller$/,""))}}}),o.accessor("_renderContext",function(){return Batman.RenderContext.root().descend(this)}),s=function(e,t){return t?typeof e=="string"?e={only:[e]}:(e.only&&Batman.typeOf(e.only)!=="Array"&&(e.only=[e.only]),e.except&&Batman.typeOf(e.except)!=="Array"&&(e.except=[e.except])):(t=e,e={}),e.block=t,e},o.beforeFilter=function(){var e,t,n;return Batman.initializeObject(this),t=s.apply(null,arguments),e=(n=this._batman).beforeFilters||(n.beforeFilters=[]),e.push(t)},o.afterFilter=function(){var e,t,n;return Batman.initializeObject(this),t=s.apply(null,arguments),e=(n=this._batman).afterFilters||(n.afterFilters=[]),e.push(t)},o.afterFilter(function(e){if(this.autoScrollToHash&&e["#"]!=null)return this.scrollToHash(e["#"])}),o.catchError=function(){var e,t,n,i,s,o,u,a,f,l;n=2<=arguments.length?r.call(arguments,0,u=arguments.length-1):(u=0,[]),s=arguments[u++],Batman.initializeObject(this),(o=this._batman).errorHandlers||(o.errorHandlers=new Batman.SimpleHash),i=Batman.typeOf(s["with"])==="Array"?s["with"]:[s["with"]],l=[];for(a=0,f=n.length;a<f;a++)t=n[a],e=this._batman.errorHandlers.get(t)||[],l.push(this._batman.errorHandlers.set(t,e.concat(i)));return l},o.prototype.errorHandler=function(e){var t,n,r=this;return t=(n=this._actionFrames)!=null?n[this._actionFrames.length-1]:void 0,function(n,i,s){if(!n)return typeof e=="function"?e(i,s):void 0;if(t!=null?t.error:void 0)return;t!=null&&(t.error=n);if(!r.handleError(n))throw n}},o.prototype.handleError=function(e){var t,n,r=this;return t=!1,(n=this.constructor._batman.getAll("errorHandlers"))!=null&&n.forEach(function(n){return n.forEach(function(n,i){var s,o,u,a;if(e instanceof n){t=!0,a=[];for(o=0,u=i.length;o<u;o++)s=i[o],a.push(s.call(r,e));return a}})}),t},o.prototype.renderCache=new Batman.RenderCache,o.prototype.defaultRenderYield="main",o.prototype.autoScrollToHash=!0,o.prototype.dispatch=function(e,t){var n;t==null&&(t={}),t.controller||(t.controller=this.get("routingKey")),t.action||(t.action=e),t.target||(t.target=this),this._resetActionFrames(),this.set("action",e),this.set("params",t),Batman.DOM.Yield.cycleAll(),this.executeAction(e,t),Batman.DOM.Yield.clearAllStale(),n=this._afterFilterRedirect,delete this._afterFilterRedirect;if(n)return Batman.redirect(n)},o.prototype.executeAction=function(e,t){var n,r,i,s,o,u,a=this;return t==null&&(t=this.get("params")),Batman.developer.assert(this[e],"Error! Controller action "+this.get("routingKey")+"."+e+" couldn't be found!"),i=this._actionFrames[this._actionFrames.length-1],n=new Batman.ControllerActionFrame({parentFrame:i,action:e},function(){var n;return a._afterFilterRedirect||a._runFilters(e,t,"afterFilters"),a._resetActionFrames(),(n=Batman.navigator)!=null?n.redirect=r:void 0}),this._actionFrames.push(n),n.startOperation({internal:!0}),r=(o=Batman.navigator)!=null?o.redirect:void 0,(u=Batman.navigator)!=null&&(u.redirect=this.redirect),this._runFilters(e,t,"beforeFilters"),this._afterFilterRedirect||(s=this[e](t)),n.operationOccurred||this.render(),n.finishOperation(),s},o.prototype.redirect=function(e){var t;return t=this._actionFrames[this._actionFrames.length-1],t?(t.operationOccurred&&Batman.developer.warn("Warning! Trying to redirect but an action has already been taken during "+this.get("routingKey")+"."+(t.action||this.get("action"))),t.startAndFinishOperation(),this._afterFilterRedirect!=null?Batman.developer.warn("Warning! Multiple actions trying to redirect!"):this._afterFilterRedirect=e):(Batman.typeOf(e)==="Object"&&(e.controller||(e.controller=this)),Batman.redirect(e))},o.prototype.render=function(e){var t,n,r,i,s,o=this;e==null&&(e={}),(n=(i=this._actionFrames)!=null?i[this._actionFrames.length-1]:void 0)&&n.startOperation();if(e===!1){n.finishOperation();return}return t=(n!=null?n.action:void 0)||this.get("action"),e&&(e.into||(e.into=this.defaultRenderYield)),e.view?(r=e.view,e.view=null):(e.viewClass||(e.viewClass=this._viewClassForAction(t)),e.context||(e.context=this.get("_renderContext")),e.source||(e.source=Batman.helpers.underscore(this.get("routingKey")+"/"+t)),r=this.renderCache.viewForOptions(e)),r&&((s=Batman.currentApp)!=null&&s.prevent("ready"),r.on("ready",function(){var t;return Batman.DOM.Yield.withName(e.into).replace(r.get("node")),(t=Batman.currentApp)!=null&&t.allowAndFire("ready"),n!=null?n.finishOperation():void 0})),r},o.prototype.scrollToHash=function(e){return e==null&&(e=this.get("params")["#"]),Batman.DOM.scrollIntoView(e)},o.prototype._resetActionFrames=function(){return this._actionFrames=[]},o.prototype._viewClassForAction=function(e){var t,n;return t=this.get("routingKey").replace("/","_"),((n=Batman.currentApp)!=null?n[Batman.helpers.camelize(""+t+"_"+e+"_view")]:void 0)||Batman.View},o.prototype._runFilters=function(e,t,n){var r,s,o,u,a;if(n=(a=this.constructor._batman)!=null?a.get(n):void 0)for(o=0,u=n.length;o<u;o++){s=n[o];if(s.only&&i.call(s.only,e)<0)continue;if(s.except&&i.call(s.except,e)>=0)continue;if(this._afterFilterRedirect)return;r=s.block,typeof r=="function"?r.call(this,t):typeof this[r]=="function"&&this[r](t)}},o}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Set=function(e){function c(){Batman.SimpleSet.apply(this,arguments)}var n,r,i,s,o,u,a,f,l=this;t(c,e),Batman.extend(c.prototype,Batman.Enumerable),c._applySetAccessors=function(e){var t,n,r,i;n={first:function(){return this.toArray()[0]},last:function(){return this.toArray()[this.length-1]},isEmpty:function(){return this.isEmpty()},toArray:function(){return this.toArray()},length:function(){return this.registerAsMutableSource(),this.length},indexedBy:function(){var e=this;return new Batman.TerminalAccessible(function(t){return e.indexedBy(t)})},indexedByUnique:function(){var e=this;return new Batman.TerminalAccessible(function(t){return e.indexedByUnique(t)})},sortedBy:function(){var e=this;return new Batman.TerminalAccessible(function(t){return e
.sortedBy(t)})},sortedByDescending:function(){var e=this;return new Batman.TerminalAccessible(function(t){return e.sortedBy(t,"desc")})}},i=[];for(r in n)t=n[r],i.push(e.accessor(r,t));return i},c._applySetAccessors(c),a=["add","remove","clear","replace","indexedBy","indexedByUnique","sortedBy","equality","_indexOfItem"];for(i=0,o=a.length;i<o;i++)n=a[i],c.prototype[n]=Batman.SimpleSet.prototype[n];f=["find","merge","forEach","toArray","isEmpty","has"],r=function(e){return c.prototype[e]=function(){return this.registerAsMutableSource(),Batman.SimpleSet.prototype[e].apply(this,arguments)}};for(s=0,u=f.length;s<u;s++)n=f[s],r(n);return c.prototype.toJSON=c.prototype.toArray,c}.call(this,Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ErrorsSet=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor(function(e){return this.indexedBy("attribute").get(e)}),n.prototype.add=function(e,t){return n.__super__.add.call(this,new Batman.ValidationError(e,t))},n}(Batman.Set)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetProxy=function(e){function f(e){var t=this;this.base=e,f.__super__.constructor.call(this),this.length=this.base.length,this.base.on("itemsWereAdded",function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],t.set("length",t.base.length),t.fire.apply(t,["itemsWereAdded"].concat(n.call(e)))}),this.base.on("itemsWereRemoved",function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],t.set("length",t.base.length),t.fire.apply(t,["itemsWereRemoved"].concat(n.call(e)))})}var r,i,s,o,u,a=this;t(f,e),Batman.extend(f.prototype,Batman.Enumerable),f.prototype.filter=function(e){var t;return t=new Batman.Set,this.reduce(function(t,n){return e(n)&&t.add(n),t},t)},f.prototype.replace=function(){var e,t;return e=this.property("length"),e.isolate(),t=this.base.replace.apply(this,arguments),e.expose(),t},u=["add","remove","find","clear","has","merge","toArray","isEmpty","indexedBy","indexedByUnique","sortedBy"],i=function(e){return f.prototype[e]=function(){var t;return(t=this.base)[e].apply(t,arguments)}};for(s=0,o=u.length;s<o;s++)r=u[s],i(r);return Batman.Set._applySetAccessors(f),f.accessor("length",{get:function(){return this.registerAsMutableSource(),this.length},set:function(e,t){return this.length=t}}),f}.call(this,Batman.Object)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;Batman.BinarySetOperation=function(t){function i(t,n){this.left=t,this.right=n,this._setup=e(this._setup,this),i.__super__.constructor.call(this),this._setup(this.left,this.right),this._setup(this.right,this.left)}return n(i,t),i.prototype._setup=function(e,t){var n=this;return e.on("itemsWereAdded",function(){var i;return i=1<=arguments.length?r.call(arguments,0):[],n._itemsWereAddedToSource.apply(n,[e,t].concat(r.call(i)))}),e.on("itemsWereRemoved",function(){var i;return i=1<=arguments.length?r.call(arguments,0):[],n._itemsWereRemovedFromSource.apply(n,[e,t].concat(r.call(i)))}),this._itemsWereAddedToSource.apply(this,[e,t].concat(r.call(e.toArray())))},i.prototype.merge=function(){var e,t,n,i,s;t=1<=arguments.length?r.call(arguments,0):[],e=new Batman.Set,t.unshift(this);for(i=0,s=t.length;i<s;i++)n=t[i],n.forEach(function(t){return e.add(t)});return e},i.prototype.filter=Batman.SetProxy.prototype.filter,i}(Batman.Set)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetUnion=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype._itemsWereAddedToSource=function(){var e,t,r;return r=arguments[0],t=arguments[1],e=3<=arguments.length?n.call(arguments,2):[],this.add.apply(this,e)},r.prototype._itemsWereRemovedFromSource=function(){var e,t,r,i,s;return s=arguments[0],i=arguments[1],t=3<=arguments.length?n.call(arguments,2):[],r=function(){var n,r,s;s=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.has(e)||s.push(e);return s}(),this.remove.apply(this,r)},r}(Batman.BinarySetOperation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetIntersection=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype._itemsWereAddedToSource=function(){var e,t,r,i,s;return s=arguments[0],i=arguments[1],t=3<=arguments.length?n.call(arguments,2):[],r=function(){var n,r,s;s=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.has(e)&&s.push(e);return s}(),this.add.apply(this,r)},r.prototype._itemsWereRemovedFromSource=function(){var e,t,r;return r=arguments[0],t=arguments[1],e=3<=arguments.length?n.call(arguments,2):[],this.remove.apply(this,e)},r}(Batman.BinarySetOperation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetComplement=function(e){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype._itemsWereAddedToSource=function(){var e,t,r,i,s,o;return o=arguments[0],s=arguments[1],t=3<=arguments.length?n.call(arguments,2):[],o===this.left?(r=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],s.has(e)||i.push(e);return i}(),this.add.apply(this,r)):(i=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],s.has(e)&&i.push(e);return i}(),this.remove.apply(this,i))},r.prototype._itemsWereRemovedFromSource=function(){var e,t,r,i,s;return s=arguments[0],i=arguments[1],t=3<=arguments.length?n.call(arguments,2):[],s===this.left?this.remove.apply(this,t):(r=function(){var n,r,s;s=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.has(e)&&s.push(e);return s}(),this.add.apply(this,r))},r.prototype._addComplement=function(e,t){var n;return this.add.apply(this,function(){var r,i,s;s=[];for(r=0,i=e.length;r<i;r++)n=e[r],t.has(n)&&s.push(n);return s}())},r}(Batman.BinarySetOperation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.StateMachine=function(e){function r(e){this.nextEvents=[],this.set("_state",e)}return t(r,e),r.InvalidTransitionError=function(e){this.message=e!=null?e:""},r.InvalidTransitionError.prototype=new Error,r.transitions=function(e){var t,r,i,s,o,u,a,f,l,c,h=this;for(i in e){f=e[i];if(!f.from||!f.to)continue;s={},f.from.forEach?f.from.forEach(function(e){return s[e]=f.to}):s[f.from]=f.to,e[i]=s}this.prototype.transitionTable=Batman.extend({},this.prototype.transitionTable,e),o=[],t=function(e){var t;t="is"+Batman.helpers.capitalize(e);if(h.prototype[t]!=null)return;return o.push(t),h.prototype[t]=function(){return this.get("state")===e}},c=this.prototype.transitionTable,l=function(e){return h.prototype[e]=function(){return this.startTransition(e)}};for(i in c){a=c[i];if(!!this.prototype[i])continue;l(i);for(r in a)u=a[r],t(r),t(u)}return o.length&&this.accessor.apply(this,n.call(o).concat([function(e){return this[e]()}])),this},r.accessor("state",function(){return this.get("_state")}),r.prototype.isTransitioning=!1,r.prototype.transitionTable={},r.prototype.onTransition=function(e,t,n){return this.on(""+e+"->"+t,n)},r.prototype.onEnter=function(e,t){return this.on("enter "+e,t)},r.prototype.onExit=function(e,t){return this.on("exit "+e,t)},r.prototype.startTransition=Batman.Property.wrapTrackingPrevention(function(e){var t,n;if(this.isTransitioning){this.nextEvents.push(e);return}return n=this.get("state"),t=this.nextStateForEvent(e),t?(this.isTransitioning=!0,this.fire("exit "+n),this.set("_state",t),this.fire(""+n+"->"+t),this.fire("enter "+t),this.fire(e),this.isTransitioning=!1,this.nextEvents.length>0&&this.startTransition(this.nextEvents.shift()),!0):!1}),r.prototype.canStartTransition=function(e,t){return t==null&&(t=this.get("state")),!!this.nextStateForEvent(e,t)},r.prototype.nextStateForEvent=function(e,t){var n;return t==null&&(t=this.get("state")),(n=this.transitionTable[e])!=null?n[t]:void 0},r}(Batman.Object),Batman.DelegatingStateMachine=function(e){function n(e,t){this.base=t,n.__super__.constructor.call(this,e)}return t(n,e),n.prototype.fire=function(){var e,t;return e=n.__super__.fire.apply(this,arguments),(t=this.base).fire.apply(t,arguments),e},n}(Batman.StateMachine)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;Batman.Model=function(t){function c(t){t==null&&(t={}),this.destroy=e(this.destroy,this),this.save=e(this.save,this),this.load=e(this.load,this),Batman.developer.assert(this instanceof Batman.Object,"constructors must be called with new"),Batman.typeOf(t)==="Object"?c.__super__.constructor.call(this,t):(c.__super__.constructor.call(this),this.set("id",t))}var i,s,o,u,a,f,l;n(c,t),c.storageKey=null,c.primaryKey="id",c.persist=function(){var e,t;return e=arguments[0],t=2<=arguments.length?r.call(arguments,1):[],Batman.initializeObject(this.prototype),e=e.isStorageAdapter?e:new e(this),t.length>0&&Batman.mixin.apply(Batman,[e].concat(r.call(t))),this.prototype._batman.storage=e,e},c.storageAdapter=function(){return Batman.initializeObject(this.prototype),this.prototype._batman.storage},c.encode=function(){var e,t,n,i,s,o,u,a,f;s=2<=arguments.length?r.call(arguments,0,u=arguments.length-1):(u=0,[]),n=arguments[u++],Batman.initializeObject(this.prototype),(o=this.prototype._batman).encoders||(o.encoders=new Batman.SimpleHash),e={};switch(Batman.typeOf(n)){case"String":s.push(n);break;case"Function":e.encode=n;break;default:e=n}for(a=0,f=s.length;a<f;a++)i=s[a],t=Batman.extend({as:i},this.defaultEncoder,e),this.prototype._batman.encoders.set(i,t)},c.defaultEncoder={encode:function(e){return e},decode:function(e){return e}},c.observeAndFire("primaryKey",function(e,t){return this.encode(t,{encode:!1,decode:!1}),this.encode(e,{encode:!1,decode:this.defaultEncoder.decode})}),c.validate=function(){var e,t,n,i,s,o,u,a,f,l,c;e=2<=arguments.length?r.call(arguments,0,u=arguments.length-1):(u=0,[]),n=arguments[u++],Batman.initializeObject(this.prototype),s=(o=this.prototype._batman).validators||(o.validators=[]);if(typeof n=="function")return s.push({keys:e,callback:n});l=Batman.Validators,c=[];for(a=0,f=l.length;a<f;a++)i=l[a],(t=i.matches(n))?c.push(s.push({keys:e,validator:new i(t)})):c.push(void 0);return c},c.classAccessor("resourceName",{get:function(){return this.resourceName!=null?this.resourceName:(Batman.config.minificationErrors&&Batman.developer.error("Please define "+Batman.functionName(this)+".resourceName in order for your model to be minification safe."),Batman.helpers.underscore(Batman.functionName(this)))}}),c.classAccessor("all",{get:function(){return this._batman.check(this),this.prototype.hasStorage()&&!this._batman.allLoadTriggered&&(this.load(),this._batman.allLoadTriggered=!0),this.get("loaded")},set:function(e,t){return this.set("loaded",t)}}),c.classAccessor("loaded",{get:function(){return this._loaded||(this._loaded=new Batman.Set)},set:function(e,t){return this._loaded=t}}),c.classAccessor("first",function(){return this.get("all").toArray()[0]}),c.classAccessor("last",function(){var e;return e=this.get("all").toArray(),e[e.length-1]}),c.clear=function(){var e,t;return Batman.initializeObject(this),e=this.get("loaded").clear(),(t=this._batman.get("associations"))!=null&&t.reset(),e},c.find=function(e,t){var n;return Batman.developer.assert(t,"Must call find with a callback!"),n=new this,n._withoutDirtyTracking(function(){return this.set("id",e)}),n.load(t),n},c.load=function(e,t){var n,r=this;if((n=typeof e)==="function"||n==="undefined")t=e,e={};return this.fire("loading",e),this._doStorageOperation("readAll",{data:e},function(e,n,i){var s,o;return e!=null?(r.fire("error",e),typeof t=="function"?t(e,[]):void 0):(s=function(){var e,t,r;r=[];for(e=0,t=n.length;e<t;e++)o=n[e],r.push(this._mapIdentity(o));return r}.call(r),r.fire("loaded",s,i),typeof t=="function"?t(e,s,i):void 0)})},c.create=function(e,t){var n,r;return t||(r=[{},e],e=r[0],t=r[1]),n=new this(e),n.save(t),n},c.findOrCreate=function(e,t){var n,r;return r=new this(e),r.isNew()?r.save(t):(n=this._mapIdentity(r),t(void 0,n)),r},c.createFromJSON=function(e){var t;return t=new this,t._withoutDirtyTracking(function(){return this.fromJSON(e)}),this._mapIdentity(t)},c._mapIdentity=function(e){var t,n,r;return typeof (n=e.get("id"))=="undefined"||n===""?e:(t=(r=this.get("loaded.indexedBy.id").get(n))!=null?r.toArray()[0]:void 0,t?(t._withoutDirtyTracking(function(){var t;return this.updateAttributes(((t=e.get("attributes"))!=null?t.toObject():void 0)||{})}),t):(this.get("loaded").add(e),e))},c._doStorageOperation=function(e,t,n){var r;return Batman.developer.assert(this.prototype.hasStorage(),"Can't "+e+" model "+Batman.functionName(this.constructor)+" without any storage adapters!"),r=this.prototype._batman.get("storage"),r.perform(e,this,t,n)},f=["find","load","create"];for(s=0,u=f.length;s<u;s++)i=f[s],c[i]=Batman.Property.wrapTrackingPrevention(c[i]);c.InstanceLifecycleStateMachine=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),t.transitions({load:{from:["dirty","clean"],to:"loading"},create:{from:["dirty","clean"],to:"creating"},save:{from:["dirty","clean"],to:"saving"},destroy:{from:["dirty","clean"],to:"destroying"},failedValidation:{from:["saving","creating"],to:"dirty"},loaded:{loading:"clean"},created:{creating:"clean"},saved:{saving:"clean"},destroyed:{destroying:"destroyed"},set:{from:["dirty","clean"],to:"dirty"},error:{from:["saving","creating","loading","destroying"],to:"error"}}),t}(Batman.DelegatingStateMachine),c.accessor("lifecycle",function(){return this.lifecycle||(this.lifecycle=new Batman.Model.InstanceLifecycleStateMachine("clean",this))}),c.accessor("attributes",function(){return this.attributes||(this.attributes=new Batman.Hash)}),c.accessor("dirtyKeys",function(){return this.dirtyKeys||(this.dirtyKeys=new Batman.Hash)}),c.accessor("_dirtiedKeys",function(){return this._dirtiedKeys||(this._dirtiedKeys=new Batman.SimpleSet)}),c.accessor("errors",function(){return this.errors||(this.errors=new Batman.ErrorsSet)}),c.accessor("isNew",function(){return this.isNew()}),c.accessor("isDirty",function(){return this.isDirty()}),c.accessor(c.defaultAccessor={get:function(e){return Batman.getPath(this,["attributes",e])},set:function(e,t){return this._willSet(e)?this.get("attributes").set(e,t):this.get(e)},unset:function(e){return this.get("attributes").unset(e)}}),c.wrapAccessor("id",function(e){return{get:function(){var t;return t=this.constructor.primaryKey,t==="id"?e.get.apply(this,arguments):this.get(t)},set:function(t,n){var r,i;return typeof n=="string"&&n.match(/[^0-9]/)===null&&""+(r=parseInt(n,10))===n&&(n=r),i=this.constructor.primaryKey,i==="id"?(this._willSet(t),e.set.apply(this,arguments)):this.set(i,n)}}}),c.prototype.isNew=function(){return typeof this.get("id")=="undefined"},c.prototype.isDirty=function(){return this.get("lifecycle.state")==="dirty"},c.prototype.updateAttributes=function(e){return this.mixin(e),this},c.prototype.toString=function(){return""+this.constructor.get("resourceName")+": "+this.get("id")},c.prototype.toParam=function(){return this.get("id")},c.prototype.toJSON=function(){var e,t,n=this;return t={},e=this._batman.get("encoders"),!!e&&!e.isEmpty()&&e.forEach(function(e,r){var i,s;if(r.encode){s=n.get(e);if(typeof s!="undefined"){i=r.encode(s,e,t,n);if(typeof i!="undefined")return t[r.as]=i}}}),t},c.prototype.fromJSON=function(e){var t,n,r,i,s=this;r={},t=this._batman.get("encoders");if(!t||t.isEmpty()||!t.some(function(e,t){return t.decode!=null}))for(n in e)i=e[n],r[n]=i;else t.forEach(function(t,n){if(n.decode&&typeof e[n.as]!="undefined")return r[t]=n.decode(e[n.as],n.as,e,r,s)});return this.constructor.primaryKey!=="id"&&(r.id=e[this.constructor.primaryKey]),Batman.developer["do"](function(){if(!t||t.length<=1)return Batman.developer.warn("Warning: Model "+Batman.functionName(s.constructor)+" has suspiciously few decoders!")}),this.mixin(r)},c.prototype.hasStorage=function(){return this._batman.get("storage")!=null},c.prototype.load=function(e,t){var n,r,i,s,o=this;t||(i=[{},e],e=i[0],t=i[1]),r=Object.keys(e).length!==0;if((s=this.get("lifecycle.state"))==="destroying"||s==="destroyed"){typeof t=="function"&&t(new Error("Can't load a destroyed record!"));return}if(this.get("lifecycle").load())return n=[],t!=null&&n.push(t),r||(this._currentLoad=n),this._doStorageOperation("read",{data:e},function(e,i,s){var u,a;e?o.get("lifecycle").error():(o.get("lifecycle").loaded(),i=o.constructor._mapIdentity(i)),r||(o._currentLoad=null);for(u=0,a=n.length;u<a;u++)t=n[u],t(e,i,s)});if(this.get("lifecycle.state")!=="loading"||!!r)return typeof t=="function"?t(new Batman.StateMachine.InvalidTransitionError("Can't load while in state "+this.get("lifecycle.state"))):void 0;if(t!=null)return this._currentLoad.push(t)},c.prototype.save=function(e,t){var n,r,i,s,o,u,a=this;return t||(o=[{},e],e=o[0],t=o[1]),r=this.isNew(),u=r?["create","create","created"]:["save","update","saved"],i=u[0],s=u[1],n=u[2],this.get("lifecycle").startTransition(i)?this.validate(function(r,i){var o;return r||i.length?(a.get("lifecycle").failedValidation(),typeof t=="function"?t(r||i,a):void 0):(o=a.constructor._batman.get("associations"),a._withoutDirtyTracking(function(){var e,t=this;return o!=null?(e=o.getByType("belongsTo"))!=null?e.forEach(function(e,n){return e.apply(t)}):void 0:void 0}),a._doStorageOperation(s,{data:e},function(e,r,i){return e?e instanceof Batman.ErrorsSet?a.get("lifecycle").failedValidation():a.get("lifecycle").error():(a.get("dirtyKeys").clear(),a.get("_dirtiedKeys").clear(),o&&r._withoutDirtyTracking(function(){var t,n;return(t=o.getByType("hasOne"))!=null&&t.forEach(function(t,n){return t.apply(e,r)}),(n=o.getByType("hasMany"))!=null?n.forEach(function(t,n){return t.apply(e,r)}):void 0}),r=a.constructor._mapIdentity(r),a.get("lifecycle").startTransition(n)),typeof t=="function"?t(e,r||a,i):void 0}))}):typeof t=="function"?t(new Batman.StateMachine.InvalidTransitionError("Can't save while in state "+this.get("lifecycle.state"))):void 0},c.prototype.destroy=function(e,t){var n,r=this;return t||(n=[{},e],e=n[0],t=n[1]),this.get("lifecycle").destroy()?this._doStorageOperation("destroy",{data:e},function(e,n,i){return e?r.get("lifecycle").error():(r.constructor.get("loaded").remove(r),r.get("lifecycle").destroyed()),typeof t=="function"?t(e,n,i):void 0}):typeof t=="function"?t(new Batman.StateMachine.InvalidTransitionError("Can't destroy while in state "+this.get("lifecycle.state"))):void 0},c.prototype.validate=function(e){var t,n,r,i,s,o,u,a,f,l,c,h;r=this.get("errors"),r.clear(),u=this._batman.get("validators")||[];if(!u||u.length===0)return typeof e=="function"&&e(void 0,r),!0;n=u.reduce(function(e,t){return e+t.keys.length},0),i=function(){if(--n===0)return typeof e=="function"?e(void 0,r):void 0};for(a=0,l=u.length;a<l;a++){o=u[a],h=o.keys;for(f=0,c=h.length;f<c;f++){s=h[f],t=[r,this,s,i];try{o.validator?o.validator.validateEach.apply(o.validator,t):o.callback.apply(o,t)}catch(p){typeof e=="function"&&e(p,r)}}}},c.prototype.associationProxy=function(e){var t,n,r;return Batman.initializeObject(this),t=(n=this._batman).associationProxies||(n.associationProxies={}),t[r=e.label]||(t[r]=new e.proxyClass(e,this)),t[e.label]},c.prototype._willSet=function(e){return this._pauseDirtyTracking?!0:this.get("lifecycle").startTransition("set")?(this.get("_dirtiedKeys").has(e)||(this.set("dirtyKeys."+e,this.get(e)),this.get("_dirtiedKeys").add(e)),!0):!1},c.prototype._doStorageOperation=function(e,t,n){var r,i=this;return Batman.developer.assert(this.hasStorage(),"Can't "+e+" model "+Batman.functionName(this.constructor)+" without any storage adapters!"),r=this._batman.get("storage"),r.perform(e,this,t,function(){return n.apply(null,arguments)})},c.prototype._withoutDirtyTracking=function(e){var t;return this._pauseDirtyTracking=!0,t=e.call(this),this._pauseDirtyTracking=!1,t},l=["load","save","validate","destroy"];for(o=0,a=l.length;o<a;o++)i=l[o],c.prototype[i]=Batman.Property.wrapTrackingPrevention(c.prototype[i]);return c}.call(this,Batman.Object)}.call(this),function(){var e,t,n,r,i,s=this;i=Batman.AssociationCurator.availableAssociations,t=function(e){return Batman.Model[e]=function(t,n){var r,i;return Batman.initializeObject(this),r=(i=this._batman).associations||(i.associations=new Batman.AssociationCurator(this)),r.add(new(Batman[""+Batman.helpers.capitalize(e)+"Association"])(this,t,n))}};for(n=0,r=i.length;n<r;n++)e=i[n],t(e)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Proxy=function(e){function n(e){n.__super__.constructor.call(this),e!=null&&this.set("target",e)}return t(n,e),n.prototype.isProxy=!0,n.accessor("target",Batman.Property.defaultAccessor),n.accessor({get:function(e){var t;return(t=this.get("target"))!=null?t.get(e):void 0},set:function(e,t){var n;return(n=this.get("target"))!=null?n.set(e,t):void 0},unset:function(e){var t;return(t=this.get("target"))!=null?t.unset(e):void 0}}),n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.AssociationProxy=function(e){function n(e,t){this.association=e,this.model=t,n.__super__.constructor.call(this)}return t(n,e),n.prototype.loaded=!1,n.prototype.toJSON=function(){var e;e=this.get("target");if(e!=null)return this.get("target").toJSON()},n.prototype.load=function(e){var t=this;return this.fetch(function(n,r){return n||t._setTarget(r),typeof e=="function"?e(n,r):void 0}),this.get("target")},n.prototype.loadFromLocal=function(){var e;if(!this._canLoad())return;return(e=this.fetchFromLocal())&&this._setTarget(e),e},n.prototype.fetch=function(e){var t;return this._canLoad()?(t=this.fetchFromLocal(),t?e(void 0,t):this.fetchFromRemote(e)):e(void 0,void 0)},n.accessor("loaded",Batman.Property.defaultAccessor),n.accessor("target",{get:function(){return this.fetchFromLocal()},set:function(e,t){return t}}),n.prototype._canLoad=function(){return(this.get("foreignValue")||this.get("primaryValue"))!=null},n.prototype._setTarget=function(e){return this.set("target",e),this.set("loaded",!0),this.fire("loaded",e)},n}(Batman.Proxy)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.HasOneProxy=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor("primaryValue",function(){return this.model.get(this.association.primaryKey)}),n.prototype.fetchFromLocal=function(){return this.association.setIndex().get(this.get("primaryValue"))},n.prototype.fetchFromRemote=function(e){var t,n=this;return t={},t[this.association.foreignKey]=this.get("primaryValue"),this.association.getRelatedModel().load(t,function(t,n){if(t)throw t;return!n||n.length<=0?e(new Error("Couldn't find related record!"),void 0):e(void 0,n[0])})},n}(Batman.AssociationProxy)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.BelongsToProxy=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor("foreignValue",function(){return this.model.get(this.association.foreignKey)}),n.prototype.fetchFromLocal=function(){return this.association.setIndex().get(this.get("foreignValue"))},n.prototype.fetchFromRemote=function(e){var t=this;return this.association.getRelatedModel().find(this.get("foreignValue"),function(t,n){if(t)throw t;return e(void 0,n)})},n}(Batman.AssociationProxy)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicBelongsToProxy=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor("foreignTypeValue",function(){return this.model.get(this.association.foreignTypeKey)}),n.prototype.fetchFromLocal=function(){return this.association.setIndexForType(this.get("foreignTypeValue")).get(this.get("foreignValue"))},n.prototype.fetchFromRemote=function(e){var t=this;return this.association.getRelatedModelForType(this.get("foreignTypeValue")).find(this.get("foreignValue"),function(t,n){if(t)throw t;return e(void 0,n)})},n}(Batman.BelongsToProxy)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Accessible=function(e){function n(){this.accessor.apply(this,arguments)}return t(n,e),n}(Batman.Object),Batman.TerminalAccessible=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.propertyClass=Batman.Property,n}(Batman.Accessible)}.call(this),function(){Batman.mixins=new Batman.Object}.call(this),function(){Batman.URI=function(){function h(t){var n,r;r=c.exec(t),n=14;while(n--)this[e[n]]=r[n]||"";this.queryParams=this.constructor.paramsFromQuery(this.query),delete this.authority,delete this.userInfo,delete this.relative,delete this.directory,delete this.file,delete this.query}var e,t,n,r,i,s,o,u,a,f,l,c;return c=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","hostname","port","relative","path","directory","file","query","hash"],h.prototype.queryString=function(){return this.constructor.queryFromParams(this.queryParams)},h.prototype.toString=function(){return[this.protocol?""+this.protocol+":":void 0,this.authority()?"//":void 0,this.authority(),this.relative()].join("")},h.prototype.userInfo=function(){return[this.user,this.password?":"+this.password:void 0].join("")},h.prototype.authority=function(){return[this.userInfo(),this.user||this.password?"@":void 0,this.hostname,this.port?":"+this.port:void 0].join("")},h.prototype.relative=function(){var e;return e=this.queryString(),[this.path,e?"?"+e:void 0,this.hash?"#"+this.hash:void 0].join("")},h.prototype.directory=function(){var e;return e=this.path.split("/"),e.length>1?e.slice(0,e.length-1).join("/")+"/":""},h.prototype.file=function(){var e;return e=this.path.split("/"),e[e.length-1]},h.paramsFromQuery=function(e){var t,r,i,o,a,f;r={},f=e.split("&");for(o=0,a=f.length;o<a;o++)i=f[o],(t=i.match(s))?u(r,n(t[1]),n(t[2])):u(r,n(i),null);return r},h.decodeQueryComponent=n=function(e){return decodeURIComponent(e.replace(a,"%20"))},o=/^[\[\]]*([^\[\]]+)\]*(.*)/,t=[/^\[\]\[([^\[\]]+)\]$/,/^\[\](.+)$/],a=/\+/g,l=/%20/g,s=/^([^=]*)=(.*)/,u=function(e,n,r){var i,s,a,f,l,c,h,p;if(!(l=n.match(o)))return;a=l[1],i=l[2];if(i==="")e[a]=r;else if(i==="[]"){(c=e[a])==null&&(e[a]=[]);if(Batman.typeOf(e[a])!=="Array")throw new Error("expected Array (got "+Batman.typeOf(e[a])+') for param "'+a+'"');e[a].push(r)}else if(l=i.match(t[0])||i.match(t[1])){s=l[1],(h=e[a])==null&&(e[a]=[]);if(Batman.typeOf(e[a])!=="Array")throw new Error("expected Array (got "+Batman.typeOf(e[a])+') for param "'+a+'"');f=e[a][e[a].length-1],Batman.typeOf(f)!=="Object"||s in f?e[a].push(u({},s,r)):u(f,s,r)}else{(p=e[a])==null&&(e[a]={});if(Batman.typeOf(e[a])!=="Object")throw new Error("expected Object (got "+Batman.typeOf(e[a])+') for param "'+a+'"');e[a]=u(e[a],i,r)}return e},h.queryFromParams=f=function(e,t){var n,r,s,o;if(e==null)return t;o=Batman.typeOf(e);if(t==null&&o!=="Object")throw new Error("value must be an Object");switch(o){case"Array":return function(){var r,i;n=[];if(e.length===0)n.push(f(null,""+t+"[]"));else for(r=0,i=e.length;r<i;r++)s=e[r],n.push(f(s,""+t+"[]"));return n}().join("&");case"Object":return function(){var n;n=[];for(r in e)s=e[r],n.push(f(s,t?""+t+"["+i(r)+"]":i(r)));return n}().join("&");default:return t!=null?""+t+"="+i(e):i(e)}},h.encodeComponent=r=function(e){return e!=null?encodeURIComponent(e):""},h.encodeQueryComponent=i=function(e){return r(e).replace(l,"+")},h}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.Request=function(e){function r(e){var t,n,i,s;n={};for(i in e){t=e[i];if(i!=="success"&&i!=="error"&&i!=="loading"&&i!=="loaded")continue;n[i]=t,delete e[i]}r.__super__.constructor.call(this,e);for(i in n)t=n[i],this.on(i,t);((s=this.get("url"))!=null?s.length:void 0)>0?this.autosend&&this.send():this.observe("url",function(e){if(e!=null)return this.send()})}var n;return t(r,e),r.objectToFormData=function(e){var t,n,r,i,s,o,u,a;r=function(e,t,n){var i,s,o;return n==null&&(n=!1),t instanceof Batman.container.File?[[e,t]]:s=function(){switch(Batman.typeOf(t)){case"Object":return s=function(){var s;s=[];for(i in t)o=t[i],s.push(r(n?i:""+e+"["+i+"]",o));return s}(),s.reduce(function(e,t){return e.concat(t)},[]);case"Array":return t.reduce(function(t,n){return t.concat(r(""+e+"[]",n))},[]);default:return[[e,t!=null?t:""]]}}()},t=new Batman.container.FormData,u=r("",e,!0);for(s=0,o=u.length;s<o;s++)a=u[s],n=a[0],i=a[1],t.append(n,i);return t},r.dataHasFileUploads=n=function(e){var t,r,i,s,o;if(typeof File!="undefined"&&File!==null&&e instanceof File)return!0;r=Batman.typeOf(e);switch(r){case"Object":for(t in e){i=e[t];if(n(i))return!0}break;case"Array":for(s=0,o=e.length;s<o;s++){i=e[s];if(n(i))return!0}}return!1},r.wrapAccessor("method",function(e){return{set:function(t,n){return e.set.call(this,t,n!=null?typeof n.toUpperCase=="function"?n.toUpperCase():void 0:void 0)}}}),r.prototype.method="GET",r.prototype.hasFileUploads=function(){return n(this.data)},r.prototype.contentType="application/x-www-form-urlencoded",r.prototype.autosend=!0,r.prototype.send=function(){return Batman.developer.error("Please source a dependency file for a request implementation")},r}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetObserver=function(e){function r(e){var t=this;this.base=e,this._itemObservers=new Batman.SimpleHash,this._setObservers=new Batman.SimpleHash,this._setObservers.set("itemsWereAdded",function(){return t.fire.apply(t,["itemsWereAdded"].concat(n.call(arguments)))}),this._setObservers.set("itemsWereRemoved",function(){return t.fire.apply(t,["itemsWereRemoved"].concat(n.call(arguments)))}),this.on("itemsWereAdded",this.startObservingItems.bind(this)),this.on("itemsWereRemoved",this.stopObservingItems.bind(this))}return t(r,e),r.prototype.observedItemKeys=[],r.prototype.observerForItemAndKey=function(e,t){},r.prototype._getOrSetObserverForItemAndKey=function(e,t){var n=this;return this._itemObservers.getOrSet(e,function(){var r;return r=new Batman.SimpleHash,r.getOrSet(t,function(){return n.observerForItemAndKey(e,t)})})},r.prototype.startObserving=function(){return this._manageItemObservers("observe"),this._manageSetObservers("addHandler"
)},r.prototype.stopObserving=function(){return this._manageItemObservers("forget"),this._manageSetObservers("removeHandler")},r.prototype.startObservingItems=function(){var e,t,r,i,s;t=1<=arguments.length?n.call(arguments,0):[],s=[];for(r=0,i=t.length;r<i;r++)e=t[r],s.push(this._manageObserversForItem(e,"observe"));return s},r.prototype.stopObservingItems=function(){var e,t,r,i,s;t=1<=arguments.length?n.call(arguments,0):[],s=[];for(r=0,i=t.length;r<i;r++)e=t[r],s.push(this._manageObserversForItem(e,"forget"));return s},r.prototype._manageObserversForItem=function(e,t){var n,r,i,s;if(!e.isObservable)return;s=this.observedItemKeys;for(r=0,i=s.length;r<i;r++)n=s[r],e[t](n,this._getOrSetObserverForItemAndKey(e,n));if(t==="forget")return this._itemObservers.unset(e)},r.prototype._manageItemObservers=function(e){var t=this;return this.base.forEach(function(n){return t._manageObserversForItem(n,e)})},r.prototype._manageSetObservers=function(e){var t=this;if(!this.base.isObservable)return;return this._setObservers.forEach(function(n,r){return t.base.event(n)[e](r)})},r}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.SetSort=function(e){function n(e,t,r){var i;this.key=t,r==null&&(r="asc"),n.__super__.constructor.call(this,e),this.descending=r.toLowerCase()==="desc",this.base.isObservable&&(this._setObserver=new Batman.SetObserver(this.base),this._setObserver.observedItemKeys=[this.key],i=this._reIndex.bind(this),this._setObserver.observerForItemAndKey=function(){return i},this._setObserver.on("itemsWereAdded",i),this._setObserver.on("itemsWereRemoved",i),this.startObserving()),this._reIndex()}return t(n,e),n.prototype.startObserving=function(){var e;return(e=this._setObserver)!=null?e.startObserving():void 0},n.prototype.stopObserving=function(){var e;return(e=this._setObserver)!=null?e.stopObserving():void 0},n.prototype.toArray=function(){return this.get("_storage")},n.prototype.forEach=function(e,t){var n,r,i,s,o,u;o=this.get("_storage"),u=[];for(r=i=0,s=o.length;i<s;r=++i)n=o[r],u.push(e.call(t,n,r,this));return u},n.prototype.compare=function(e,t){return e===t?0:e===void 0?1:t===void 0?-1:e===null?1:t===null?-1:e===!1?1:t===!1?-1:e===!0?1:t===!0?-1:e!==e?t!==t?0:1:t!==t?-1:e>t?1:e<t?-1:0},n.prototype._reIndex=function(){var e,t,n=this;return e=this.base.toArray().sort(function(e,t){var r,i,s;return i=Batman.get(e,n.key),typeof i=="function"&&(i=i.call(e)),i!=null&&(i=i.valueOf()),s=Batman.get(t,n.key),typeof s=="function"&&(s=s.call(t)),s!=null&&(s=s.valueOf()),r=n.descending?-1:1,n.compare.call(n,i,s)*r}),(t=this._setObserver)!=null&&t.startObservingItems.apply(t,e),this.set("_storage",e)},n}(Batman.SetProxy)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.AssociationSet=function(e){function n(e,t){var r;this.foreignKeyValue=e,this.association=t,r=new Batman.Set,n.__super__.constructor.call(this,r,"_batmanID")}return t(n,e),n.prototype.loaded=!1,n.prototype.load=function(e){var t=this;return this.foreignKeyValue==null?e(void 0,this):this.association.getRelatedModel().load(this._getLoadOptions(),function(n,r){return n||t.markAsLoaded(),e(n,t)})},n.prototype._getLoadOptions=function(){var e;return e={},e[this.association.foreignKey]=this.foreignKeyValue,e},n.accessor("loaded",Batman.Property.defaultAccessor),n.prototype.markAsLoaded=function(){return this.set("loaded",!0),this.fire("loaded")},n}(Batman.SetSort)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicAssociationSet=function(e){function n(e,t,r){this.foreignKeyValue=e,this.foreignTypeKeyValue=t,this.association=r,n.__super__.constructor.call(this,this.foreignKeyValue,this.association)}return t(n,e),n.prototype._getLoadOptions=function(){var e;return e={},e[this.association.foreignKey]=this.foreignKeyValue,e[this.association.foreignTypeKey]=this.foreignTypeKeyValue,e},n}(Batman.AssociationSet)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.SetIndex=function(e){function r(e,t){var i=this;this.base=e,this.key=t,r.__super__.constructor.call(this),this._storage=new Batman.Hash,this.base.isEventEmitter&&(this._setObserver=new Batman.SetObserver(this.base),this._setObserver.observedItemKeys=[this.key],this._setObserver.observerForItemAndKey=this.observerForItemAndKey.bind(this),this._setObserver.on("itemsWereAdded",function(){var e,t,r,s,o;t=1<=arguments.length?n.call(arguments,0):[],o=[];for(r=0,s=t.length;r<s;r++)e=t[r],o.push(i._addItem(e));return o}),this._setObserver.on("itemsWereRemoved",function(){var e,t,r,s,o;t=1<=arguments.length?n.call(arguments,0):[],o=[];for(r=0,s=t.length;r<s;r++)e=t[r],o.push(i._removeItem(e));return o})),this.base.forEach(this._addItem.bind(this)),this.startObserving()}return t(r,e),r.accessor("toArray",function(){return this.toArray()}),Batman.extend(r.prototype,Batman.Enumerable),r.prototype.propertyClass=Batman.Property,r.accessor(function(e){return this._resultSetForKey(e)}),r.prototype.startObserving=function(){var e;return(e=this._setObserver)!=null?e.startObserving():void 0},r.prototype.stopObserving=function(){var e;return(e=this._setObserver)!=null?e.stopObserving():void 0},r.prototype.observerForItemAndKey=function(e,t){var n=this;return function(t,r){return n._removeItemFromKey(e,r),n._addItemToKey(e,t)}},r.prototype.forEach=function(e,t){var n=this;return this._storage.forEach(function(r,i){if(i.get("length")>0)return e.call(t,r,i,n)})},r.prototype.toArray=function(){var e;return e=[],this._storage.forEach(function(t,n){if(n.get("length")>0)return e.push(t)}),e},r.prototype._addItem=function(e){return this._addItemToKey(e,this._keyForItem(e))},r.prototype._addItemToKey=function(e,t){return this._resultSetForKey(t).add(e)},r.prototype._removeItem=function(e){return this._removeItemFromKey(e,this._keyForItem(e))},r.prototype._removeItemFromKey=function(e,t){return this._resultSetForKey(t).remove(e)},r.prototype._resultSetForKey=function(e){return this._storage.getOrSet(e,function(){return new Batman.Set})},r.prototype._keyForItem=function(e){return Batman.Keypath.forBaseAndKey(e,this.key).getValue()},r}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicAssociationSetIndex=function(e){function n(e,t,r){this.association=e,this.type=t,n.__super__.constructor.call(this,this.association.getRelatedModelForType(t).get("loaded"),r)}return t(n,e),n.prototype._resultSetForKey=function(e){var t=this;return this._storage.getOrSet(e,function(){return new t.association.proxyClass(e,t.type,t.association)})},n}(Batman.SetIndex)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.AssociationSetIndex=function(e){function n(e,t){this.association=e,n.__super__.constructor.call(this,this.association.getRelatedModel().get("loaded"),t)}return t(n,e),n.prototype._resultSetForKey=function(e){return this.association.setForKey(e)},n.prototype.forEach=function(e,t){var n=this;return this.association.proxies.forEach(function(r,i){var s;s=n.association.indexValueForRecord(r);if(i.get("length")>0)return e.call(t,s,i,n)})},n.prototype.toArray=function(){var e;return e=[],this.forEach(function(t){return e.push(t)}),e},n}(Batman.SetIndex)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.UniqueSetIndex=function(e){function n(){this._uniqueIndex=new Batman.Hash,n.__super__.constructor.apply(this,arguments)}return t(n,e),n.accessor(function(e){return this._uniqueIndex.get(e)}),n.prototype._addItemToKey=function(e,t){this._resultSetForKey(t).add(e);if(!this._uniqueIndex.hasKey(t))return this._uniqueIndex.set(t,e)},n.prototype._removeItemFromKey=function(e,t){var r;return r=this._resultSetForKey(t),n.__super__._removeItemFromKey.apply(this,arguments),r.isEmpty()?this._uniqueIndex.unset(t):this._uniqueIndex.set(t,r.toArray()[0])},n}(Batman.SetIndex)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.UniqueAssociationSetIndex=function(e){function n(e,t){this.association=e,n.__super__.constructor.call(this,this.association.getRelatedModel().get("loaded"),t)}return t(n,e),n}(Batman.UniqueSetIndex)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicUniqueAssociationSetIndex=function(e){function n(e,t,r){this.association=e,this.type=t,n.__super__.constructor.call(this,this.association.getRelatedModelForType(t).get("loaded"),r)}return t(n,e),n}(Batman.UniqueSetIndex)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=[].slice;Batman.Navigator=function(){function n(t){this.app=t,this.handleCurrentLocation=e(this.handleCurrentLocation,this)}return n.defaultClass=function(){return Batman.config.usePushState&&Batman.PushStateNavigator.isSupported()?Batman.PushStateNavigator:Batman.HashbangNavigator},n.forApp=function(e){return new(this.defaultClass())(e)},n.prototype.start=function(){var e=this;if(typeof window=="undefined")return;if(this.started)return;return this.started=!0,this.startWatching(),Batman.currentApp.prevent("ready"),Batman.setImmediate(function(){if(e.started&&Batman.currentApp)return e.handleCurrentLocation(),Batman.currentApp.allowAndFire("ready")})},n.prototype.stop=function(){return this.stopWatching(),this.started=!1},n.prototype.handleLocation=function(e){var t;t=this.pathFromLocation(e);if(t===this.cachedPath)return;return this.dispatch(t)},n.prototype.handleCurrentLocation=function(){return this.handleLocation(window.location)},n.prototype.dispatch=function(e){return this.cachedPath=this.app.get("dispatcher").dispatch(e),this._lastRedirect&&(this.cachedPath=this._lastRedirect),this.cachedPath},n.prototype.push=function(e){var t,n,r;return n=typeof (r=this.app.get("dispatcher")).pathFromParams=="function"?r.pathFromParams(e):void 0,n&&(this._lastRedirect=n),t=this.dispatch(e),(!this._lastRedirect||this._lastRedirect===t)&&this.pushState(null,"",t),t},n.prototype.replace=function(e){var t,n,r;return n=typeof (r=this.app.get("dispatcher")).pathFromParams=="function"?r.pathFromParams(e):void 0,n&&(this._lastRedirect=n),t=this.dispatch(e),(!this._lastRedirect||this._lastRedirect===t)&&this.replaceState(null,"",t),t},n.prototype.redirect=n.prototype.push,n.prototype.normalizePath=function(){var e,n,r;return r=1<=arguments.length?t.call(arguments,0):[],r=function(){var t,s,o;o=[];for(e=t=0,s=r.length;t<s;e=++t)n=r[e],o.push((""+n).replace(/^(?!\/)/,"/").replace(/\/+$/,""));return o}(),r.join("")||"/"},n.normalizePath=n.prototype.normalizePath,n}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PushStateNavigator=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.isSupported=function(){var e;return(typeof window!=="undefined"&&window!==null?(e=window.history)!=null?e.pushState:void 0:void 0)!=null},n.prototype.startWatching=function(){return Batman.DOM.addEventListener(window,"popstate",this.handleCurrentLocation)},n.prototype.stopWatching=function(){return Batman.DOM.removeEventListener(window,"popstate",this.handleCurrentLocation)},n.prototype.pushState=function(e,t,n){return window.history.pushState(e,t,this.linkTo(n))},n.prototype.replaceState=function(e,t,n){return window.history.replaceState(e,t,this.linkTo(n))},n.prototype.linkTo=function(e){return this.normalizePath(Batman.config.pathPrefix,e)},n.prototype.pathFromLocation=function(e){var t,n;return t=""+(e.pathname||"")+(e.search||""),n=new RegExp("^"+this.normalizePath(Batman.config.pathPrefix)),this.normalizePath(t.replace(n,""))},n.prototype.handleLocation=function(e){var t,r;return r=this.pathFromLocation(e),r==="/"&&(t=Batman.HashbangNavigator.prototype.pathFromLocation(e))!=="/"?this.replace(t):n.__super__.handleLocation.apply(this,arguments)},n}(Batman.Navigator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.HashbangNavigator=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.HASH_PREFIX="#!",typeof window!="undefined"&&window!==null&&"onhashchange"in window?(n.prototype.startWatching=function(){return Batman.DOM.addEventListener(window,"hashchange",this.handleCurrentLocation)},n.prototype.stopWatching=function(){return Batman.DOM.removeEventListener(window,"hashchange",this.handleCurrentLocation)}):(n.prototype.startWatching=function(){return this.interval=setInterval(this.handleCurrentLocation,100)},n.prototype.stopWatching=function(){return this.interval=clearInterval(this.interval)}),n.prototype.pushState=function(e,t,n){return window.location.hash=this.linkTo(n)},n.prototype.replaceState=function(e,t,n){var r;return r=window.location,r.replace(""+r.pathname+r.search+this.linkTo(n))},n.prototype.linkTo=function(e){return this.HASH_PREFIX+e},n.prototype.pathFromLocation=function(e){var t;return t=e.hash,(t!=null?t.substr(0,2):void 0)===this.HASH_PREFIX?this.normalizePath(t.substr(2)):"/"},n.prototype.handleLocation=function(e){var t;return Batman.config.usePushState?(t=Batman.PushStateNavigator.prototype.pathFromLocation(e),t==="/"?n.__super__.handleLocation.apply(this,arguments):e.replace(this.normalizePath(""+Batman.config.pathPrefix+this.linkTo(t)))):n.__super__.handleLocation.apply(this,arguments)},n}(Batman.Navigator)}.call(this),function(){Batman.RouteMap=function(){function e(){this.childrenByOrder=[],this.childrenByName={}}return e.prototype.memberRoute=null,e.prototype.collectionRoute=null,e.prototype.routeForParams=function(e){var t,n,r,i;i=this.childrenByOrder;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.test(e))return t}return void 0},e.prototype.addRoute=function(e,t){var n,r,i=this;return this.childrenByOrder.push(t),e.length>0&&(r=e.split(".")).length>0?(n=r.shift(),this.childrenByName[n]||(this.childrenByName[n]=new Batman.RouteMap),this.childrenByName[n].addRoute(r.join("."),t)):t.get("member")?(Batman.developer["do"](function(){if(i.memberRoute)return Batman.developer.error("Member route with name "+e+" already exists!")}),this.memberRoute=t):(Batman.developer["do"](function(){if(i.collectionRoute)return Batman.developer.error("Collection route with name "+e+" already exists!")}),this.collectionRoute=t),!0},e}()}.call(this),function(){var e=[].slice;Batman.RouteMapBuilder=function(){function t(e,t,n,r){this.app=e,this.routeMap=t,this.parent=n,this.baseOptions=r!=null?r:{},this.parent?(this.rootPath=this.parent._nestingPath(),this.rootName=this.parent._nestingName()):(this.rootPath="",this.rootName="")}return t.BUILDER_FUNCTIONS=["resources","member","collection","route","root"],t.ROUTES={index:{cardinality:"collection",path:function(e){return e},name:function(e){return e}},"new":{cardinality:"collection",path:function(e){return""+e+"/new"},name:function(e){return""+e+".new"}},show:{cardinality:"member",path:function(e){return""+e+"/:id"},name:function(e){return e}},edit:{cardinality:"member",path:function(e){return""+e+"/:id/edit"},name:function(e){return""+e+".edit"}},collection:{cardinality:"collection",path:function(e,t){return""+e+"/"+t},name:function(e,t){return""+e+"."+t}},member:{cardinality:"member",path:function(e,t){return""+e+"/:id/"+t},name:function(e,t){return""+e+"."+t}}},t.prototype.resources=function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C;i=1<=arguments.length?e.call(arguments,0):[],d=function(){var e,t,n;n=[];for(e=0,t=i.length;e<t;e++)r=i[e],typeof r=="string"&&n.push(r);return n}(),typeof i[i.length-1]=="function"&&(o=i.pop()),typeof i[i.length-1]=="object"?c=i.pop():c={},n={index:!0,"new":!0,show:!0,edit:!0};if(c.except){N=c.except;for(b=0,S=N.length;b<S;b++)l=N[b],n[l]=!1;delete c.except}else if(c.only){for(l in n)y=n[l],n[l]=!1;C=c.only;for(w=0,x=C.length;w<x;w++)l=C[w],n[l]=!0;delete c.only}for(E=0,T=d.length;E<T;E++){p=d[E],v=Batman.helpers.pluralize(p),a=Batman.helpers.camelize(v,!0),u=this._childBuilder({controller:a}),o!=null&&o.call(u);for(t in n){f=n[t];if(!f)continue;g=this.constructor.ROUTES[t],s=g.name(v),h=g.path(v),m=Batman.extend({controller:a,action:t,path:h,as:s},c),u[g.cardinality](t,m)}}return!0},t.prototype.member=function(){return this._addRoutesWithCardinality.apply(this,["member"].concat(e.call(arguments)))},t.prototype.collection=function(){return this._addRoutesWithCardinality.apply(this,["collection"].concat(e.call(arguments)))},t.prototype.root=function(e,t){return this.route("/",e,t)},t.prototype.route=function(e,t,n,r){return r||(typeof n=="function"?(r=n,n=void 0):typeof t=="function"&&(r=t,t=void 0)),n?t&&(n.signature=t):(typeof t=="string"?n={signature:t}:n=t,n||(n={})),r&&(n.callback=r),n.as||(n.as=this._nameFromPath(e)),n.path=e,this._addRoute(n)},t.prototype._addRoutesWithCardinality=function(){var t,n,r,i,s,o,u,a,f,l;t=arguments[0],r=3<=arguments.length?e.call(arguments,1,a=arguments.length-1):(a=1,[]),i=arguments[a++],typeof i=="string"&&(r.push(i),i={}),i=Batman.extend({},this.baseOptions,i),i[t]=!0,u=this.constructor.ROUTES[t],s=Batman.helpers.underscore(i.controller);for(f=0,l=r.length;f<l;f++)n=r[f],o=Batman.extend({action:n},i),o.path==null&&(o.path=u.path(s,n)),o.as==null&&(o.as=u.name(s,n)),this._addRoute(o);return!0},t.prototype._addRoute=function(e){var t,n,r,i;return e==null&&(e={}),r=this.rootPath+e.path,n=this.rootName+Batman.helpers.camelize(e.as,!0),delete e.as,delete e.path,t=e.callback?Batman.CallbackActionRoute:Batman.ControllerActionRoute,e.app=this.app,i=new t(r,e),this.routeMap.addRoute(n,i)},t.prototype._nameFromPath=function(e){return e=e.replace(Batman.Route.regexps.namedOrSplat,"").replace(/\/+/g,".").replace(/(^\.)|(\.$)/g,""),e},t.prototype._nestingPath=function(){var e,t;return this.parent?(e=":"+Batman.helpers.singularize(this.baseOptions.controller)+"Id",t=Batman.helpers.underscore(this.baseOptions.controller),""+this.parent._nestingPath()+"/"+t+"/"+e+"/"):""},t.prototype._nestingName=function(){return this.parent?this.baseOptions.controller+".":""},t.prototype._childBuilder=function(e){return e==null&&(e={}),new Batman.RouteMapBuilder(this.app,this.routeMap,this,e)},t}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.App=function(e){function f(){return f.__super__.constructor.apply(this,arguments)}var r,i,s,o,u,a=this;t(f,e),f.classAccessor("currentParams",{get:function(){return new Batman.Hash},"final":!0}),f.classAccessor("paramsManager",{get:function(){var e,t;if(!(e=this.get("navigator")))return;return t=this.get("currentParams"),t.replacer=new Batman.ParamsReplacer(e,t)},"final":!0}),f.classAccessor("paramsPusher",{get:function(){var e,t;if(!(e=this.get("navigator")))return;return t=this.get("currentParams"),t.pusher=new Batman.ParamsPusher(e,t)},"final":!0}),f.classAccessor("routes",function(){return new Batman.NamedRouteQuery(this.get("routeMap"))}),f.classAccessor("routeMap",function(){return new Batman.RouteMap}),f.classAccessor("routeMapBuilder",function(){return new Batman.RouteMapBuilder(this,this.get("routeMap"))}),f.classAccessor("dispatcher",function(){return new Batman.Dispatcher(this,this.get("routeMap"))}),f.classAccessor("controllers",function(){return this.get("dispatcher.controllers")}),f.classAccessor("_renderContext",function(){return Batman.RenderContext.base.descend(this)}),f.requirePath="",Batman.developer["do"](function(){return f.require=function(){var e,t,r,i,s,o,u=this;i=arguments[0],r=2<=arguments.length?n.call(arguments,1):[],e=this.requirePath+i;for(s=0,o=r.length;s<o;s++)t=r[s],this.prevent("run"),i=e+"/"+t+".coffee",new Batman.Request({url:i,type:"html",success:function(e){CoffeeScript.eval(e),u.allow("run"),u.isPrevented("run")||u.fire("loaded");if(u.wantsToRun)return u.run()}});return this},f.controller=function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],e=e.map(function(e){return e+"_controller"}),this.require.apply(this,["controllers"].concat(n.call(e)))},f.model=function(){return this.require.apply(this,["models"].concat(n.call(arguments)))},f.view=function(){return this.require.apply(this,["views"].concat(n.call(arguments)))}}),f.layout=void 0,u=Batman.RouteMapBuilder.BUILDER_FUNCTIONS,i=function(e){return f[e]=function(){var t;return(t=this.get("routeMapBuilder"))[e].apply(t,arguments)}};for(s=0,o=u.length;s<o;s++)r=u[s],i(r);return f.event("ready").oneShot=!0,f.event("run").oneShot=!0,f.run=function(){var e,t,n=this;if(Batman.currentApp){if(Batman.currentApp===this)return;Batman.currentApp.stop()}return this.hasRun?!1:this.isPrevented("run")?(this.wantsToRun=!0,!1):(delete this.wantsToRun,Batman.currentApp=this,Batman.App.set("current",this),this.get("dispatcher")==null&&(this.set("dispatcher",new Batman.Dispatcher(this,this.get("routeMap"))),this.set("controllers",this.get("dispatcher.controllers"))),this.get("navigator")==null&&(this.set("navigator",Batman.Navigator.forApp(this)),this.on("run",function(){Batman.navigator=n.get("navigator");if(Object.keys(n.get("dispatcher").routeMap).length>0)return Batman.navigator.start()})),this.observe("layout",function(e){return e!=null?e.on("ready",function(){return n.fire("ready")}):void 0}),e=this.get("layout"),e?typeof e=="string"&&(t=this[Batman.helpers.camelize(e)+"View"]):e!==null&&(t=Batman.View),t&&(e=this.set("layout",new t({context:this,node:document}))),this.hasRun=!0,this.fire("run"),this)},f.event("ready").oneShot=!0,f.event("stop").oneShot=!0,f.stop=function(){var e;return(e=this.navigator)!=null&&e.stop(),Batman.navigator=null,this.hasRun=!1,this.fire("stop"),this},f}.call(this,Batman.Object)}.call(this),function(){Batman.Association=function(){function e(e,t,n){var r,i,s,o;this.model=e,this.label=t,n==null&&(n={}),r={namespace:Batman.currentApp,name:Batman.helpers.camelize(Batman.helpers.singularize(this.label))},this.options=Batman.extend(r,this.defaultOptions,n),this.options.nestUrl&&(this.model.urlNestsUnder==null&&developer.error("You must persist the the model "+this.model.constructor.name+" to use the url helpers on an association"),this.model.urlNestsUnder(Batman.helpers.underscore(this.getRelatedModel().get("resourceName")))),this.options.extend!=null&&Batman.extend(this,this.options.extend),i={encode:this.options.saveInline?this.encoder():!1,decode:this.decoder()},this.model.encode(this.label,i),o=this,s=function(){return o.getAccessor.call(this,o,this.model,this.label)},this.model.accessor(this.label,{get:s,set:e.defaultAccessor.set,unset:e.defaultAccessor.unset})}return e.prototype.associationType="",e.prototype.isPolymorphic=!1,e.prototype.defaultOptions={saveInline:!0,autoload:!0,nestUrl:!1},e.prototype.getRelatedModel=function(){var e,t,n;return n=this.options.namespace||Batman.currentApp,e=this.options.name,t=n!=null?n[e]:void 0,Batman.developer["do"](function(){if(Batman.currentApp!=null&&!t)return Batman.developer.warn("Related model "+e+" hasn't loaded yet.")}),t},e.prototype.getFromAttributes=function(e){return e.get("attributes."+this.label)},e.prototype.setIntoAttributes=function(e,t){return e.get("attributes").set(this.label,t)},e.prototype.inverse=function(){var e,t,n=this;if(t=this.getRelatedModel()._batman.get("associations"))return this.options.inverseOf?t.getByLabel(this.options.inverseOf):(e=null,t.forEach(function(t,r){if(r.getRelatedModel()===n.model)return e=r}),e)},e.prototype.reset=function(){return delete this.index,!0},e}()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PluralAssociation=function(e){function n(){n.__super__.constructor.apply(this,arguments),this._resetSetHashes()}return t(n,e),n.prototype.proxyClass=Batman.AssociationSet,n.prototype.isSingular=!1,n.prototype.setForRecord=function(e){var t,n,r=this;return n=this.indexValueForRecord(e),t=this.setIndex(),Batman.Property.withoutTracking(function(){return r._setsByRecord.getOrSet(e,function(){var e,t;if(n!=null){e=r._setsByValue.get(n);if(e!=null)return e}return t=new r.proxyClass(n,r),n!=null&&r._setsByValue.set(n,t),t})}),n!=null?t.get(n):this._setsByRecord.get(e)},n.prototype.setForKey=Batman.Property.wrapTrackingPrevention(function(e){var t,n=this;return t=void 0,this._setsByRecord.forEach(function(r,i){if(t!=null)return;if(n.indexValueForRecord(r)===e)return t=i}),t!=null?(t.foreignKeyValue=e,t):this._setsByValue.getOrSet(e,function(){return new n.proxyClass(e,n)})}),n.prototype.getAccessor=function(e,t,n){var r,i,s=this;if(!e.getRelatedModel())return;return(i=e.getFromAttributes(this))?i:(r=e.setForRecord(this),e.setIntoAttributes(this,r),Batman.Property.withoutTracking(function(){if(e.options.autoload&&!s.isNew()&&!r.loaded)return r.load(function(e,t){if(e)throw e})}),r)},n.prototype.setIndex=function(){return this.index||(this.index=new Batman.AssociationSetIndex(this,this[this.indexRelatedModelOn])),this.index},n.prototype.indexValueForRecord=function(e){return e.get(this.primaryKey)},n.prototype.reset=function(){return n.__super__.reset.apply(this,arguments),this._resetSetHashes()},n.prototype._resetSetHashes=function(){return this._setsByRecord=new Batman.SimpleHash,this._setsByValue=new Batman.SimpleHash},n}(Batman.Association)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.HasManyAssociation=function(e){function n(e,t,r){if(r!=null?r.as:void 0)return function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.PolymorphicHasManyAssociation,arguments,function(){});n.__super__.constructor.apply(this,arguments),this.primaryKey=this.options.primaryKey||"id",this.foreignKey=this.options.foreignKey||""+Batman.helpers.underscore(e.get("resourceName"))+"_id"}return t(n,e),n.prototype.associationType="hasMany",n.prototype.indexRelatedModelOn="foreignKey",n.prototype.apply=function(e,t){var n,r,i=this;if(!e){(n=this.getFromAttributes(t))&&n.forEach(function(e){return e.set(i.foreignKey,t.get(i.primaryKey))}),t.set(this.label,r=this.setForRecord(t));if(t.lifecycle.get("state")==="creating")return r.markAsLoaded()}},n.prototype.encoder=function(){var e;return e=this,function(t,n,r,i){var s;return t!=null&&(s=[],t.forEach(function(t){var n;n=t.toJSON();if(!e.inverse()||e.inverse().options.encodeForeignKey)n[e.foreignKey]=i.get(e.primaryKey);return s.push(n)})),s}},n.prototype.decoder=function(){var e;return e=this,function(t,n,r,i,s){var o,u,a,f,l,c,h,p,d;if(c=e.getRelatedModel()){u=e.getFromAttributes(s)||e.setForRecord(s),f=u.filter(function(e){return e.isNew()}).toArray();for(p=0,d=t.length;p<d;p++)a=t[p],l=new c,l._withoutDirtyTracking(function(){return this.fromJSON(a)}),o=c.get("loaded").indexedByUnique("id").get(l.get("id")),o!=null?(o._withoutDirtyTracking(function(){return this.fromJSON(a)}),l=o):f.length>0&&(h=f.shift(),h._withoutDirtyTracking(function(){return this.fromJSON(a)}),l=h),l=c._mapIdentity(l),u.add(l),e.options.inverseOf&&l.set(e.options.inverseOf,s);u.markAsLoaded()}else Batman.developer.error("Can't decode model "+e.options.name+" because it hasn't been loaded yet!");return u}},n}(Batman.PluralAssociation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicHasManyAssociation=function(e){function n(e,t,r){r.inverseOf=this.foreignLabel=r.as,delete r.as,r.foreignKey||(r.foreignKey=""+this.foreignLabel+"_id"),n.__super__.constructor.call(this,e,t,r),this.foreignTypeKey=r.foreignTypeKey||""+this.foreignLabel+"_type",this.model.encode(this.foreignTypeKey)}return t(n,e),n.prototype.proxyClass=Batman.PolymorphicAssociationSet,n.prototype.isPolymorphic=!0,n.prototype.apply=function(e,t){var r,i=this;return!e&&(r=this.getFromAttributes(t))&&(n.__super__.apply.apply(this,arguments),r.forEach(function(e){return e.set(i.foreignTypeKey,i.modelType())})),!0},n.prototype.getRelatedModelForType=function(){return this.getRelatedModel()},n.prototype.modelType=function(){return this.model.get("resourceName")},n.prototype.setIndex=function(){return this.typeIndex||(this.typeIndex=new Batman.PolymorphicAssociationSetIndex(this,this.modelType(),this[this.indexRelatedModelOn])),this.typeIndex},n.prototype.encoder=function(){var e;return e=this,function(t,n,r,i){var s;return t!=null&&(s=[],t.forEach(function(t){var n;return n=t.toJSON(),n[e.foreignKey]=i.get(e.primaryKey),n[e.foreignTypeKey]=e.modelType(),s.push(n)})),s}},n}(Batman.HasManyAssociation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.SingularAssociation=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.isSingular=!0,n.prototype.getAccessor=function(e,t,n){var r,i,s,o,u;if(o=e.getFromAttributes(this))return o;if(e.getRelatedModel())return i=this.associationProxy(e),s=!1,r=this,(u=i._loadSetter)==null&&(i._loadSetter=i.once("loaded",function(t){return r._withoutDirtyTracking(function(){return this.set(e.label,t)})})),Batman.Property.withoutTracking(function(){return i.get("loaded")})||(e.options.autoload?Batman.Property.withoutTracking(function(){return i.load()}):s=i.loadFromLocal()),s||i},n.prototype.setIndex=function(){return this.index||(this.index=new Batman.UniqueAssociationSetIndex(this,this[this.indexRelatedModelOn])),this.index},n}(Batman.Association)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.HasOneAssociation=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.primaryKey=this.options.primaryKey||"id",this.foreignKey=this.options.foreignKey||""+Batman.helpers.underscore(this.model.get("resourceName"))+"_id"}return t(n,e),n.prototype.associationType="hasOne",n.prototype.proxyClass=Batman.HasOneProxy,n.prototype.indexRelatedModelOn="foreignKey",n.prototype.apply=function(e,t){var n;if(n=this.getFromAttributes(t))return n.set(this.foreignKey,t.get(this.primaryKey))},n.prototype.encoder=function(){var e;return e=this,function(t,n,r,i){var s;if(!e.options.saveInline)return;if(s=t.toJSON())s[e.foreignKey]=i.get(e.primaryKey);return s}},n.prototype.decoder=function(){var e;return e=this,function(t,n,r,i,s){var o,u;if(!t)return;return u=e.getRelatedModel(),o=u.createFromJSON(t),e.options.inverseOf&&o.set(e.options.inverseOf,s),o}},n}(Batman.SingularAssociation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.BelongsToAssociation=function(e){function n
(e,t,r){if(r!=null?r.polymorphic:void 0)return delete r.polymorphic,function(e,t,n){n.prototype=e.prototype;var r=new n,i=e.apply(r,t),s=typeof i;return s=="object"||s=="function"?i||r:r}(Batman.PolymorphicBelongsToAssociation,arguments,function(){});n.__super__.constructor.apply(this,arguments),this.foreignKey=this.options.foreignKey||""+this.label+"_id",this.primaryKey=this.options.primaryKey||"id",this.options.encodeForeignKey&&this.model.encode(this.foreignKey)}return t(n,e),n.prototype.associationType="belongsTo",n.prototype.proxyClass=Batman.BelongsToProxy,n.prototype.indexRelatedModelOn="primaryKey",n.prototype.defaultOptions={saveInline:!1,autoload:!0,encodeForeignKey:!0},n.prototype.encoder=function(){return function(e){return e.toJSON()}},n.prototype.decoder=function(){var e;return e=this,function(t,n,r,i,s){var o,u,a;return a=e.getRelatedModel(),u=a.createFromJSON(t),e.options.inverseOf&&(o=e.inverse())&&(o instanceof Batman.HasManyAssociation?s.set(e.foreignKey,u.get(e.primaryKey)):u.set(o.label,s)),s.set(e.label,u),u}},n.prototype.apply=function(e){var t,n;if(n=e.get(this.label)){t=n.get(this.primaryKey);if(t!==void 0)return e.set(this.foreignKey,t)}},n}(Batman.SingularAssociation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PolymorphicBelongsToAssociation=function(e){function n(){n.__super__.constructor.apply(this,arguments),this.foreignTypeKey=this.options.foreignTypeKey||""+this.label+"_type",this.options.encodeForeignTypeKey&&this.model.encode(this.foreignTypeKey),this.typeIndicies={}}return t(n,e),n.prototype.isPolymorphic=!0,n.prototype.proxyClass=Batman.PolymorphicBelongsToProxy,n.prototype.defaultOptions=Batman.mixin({},Batman.BelongsToAssociation.prototype.defaultOptions,{encodeForeignTypeKey:!0}),n.prototype.getRelatedModel=!1,n.prototype.setIndex=!1,n.prototype.inverse=!1,n.prototype.apply=function(e){var t,r,i;n.__super__.apply.apply(this,arguments);if(r=e.get(this.label))return r instanceof Batman.AssociationProxy?i=r.association.model:i=r.constructor,t=i.get("resourceName"),e.set(this.foreignTypeKey,t)},n.prototype.getAccessor=function(e,t,n){var r,i;if(i=e.getFromAttributes(this))return i;if(e.getRelatedModelForType(this.get(e.foreignTypeKey)))return r=this.associationProxy(e),Batman.Property.withoutTracking(function(){if(!r.get("loaded")&&e.options.autoload)return r.load()}),r},n.prototype.url=function(e){var t,n,r,i,s,o,u,a;o=(u=e.data)!=null?u[this.foreignTypeKey]:void 0;if(o&&(i=this.inverseForType(o)))return s=Batman.helpers.pluralize(o).toLowerCase(),r=(a=e.data)!=null?a[this.foreignKey]:void 0,n=i.isSingular?"singularize":"pluralize",t=Batman.helpers[n](i.label),"/"+s+"/"+r+"/"+t},n.prototype.getRelatedModelForType=function(e){var t,n;return n=this.options.namespace||Batman.currentApp,e&&(t=n!=null?n[e]:void 0,t||(t=n!=null?n[Batman.helpers.camelize(e)]:void 0)),Batman.developer["do"](function(){if(Batman.currentApp!=null&&!t)return Batman.developer.warn("Related model "+e+" for polymorphic association not found.")}),t},n.prototype.setIndexForType=function(e){var t;return(t=this.typeIndicies)[e]||(t[e]=new Batman.PolymorphicUniqueAssociationSetIndex(this,e,this.primaryKey)),this.typeIndicies[e]},n.prototype.inverseForType=function(e){var t,n,r,i=this;if(n=(r=this.getRelatedModelForType(e))!=null?r._batman.get("associations"):void 0)return this.options.inverseOf?n.getByLabel(this.options.inverseOf):(t=null,n.forEach(function(e,n){if(n.getRelatedModel()===i.model)return t=n}),t)},n.prototype.decoder=function(){var e;return e=this,function(t,n,r,i,s){var o,u,a,f;return o=r[e.foreignTypeKey]||s.get(e.foreignTypeKey),f=e.getRelatedModelForType(o),a=f.createFromJSON(t),e.options.inverseOf&&(u=e.inverseForType(o))&&(u instanceof Batman.PolymorphicHasManyAssociation?(s.set(e.foreignKey,a.get(e.primaryKey)),s.set(e.foreignTypeKey,o)):a.set(u.label,s)),s.set(e.label,a),a}},n}(Batman.BelongsToAssociation)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.Validator=function(e){function r(){var e,t;t=arguments[0],e=2<=arguments.length?n.call(arguments,1):[],this.options=t,r.__super__.constructor.apply(this,e)}return t(r,e),r.triggers=function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],this._triggers!=null?this._triggers.concat(e):this._triggers=e},r.options=function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],this._options!=null?this._options.concat(e):this._options=e},r.matches=function(e){var t,n,r,i,s,o;n={},r=!1;for(t in e)i=e[t],~((s=this._options)!=null?s.indexOf(t):void 0)&&(n[t]=i),~((o=this._triggers)!=null?o.indexOf(t):void 0)&&(n[t]=i,r=!0);if(r)return n},r.prototype.validate=function(e){return Batman.developer.error("You must override validate in Batman.Validator subclasses.")},r.prototype.format=function(e,t,n){return Batman.t("errors.messages."+t,n)},r.prototype.handleBlank=function(e){if(this.options.allowBlank&&!Batman.PresenceValidator.prototype.isPresent(e))return!0},r}(Batman.Object)}.call(this),function(){Batman.Validators=[],Batman.extend(Batman.translate.messages,{errors:{format:"%{attribute} %{message}",messages:{too_short:"must be at least %{count} characters",too_long:"must be less than %{count} characters",wrong_length:"must be %{count} characters",blank:"can't be blank",not_numeric:"must be a number",not_matching:"is not valid",invalid_association:"is not valid"}}})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.RegExpValidator=function(e){function n(e){var t;this.regexp=(t=e.regexp)!=null?t:e.pattern,n.__super__.constructor.apply(this,arguments)}return t(n,e),n.triggers("regexp","pattern"),n.options("allowBlank"),n.prototype.validateEach=function(e,t,n,r){var i;return i=t.get(n),this.handleBlank(i)?r():((i==null||i===""||!this.regexp.test(i))&&e.add(n,this.format(n,"not_matching")),r())},n}(Batman.Validator),Batman.Validators.push(Batman.RegExpValidator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.PresenceValidator=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.triggers("presence"),n.prototype.validateEach=function(e,t,n,r){var i;return i=t.get(n),this.isPresent(i)||e.add(n,this.format(n,"blank")),r()},n.prototype.isPresent=function(e){return e!=null&&e!==""},n}(Batman.Validator),Batman.Validators.push(Batman.PresenceValidator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.NumericValidator=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.triggers("numeric"),n.options("allowBlank"),n.prototype.validateEach=function(e,t,n,r){var i;return i=t.get(n),this.handleBlank(i)?r():((i==null||!this.isNumeric(i)&&!this.canCoerceToNumeric(i))&&e.add(n,this.format(n,"not_numeric")),r())},n.prototype.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},n.prototype.canCoerceToNumeric=function(e){return e-0==e&&e.length>0},n}(Batman.Validator),Batman.Validators.push(Batman.NumericValidator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.LengthValidator=function(e){function n(e){var t;if(t=e.lengthIn||e.lengthWithin)e.minLength=t[0],e.maxLength=t[1]||-1,delete e.lengthWithin,delete e.lengthIn;n.__super__.constructor.apply(this,arguments)}return t(n,e),n.triggers("minLength","maxLength","length","lengthWithin","lengthIn"),n.options("allowBlank"),n.prototype.validateEach=function(e,t,n,r){var i,s;return i=this.options,s=t.get(n),s!==""&&this.handleBlank(s)?r():(s==null&&(s=[]),i.minLength&&s.length<i.minLength&&e.add(n,this.format(n,"too_short",{count:i.minLength})),i.maxLength&&s.length>i.maxLength&&e.add(n,this.format(n,"too_long",{count:i.maxLength})),i.length&&s.length!==i.length&&e.add(n,this.format(n,"wrong_length",{count:i.length})),r())},n}(Batman.Validator),Batman.Validators.push(Batman.LengthValidator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.AssociatedValidator=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.triggers("associated"),n.prototype.validateEach=function(e,t,n,r){var i,s,o,u=this;return o=t.get(n),o!=null?(o instanceof Batman.AssociationProxy&&(o=typeof o.get=="function"?o.get("target"):void 0),s=1,i=function(t,i){i.length>0&&e.add(n,u.format(n,"invalid_association"));if(--s===0)return r()},(o!=null?o.forEach:void 0)!=null?o.forEach(function(e){return s+=1,e.validate(i)}):(o!=null?o.validate:void 0)!=null&&(s+=1,o.validate(i)),i(null,[])):r()},n}(Batman.Validator),Batman.Validators.push(Batman.AssociatedValidator)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ControllerActionFrame=function(e){function n(e,t){n.__super__.constructor.call(this,e),this.on("complete",t)}return t(n,e),n.prototype.operationOccurred=!1,n.prototype.remainingOperations=0,n.prototype.event("complete").oneShot=!0,n.prototype.startOperation=function(e){return e==null&&(e={}),e.internal||(this.operationOccurred=!0),this._changeOperationsCounter(1),!0},n.prototype.finishOperation=function(){return this._changeOperationsCounter(-1),!0},n.prototype.startAndFinishOperation=function(e){return this.startOperation(e),this.finishOperation(e),!0},n.prototype._changeOperationsCounter=function(e){var t;this.remainingOperations+=e,this.remainingOperations===0&&this.fire("complete"),(t=this.parentFrame)!=null&&t._changeOperationsCounter(e)},n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.DOM.InsertionBinding=function(e){function n(e,t,r,i,s,o){var u,a=this;this.invert=o!=null?o:!1,this.placeholderNode=document.createComment("detached node "+this.get("_batmanID")),u=n.__super__.constructor.apply(this,arguments),Batman.DOM.onParseExit(this.node,function(){a.bind();if(a.placeholderNode!=null)return Batman.DOM.trackBinding(a,a.placeholderNode)}),u}return t(n,e),n.prototype.isTwoWay=!1,n.prototype.bindImmediately=!1,n.prototype.dataChange=function(e){var t;t=this.placeholderNode.parentNode||this.node.parentNode;if(!!e==!this.invert){if(this.node.parentNode==null)return Batman.DOM.insertBefore(t,this.node,this.placeholderNode),t.removeChild(this.placeholderNode)}else if(this.node.parentNode!=null)return t.insertBefore(this.placeholderNode,this.node),Batman.DOM.removeNode(this.node)},n.prototype.die=function(){if(this.dead)return;return n.__super__.die.apply(this,arguments),!!this.get("filteredValue")==!this.invert?Batman.DOM.destroyNode(this.placeholderNode):Batman.DOM.destroyNode(this.node)},n}(Batman.DOM.AbstractBinding)}.call(this),function(){var e;e=function(e){var t;for(t in e)return!1;return!0},Batman.extend(Batman,{cache:{},uuid:0,expando:"batman"+Math.random().toString().replace(/\D/g,""),canDeleteExpando:function(){var e;try{return e=document.createElement("div"),delete e.test}catch(t){return Batman.canDeleteExpando=!1}}(),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(t){return t=t.nodeType?Batman.cache[t[Batman.expando]]:t[Batman.expando],!!t&&!e(t)},data:function(e,t,n,r){var i,s,o,u,a,f;if(!Batman.acceptData(e))return;u=Batman.expando,s=typeof t=="string",i=Batman.cache,o=e[Batman.expando];if((!o||r&&o&&i[o]&&!i[o][u])&&s&&n===void 0)return;o||(e.nodeType!==3?e[Batman.expando]=o=++Batman.uuid:o=Batman.expando),i[o]||(i[o]={});if(typeof t=="object"||typeof t=="function")r?i[o][u]=Batman.extend(i[o][u],t):i[o]=Batman.extend(i[o],t);return f=i[o],r&&(f[u]||(f[u]={}),f=f[u]),n!==void 0&&(f[t]=n),s?a=f[t]:a=f,a},removeData:function(t,n,r){var i,s,o,u,a,f;if(!Batman.acceptData(t))return;u=Batman.expando,a=t.nodeType,i=Batman.cache,s=t[Batman.expando];if(!i[s])return;if(n){f=r?i[s][u]:i[s];if(f){delete f[n];if(!e(f))return}}if(r){delete i[s][u];if(!e(i[s]))return}return o=i[s][u],Batman.canDeleteExpando||!i.setInterval?delete i[s]:i[s]=null,o?(i[s]={},i[s][u]=o):Batman.canDeleteExpando?delete t[Batman.expando]:t.removeAttribute?t.removeAttribute(Batman.expando):t[Batman.expando]=null},_data:function(e,t,n){return Batman.data(e,t,n,!0)},acceptData:function(e){var t;if(e.nodeName){t=Batman.noData[e.nodeName.toLowerCase()];if(t)return t!==!0&&e.getAttribute("classid")===t}return!0}})}.call(this),function(){var e,t,n=[].slice;e=function(e){return function(t){return t==null?void 0:e.apply(this,arguments)}},t=function(e,t){return e||t},Batman.Filters={raw:e(function(e,t){return t.escapeValue=!1,e}),get:e(function(e,t){return e.get!=null?e.get(t):e[t]}),equals:e(function(e,t,n){return e===t}),and:function(e,t){return e&&t},or:function(e,t,n){return e||t},not:function(e,t){return!e},trim:e(function(e,t){return e.trim()}),matches:e(function(e,t){return e.indexOf(t)!==-1}),truncate:e(function(e,t,n,r){return n==null&&(n="..."),r||(r=n,n="..."),e.length>t&&(e=e.substr(0,t-n.length)+n),e}),"default":function(e,t,n){return e!=null&&e!==""?e:t},prepend:function(e,t,n){return t+(e!=null?e:"")},append:function(e,t,n){return(e!=null?e:"")+t},replace:e(function(e,t,n,r,i){return i||(i=r,r=void 0),r===void 0?e.replace(t,n):e.replace(t,n,r)}),downcase:e(function(e){return e.toLowerCase()}),upcase:e(function(e){return e.toUpperCase()}),pluralize:e(function(e,t,n,r){return r||(r=n,n=!0,r||(r=t,t=void 0)),t!=null?Batman.helpers.pluralize(t,e,void 0,n):Batman.helpers.pluralize(e)}),humanize:e(function(e,t){return Batman.helpers.humanize(e)}),join:e(function(e,t,n){return t==null&&(t=""),n||(n=t,t=""),e.join(t)}),sort:e(function(e){return e.sort()}),map:e(function(e,t){return e.map(function(e){return Batman.get(e,t)})}),has:function(e,t){return e==null?!1:Batman.contains(e,t)},first:e(function(e){return e[0]}),meta:e(function(e,t){return Batman.developer.assert(e.meta,"Error, value doesn't have a meta to filter on!"),e.meta.get(t)}),interpolate:function(e,t,n){var r,i,s;n||(n=t,t=void 0);if(!e)return;s={};for(r in t)i=t[r],s[r]=this.get(i),s[r]==null&&(Batman.developer.warn("Warning! Undefined interpolation key "+r+" for interpolation",e),s[r]="");return Batman.helpers.interpolate(e,s)},withArguments:function(){var e,t,r,i;t=arguments[0],r=3<=arguments.length?n.call(arguments,1,i=arguments.length-1):(i=1,[]),e=arguments[i++];if(!t)return;return function(){var e;return e=1<=arguments.length?n.call(arguments,0):[],t.call.apply(t,[this].concat(n.call(r),n.call(e)))}},routeToAction:e(function(e,t){var n;return n=Batman.Dispatcher.paramsFromArgument(e),n.action=t,n}),escape:e(Batman.escapeHTML)},function(){var t,n,r,i,s;i=["capitalize","singularize","underscore","camelize"],s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(Batman.Filters[t]=e(Batman.helpers[t]));return s}(),Batman.developer.addFilters()}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.RenderContext=function(){function n(e,t){this.object=e,this.parent=t}var e;return n.deProxy=function(e){return e!=null&&e.isContextProxy?e.get("proxiedObject"):e},n.root=function(){var e;return Batman.currentApp!=null&&(e=Batman.currentApp.get("_renderContext")),e!=null?e:e=this.base},n.prototype.windowWrapper={window:Batman.container},n.prototype.findKey=function(e){var t,n,r;t=e.split(".")[0].split("|")[0].trim(),n=this;while(n){r=Batman.get(n.object,t);if(typeof r!="undefined")return r=Batman.get(n.object,e),[r,n.object].map(this.constructor.deProxy);n=n.parent}return[Batman.get(this.windowWrapper,e),this.windowWrapper]},n.prototype.get=function(e){return this.findKey(e)[0]},n.prototype.contextForKey=function(e){return this.findKey(e)[1]},n.prototype.descend=function(e,t){var n;return t&&(n=e,e=new Batman.Object,e[t]=n),new this.constructor(e,this)},n.prototype.descendWithKey=function(t,n){var r;return r=new e(this,t),this.descend(r,n)},n.prototype.chain=function(){var e,t;t=[],e=this;while(e)t.push(e.object),e=e.parent;return t},n.ContextProxy=e=function(e){function n(e,t,n){this.renderContext=e,this.keyPath=t,this.localKey=n,this.binding=new Batman.DOM.AbstractBinding(void 0,this.keyPath,this.renderContext)}return t(n,e),n.prototype.isContextProxy=!0,n.accessor("proxiedObject",function(){return this.binding.get("filteredValue")}),n.accessor({get:function(e){return this.get("proxiedObject."+e)},set:function(e,t){return this.set("proxiedObject."+e,t)},unset:function(e){return this.unset("proxiedObject."+e)}}),n}(Batman.Object),n}.call(this),Batman.RenderContext.base=new Batman.RenderContext(Batman.RenderContext.prototype.windowWrapper)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Batman.ViewStore=function(e){function n(){n.__super__.constructor.apply(this,arguments),this._viewContents={},this._requestedPaths=new Batman.SimpleSet}return t(n,e),n.prefix="views",n.fetchFromRemote=!0,n.prototype.propertyClass=Batman.Property,n.prototype.fetchView=function(e){var t=this;return new Batman.Request({url:Batman.Navigator.normalizePath(this.constructor.prefix,""+e+".html"),type:"html",success:function(n){return t.set(e,n)},error:function(t){throw new Error("Could not load view from "+e)}})},n.accessor({"final":!0,get:function(e){var t;if(e[0]!=="/")return this.get("/"+e);if(this._viewContents[e])return this._viewContents[e];if(this._requestedPaths.has(e))return;if(t=this._sourceFromDOM(e))return t;if(!this.constructor.fetchFromRemote)throw new Error("Couldn't find view source for '"+e+"'!");this.fetchView(e)},set:function(e,t){return e[0]!=="/"?this.set("/"+e,t):(this._requestedPaths.add(e),this._viewContents[e]=t)}}),n.prototype.prefetch=function(e){return this.get(e),!0},n.prototype._sourceFromDOM=function(e){var t,n;n=e.slice(1);if(t=Batman.DOM.querySelector(document,"[data-defineview*='"+n+"']"))return Batman.setImmediate(function(){var e;return(e=t.parentNode)!=null?e.removeChild(t):void 0}),Batman.DOM.defineView(e,t)},n}(Batman.Object)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;Batman.View=function(e){function r(e){var t,n=this;e==null&&(e={}),t=e.context,t?t instanceof Batman.RenderContext||(t=Batman.RenderContext.root().descend(t)):t=Batman.RenderContext.root(),e.context=t.descend(this),r.__super__.constructor.call(this,e),Batman.Property.withoutTracking(function(){return n.observeAndFire("readyToRender",function(e){if(e)return n.render()})})}return t(r,e),r.YieldStorage=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.wrapAccessor(function(e){return{get:function(t){var n;return n=e.get.call(this,t),n==null&&(n=this.set(t,[])),n}}}),n}(Batman.Hash),r.store=new Batman.ViewStore,r.option=function(){var e,t=this;return e=1<=arguments.length?n.call(arguments,0):[],e.forEach(function(e){return t.accessor(t.prototype._argumentBindingKey(e),function(t){var n,r,i,s;if(!(i=this.get("node"))||!(n=this.get("context")))return;r=i.getAttribute(("data-view-"+e).toLowerCase());if(r==null)return;return(s=this[t])!=null&&s.die(),this[t]=new Batman.DOM.ViewArgumentBinding(i,r,n)})}),this.accessor.apply(this,n.call(e).concat([function(e){var t;return(t=this.get(this._argumentBindingKey(e)))!=null?t.get("filteredValue"):void 0}]))},r.prototype.isView=!0,r.prototype.cache=!0,r.prototype._rendered=!1,r.prototype.node=null,r.prototype.event("ready").oneShot=!0,r.accessor("html",{get:function(){var e;if(this.html&&this.html.length>0)return this.html;if(!(e=this.get("source")))return;return e=Batman.Navigator.normalizePath(e),this.html=this.constructor.store.get(e)},set:function(e,t){return this.html=t}}),r.accessor("node",{get:function(){var e;if(this.node==null){e=this.get("html");if(!(e&&e.length>0))return;this.node=document.createElement("div"),this._setNodeOwner(this.node),Batman.DOM.setInnerHTML(this.node,e)}return this.node},set:function(e,t){var n,r=this;return this.node=t,this._setNodeOwner(t),n=function(e){if(e!=null)return Batman.DOM.setInnerHTML(r.node,e),r.forget("html",n)},this.observeAndFire("html",n),t}}),r.accessor("yields",function(){return new this.constructor.YieldStorage}),r.accessor("fetched?",function(){return this.get("source")!=null}),r.accessor("readyToRender",function(){var e;return this.get("node")&&(this.get("fetched?")?((e=this.get("html"))!=null?e.length:void 0)>0:!0)}),r.prototype.render=function(){var e,t=this;if(this._rendered)return;return this._rendered=!0,this._renderer=new Batman.Renderer(e=this.get("node"),this.get("context"),this),this._renderer.on("rendered",function(){return t.fire("ready",e)})},r.prototype.isInDOM=function(){var e;return(e=this.get("node"))?e.parentNode!=null||this.get("yields").some(function(t,n){var r,i;for(r=0,i=n.length;r<i;r++){e=n[r].node;if(e.parentNode!=null)return!0}return!1}):!1},r.prototype.applyYields=function(){return this.get("yields").forEach(function(e,t){var n,r,i,s,o,u,a;i=Batman.DOM.Yield.withName(e),a=[];for(s=0,o=t.length;s<o;s++)u=t[s],r=u.node,n=u.action,a.push(i[n](r));return a})},r.prototype.retractYields=function(){return this.get("yields").forEach(function(e,t){var n,r,i,s,o;o=[];for(r=0,i=t.length;r<i;r++)n=t[r].node,o.push((s=n.parentNode)!=null?s.removeChild(n):void 0);return o})},r.prototype.pushYieldAction=function(e,t,n){return this._setNodeYielder(n),this.get("yields").get(e).push({node:n,action:t})},r.prototype._argumentBindingKey=function(e){return"_"+e+"ArgumentBinding"},r.prototype._setNodeOwner=function(e){return Batman._data(e,"view",this)},r.prototype._setNodeYielder=function(e){return Batman._data(e,"yielder",this)},r.prototype.on("ready",function(){return typeof this.ready=="function"?this.ready.apply(this,arguments):void 0}),r.prototype.on("appear",function(){return typeof this.viewDidAppear=="function"?this.viewDidAppear.apply(this,arguments):void 0}),r.prototype.on("disappear",function(){return typeof this.viewDidDisappear=="function"?this.viewDidDisappear.apply(this,arguments):void 0}),r.prototype.on("beforeAppear",function(){return typeof this.viewWillAppear=="function"?this.viewWillAppear.apply(this,arguments):void 0}),r.prototype.on("beforeDisappear",function(){return typeof this.viewWillDisappear=="function"?this.viewWillDisappear.apply(this,arguments):void 0}),r}.call(this,Batman.Object)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},r=[].slice;Batman.DOM.Yield=e=function(e){function t(){this.cycle()}return n(t,e),t.yields={},t.queued=function(e){return function(){var t,n,i=this;return t=1<=arguments.length?r.call(arguments,0):[],this.containerNode!=null?e.apply(this,t):n=this.observe("containerNode",function(){var r;return r=e.apply(i,t),i.forget("containerNode",n),r})}},t.reset=function(){return this.yields={}},t.withName=function(e){var t;return(t=this.yields)[e]||(t[e]=new this({name:e})),this.yields[e]},t.forEach=function(e){var t,n,r;r=this.yields;for(t in r)n=r[t],e(n)},t.clearAll=function(){return this.forEach(function(e){return e.clear()})},t.cycleAll=function(){return this.forEach(function(e){return e.cycle()})},t.clearAllStale=function(){return this.forEach(function(e){return e.clearStale()})},t.prototype.cycle=function(){return this.currentVersionNodes=[]},t.prototype.clear=t.queued(function(){var e,t,n,r,i;this.cycle(),r=function(){var t,n,r,i;r=this.containerNode.childNodes,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e);return i}.call(this),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(Batman.DOM.removeOrDestroyNode(e));return i}),t.prototype.clearStale=t.queued(function(){var e,t,n,r,i;r=function(){var t,n,r,i;r=this.containerNode.childNodes,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e);return i}.call(this),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],~this.currentVersionNodes.indexOf(e)||i.push(Batman.DOM.removeOrDestroyNode(e));return i}),t.prototype.append=t.queued(function(e){return this.currentVersionNodes.push(e),Batman.DOM.appendChild(this.containerNode,e,!0)}),t.prototype.replace=t.queued(function(e){return this.clear(),this.append(e)}),t}(Batman.Object)}.call(this),function(){}.call(this),!function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(e,t):this[e]=t()}("reqwest",function(){function handleReadyState(e,t,n){return function(){e&&e[readyState]==4&&(twoHundo.test(e.status)?t(e):n(e))}}function setHeaders(e,t){var n=t.headers||{},r;n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"],!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&e.setRequestHeader(r,n[r])}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var i=uniqid++,s=e.jsonpCallback||"callback",o=e.jsonpCallbackName||"reqwest_"+i,u=new RegExp("((^|\\?|&)"+s+")=([^&]+)"),a=r.match(u),f=doc.createElement("script"),l=0;a?a[3]==="?"?r=r.replace(u,"$1="+o):o=a[3]:r=urlappend(r,s+"="+o),win[o]=generalCallback,f.type="text/javascript",f.src=r,f.async=!0,typeof f.onreadystatechange!="undefined"&&(f.event="onclick",f.htmlFor=f.id="_reqwest_"+i),f.onload=f.onreadystatechange=function(){if(f[readyState]&&f[readyState]!=="complete"&&f[readyState]!=="loaded"||l)return!1;f.onload=f.onreadystatechange=null,f.onclick&&f.onclick(),e.success&&e.success(lastValue),lastValue=undefined,head.removeChild(f),l=1},head.appendChild(f)}function getRequest(e,t,n){var r=(e.method||"GET").toUpperCase(),i=typeof e=="string"?e:e.url,s=e.processData!==!1&&e.data&&typeof e.data!="string"?reqwest.toQueryString(e.data):e.data||null,o;return(e.type=="jsonp"||r=="GET")&&s&&(i=urlappend(i,s),s=null),e.type=="jsonp"?handleJsonp(e,t,n,i):(o=xhr(),o.open(r,i,!0),setHeaders(o,e),o.onreadystatechange=handleReadyState(o,t,n),e.before&&e.before(o),o.send(s),o)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){var t=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return t?t[1]:"js"}function init(o,fn){function complete(e){o.timeout&&clearTimeout(self.timeout),self.timeout=null,o.complete&&o.complete(e)}function success(resp){var r=resp.responseText;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r}fn(resp),o.success&&o.success(resp),complete(resp)}function error(e,t,n){o.error&&o.error(e,t,n),complete(e)}this.url=typeof o=="string"?o:o.url,this.timeout=null;var type=o.type||setType(this.url),self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),this.request=getRequest(o,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n=e.name,r=e.tagName.toLowerCase(),i=function(e){e&&!e.disabled&&t(n,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(e.disabled||!n)return;switch(r){case"input":if(!/reset|button|image|file/i.test(e.type)){var s=/checkbox/i.test(e.type),o=/radio/i.test(e.type),u=e.value;(!s&&!o||e.checked)&&t(n,normalize(s&&u===""?"on":u))}break;case"textarea":t(n,normalize(e.value));break;case"select":if(e.type.toLowerCase()==="select-one")i(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(var a=0;e.length&&a<e.length;a++)e.options[a].selected&&i(e.options[a])}}function eachFormElement(){var e=this,t,n,r,i=function(t,n){for(var i=0;i<n.length;i++){var s=t[byTag](n[i]);for(r=0;r<s.length;r++)serial(s[r],e)}};for(n=0;n<arguments.length;n++)t=arguments[n],/input|select|textarea/i.test(t.tagName)&&serial(t,e),i(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}var context=this,win=window,doc=document,old=context.reqwest,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,lastValue,xmlHttpRequest="XMLHttpRequest",isArray=typeof Array.isArray=="function"?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"},requestedWith:xmlHttpRequest},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};return Reqwest.prototype={abort:function(){this.request.abort()},retry:function(){init.call(this,this.o,this.fn)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(arguments.length===0)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),e=="map"?t=serializeHash:e=="array"?t=reqwest.serializeArray:t=serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e){var t="",n,r=encodeURIComponent,i=function(e,n){t+=r(e)+"="+r(n)+"&"};if(isArray(e))for(n=0;e&&n<e.length;n++)i(e[n].name,e[n].value);else for(var s in e){if(!Object.hasOwnProperty.call(e,s))continue;var o=e[s];if(isArray(o))for(n=0;n<o.length;n++)i(s,o[n]);else i(s,e[s])}return t.replace(/&$/,"").replace(/%20/g,"+")},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest}),function(){var e,t;Batman.extend(Batman.DOM,{querySelectorAll:(typeof window!=="undefined"&&window!==null?(e=window.document)!=null?e.querySelectorAll:void 0:void 0)!=null?function(e,t){return e.querySelectorAll(t)}:function(){return Batman.developer.error("Please include either jQuery or a querySelectorAll polyfill, or set Batman.DOM.querySelectorAll to return an empty array.")},querySelector:(typeof window!=="undefined"&&window!==null?(t=window.document)!=null?t.querySelector:void 0:void 0)!=null?function(e,t){return e.querySelector(t)}:function(){return Batman.developer.error("Please include either jQuery or a querySelector polyfill, or set Batman.DOM.querySelector to an empty function.")},setInnerHTML:function(e,t){var n,r,i,s,o,u,a;r=function(){var t,r,i,s;i=e.childNodes,s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(n);return s}();for(s=0,u=r.length;s<u;s++)n=r[s],Batman.DOM.willRemoveNode(n);i=e.innerHTML=t;for(o=0,a=r.length;o<a;o++)n=r[o],Batman.DOM.didRemoveNode(n);return i},removeNode:function(e){var t;return Batman.DOM.willRemoveNode(e),(t=e.parentNode)!=null&&t.removeChild(e),Batman.DOM.didRemoveNode(e)},destroyNode:function(e){return Batman.DOM.willDestroyNode
(e),Batman.DOM.removeNode(e),Batman.DOM.didDestroyNode(e)},appendChild:function(e,t){return Batman.DOM.willInsertNode(t),e.appendChild(t),Batman.DOM.didInsertNode(t)}})}.call(this),function(){var e;Batman.Request.prototype._parseResponseHeaders=function(e){var t;return t=e.getAllResponseHeaders().split("\n").reduce(function(e,t){var n,r,i;if(r=t.match(/([^:]*):\s*(.*)/))n=r[1],i=r[2],e[n]=i;return e},{})},Batman.Request.prototype.send=function(e){var t,n,r,i=this;return e==null&&(e=this.get("data")),this.fire("loading"),t={url:this.get("url"),method:this.get("method"),type:this.get("type"),headers:this.get("headers"),success:function(e){return i.mixin({xhr:n,response:e,status:typeof n!="undefined"&&n!==null?n.status:void 0,responseHeaders:i._parseResponseHeaders(n)}),i.fire("success",e)},error:function(e){return i.mixin({xhr:e,response:e.responseText||e.content,status:e.status,responseHeaders:i._parseResponseHeaders(e)}),e.request=i,i.fire("error",e)},complete:function(){return i.fire("loaded")}},(r=t.method)==="PUT"||r==="POST"?this.hasFileUploads()?t.data=this.constructor.objectToFormData(e):(t.contentType=this.get("contentType"),t.data=Batman.URI.queryFromParams(e)):t.data=e,n=reqwest(t).request},e=["Webkit","Moz","O","ms",""],Batman.mixins.animation={initialize:function(){var t,n,r;for(n=0,r=e.length;n<r;n++)t=e[n],this.style[""+t+"Transform"]="scale(1, 1)",this.style.opacity=1,this.style[""+t+"TransitionProperty"]=""+(t?"-"+t.toLowerCase()+"-":"")+"transform, opacity",this.style[""+t+"TransitionDuration"]="0.8s, 0.55s",this.style[""+t+"TransformOrigin"]="left top";return this},show:function(t){var n,r,i,s=this;return n=function(){var t,n,r;s.style.opacity=1;for(n=0,r=e.length;n<r;n++)t=e[n],s.style[""+t+"Transform"]="scale(1, 1)";return s},t?((r=t.append)!=null&&r.appendChild(this),(i=t.before)!=null&&i.parentNode.insertBefore(this,t.before),setTimeout(n,0)):n(),this},hide:function(t){var n,r,i,s=this;this.style.opacity=0;for(r=0,i=e.length;r<i;r++)n=e[r],this.style[""+n+"Transform"]="scale(0, 0)";return t&&setTimeout(function(){var e;return(e=s.parentNode)!=null?e.removeChild(s):void 0},600),this}}}.call(this),function(){}.call(this),function(){Batman.extend(Batman.DOM,{querySelectorAll:function(e,t){return jQuery(t,e)},querySelector:function(e,t){return jQuery(t,e)[0]},setInnerHTML:function(e,t){var n,r,i,s,o,u,a;r=function(){var t,r,i,s;i=e.childNodes,s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(n);return s}();for(s=0,u=r.length;s<u;s++)n=r[s],Batman.DOM.willRemoveNode(n);i=jQuery(e).html(t);for(o=0,a=r.length;o<a;o++)n=r[o],Batman.DOM.didRemoveNode(n);return i},removeNode:function(e){var t;return Batman.DOM.willRemoveNode(e),(t=e.parentNode)!=null&&t.removeChild(e),Batman.DOM.didRemoveNode(e)},destroyNode:function(e){return Batman.DOM.willDestroyNode(e),Batman.DOM.willRemoveNode(e),jQuery(e).remove(),Batman.DOM.didRemoveNode(e),Batman.DOM.didDestroyNode(e)},appendChild:function(e,t){return Batman.DOM.willInsertNode(t),jQuery(e).append(t),Batman.DOM.didInsertNode(t)}}),Batman.Request.prototype._parseResponseHeaders=function(e){var t;return t=e.getAllResponseHeaders().split("\n").reduce(function(e,t){var n,r,i;if(r=t.match(/([^:]*):\s*(.*)/))n=r[1],i=r[2],e[n]=i;return e},{})},Batman.Request.prototype._prepareOptions=function(e){var t,n,r=this;t={url:this.get("url"),type:this.get("method"),dataType:this.get("type"),data:e||this.get("data"),username:this.get("username"),password:this.get("password"),headers:this.get("headers"),beforeSend:function(){return r.fire("loading")},success:function(e,t,n){return r.mixin({xhr:n,status:n.status,response:e,responseHeaders:r._parseResponseHeaders(n)}),r.fire("success",e)},error:function(e,t,n){return r.mixin({xhr:e,status:e.status,response:e.responseText,responseHeaders:r._parseResponseHeaders(e)}),e.request=r,r.fire("error",e)},complete:function(){return r.fire("loaded")}};if((n=this.get("method"))==="PUT"||n==="POST")this.hasFileUploads()?(t.contentType=!1,t.processData=!1,t.data=this.constructor.objectToFormData(t.data)):(t.contentType=this.get("contentType"),typeof t.data=="object"&&(t.processData=!1,t.data=Batman.URI.queryFromParams(t.data)));return t},Batman.Request.prototype.send=function(e){return jQuery.ajax(this._prepareOptions(e))},Batman.mixins.animation={show:function(e){var t,n,r,i;return t=$(this),n=function(){return t.show(600)},e?((r=e.append)!=null&&r.appendChild(this),(i=e.before)!=null&&i.parentNode.insertBefore(this,e.before),t.hide(),setTimeout(n,0)):n(),this},hide:function(e){var t=this;return $(this).hide(600,function(){var n;return e&&(n=t.parentNode)!=null&&n.removeChild(t),Batman.DOM.didRemoveNode(t)}),this}}}.call(this),function(){var e,t,n={}.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};t=[1,2,3,4,5,6,7,10,11],e=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/,Batman.mixin(Batman.Encoders,{railsDate:{defaultTimezoneOffset:(new Date).getTimezoneOffset(),encode:function(e){return e},decode:function(n){var r,i,s,o,u;if(n!=null){if(s=e.exec(n)){for(o=0,u=t.length;o<u;o++)r=t[o],s[r]=+s[r]||0;return s[2]=(+s[2]||1)-1,s[3]=+s[3]||1,s[8]!=="Z"&&s[9]!==void 0?(i=s[10]*60+s[11],s[9]==="+"&&(i=0-i)):i=Batman.Encoders.railsDate.defaultTimezoneOffset,new Date(Date.UTC(s[1],s[2],s[3],s[4],s[5]+i,s[6],s[7]))}return Batman.developer.warn("Unrecognized rails date "+n+"!"),Date.parse(n)}}}}),Batman.RailsStorage=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return r(t,e),t.prototype.urlForRecord=function(){return this._addJsonExtension(t.__super__.urlForRecord.apply(this,arguments))},t.prototype.urlForCollection=function(){return this._addJsonExtension(t.__super__.urlForCollection.apply(this,arguments))},t.prototype._addJsonExtension=function(e){return e.indexOf("?")!==-1||e.substr(-5,5)===".json"?e:e+".json"},t.prototype._errorsFrom422Response=function(e){return JSON.parse(e)},t.prototype.after("update","create",function(e,t){var n,r,i,s,o,u,a,f,l;s=e.subject,n=e.error,o=e.response;if(n&&n instanceof Batman.StorageAdapter.UnprocessableRecordError){try{a=this._errorsFrom422Response(o)}catch(c){return e.error=c,t()}for(i in a){r=a[i];for(f=0,l=r.length;f<l;f++)u=r[f],s.get("errors").add(i,u)}return e.result=s,e.error=s.get("errors"),t()}return t()}),t}(Batman.RestStorage)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};window.Papermaps=e=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return n(t,e),Batman.ViewStore.prefix="assets/views",t.root("maps#show"),t}(Batman.App)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Papermaps.Photo=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.storageKey="photos",n.persist(Batman.RailsStorage),n.encode("username"),n.encode("urls"),n.encode("gps"),n.encode("description"),n.encode("time"),n.encode("low_resolution_image_url"),n.encode("standard_resolution_image_url"),n.encode("thumbnail_image_url"),n.encode("latitude"),n.encode("longitude"),n.prototype.thumb=function(){return this.get("thumbnail_image_url")},n.prototype.gps=function(){return[this.get("latitude"),this.get("longitude")]},n}(Batman.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Papermaps.MapsController=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routingKey="maps",n.prototype.show=function(){return Papermaps.Photo.load()},n}(Batman.Controller)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Papermaps.MapsShowView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.ready=function(){var e,t;return t={zoom:8,center:new google.maps.LatLng(59.863216,31.040608),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0},e=new google.maps.Map($(".map-container")[0],t),this.applyMarkers(e)},n.prototype.applyMarkers=function(e){return Papermaps.Photo.get("all").forEach(function(t){return(new Papermaps.GoogleMarkerPresenter(t)).toMarker(e)})},n}(Batman.View)}.call(this),function(){this.JST||(this.JST={}),this.JST["views/maps/marker"]=function(){return this.Skim={access:function(e){var t;return t=this[e],typeof t=="function"&&(t=t.call(this)),t===!0?[this]:t===!1||t==null?!1:Object.prototype.toString.call(t)!=="[object Array]"?[t]:t.length===0?!1:t},withContext:function(e,t){var n;return n=function(e){var t;return t=function(){},t.prototype=e,new t},e=n(e),e.safe||(e.safe=this.safe||function(e){var t;return(e!=null?e.skimSafe:void 0)?e:(t=new String(e!=null?e:""),t.skimSafe=!0,t)}),e.escape||(e.escape=this.escape||function(e){return e==null?"":e.skimSafe?e:this.safe((""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\//g,"&#47;"))}),t.call(e)}},function(e){return e==null&&(e={}),Skim.withContext.call({},e,function(){var e,t,n;e=[],e.push('<img alt=""'),n=[],t=this.thumb();switch(t){case!0:n.push("src");break;case!1:case null:break;default:n.push(this.escape(t))}return n.join(""),n.length>0&&(e.push(' src="'),e.push(n),e.push('"')),e.push(" /><p>"),e.push(this.escape(this.get("description"))),e.push("</p>"),e.join("")})}}.call(this)}.call(this),function(){}.call(this),function(){Papermaps.GoogleMarkerPresenter=function(){function e(e){this.model=e}return e.prototype.toMarker=function(e){var t,n,r,i;return n=JST["views/maps/marker"](this.model),t=this.model.gps(),i=new google.maps.LatLng(t[0],t[1]),r=new google.maps.InfoWindow({maxWidth:500,content:n,position:i,zIndex:100}),r.open(e)},e}()}.call(this),$(document).ready(function(){Papermaps.run()});